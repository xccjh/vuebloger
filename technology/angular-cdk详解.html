<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>angular-cdk详解 | 邹先生博客记录</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/vuebloger/img/logo.jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="">
    <link rel="preload" href="/vuebloger/assets/css/0.styles.1f5c579b.css" as="style"><link rel="preload" href="/vuebloger/assets/js/app.9ef6ba52.js" as="script"><link rel="preload" href="/vuebloger/assets/js/7.c457106d.js" as="script"><link rel="preload" href="/vuebloger/assets/js/1.c991d8a0.js" as="script"><link rel="preload" href="/vuebloger/assets/js/42.f930fbcb.js" as="script"><link rel="preload" href="/vuebloger/assets/js/31.e713824e.js" as="script"><link rel="prefetch" href="/vuebloger/assets/js/10.2fc7b3fc.js"><link rel="prefetch" href="/vuebloger/assets/js/100.7fbbc1ba.js"><link rel="prefetch" href="/vuebloger/assets/js/101.b342a5c3.js"><link rel="prefetch" href="/vuebloger/assets/js/102.e5bfed0c.js"><link rel="prefetch" href="/vuebloger/assets/js/103.1c004e45.js"><link rel="prefetch" href="/vuebloger/assets/js/104.fbd52fd7.js"><link rel="prefetch" href="/vuebloger/assets/js/105.8a1ae092.js"><link rel="prefetch" href="/vuebloger/assets/js/106.c7925104.js"><link rel="prefetch" href="/vuebloger/assets/js/107.deaf416c.js"><link rel="prefetch" href="/vuebloger/assets/js/108.ba72bf7a.js"><link rel="prefetch" href="/vuebloger/assets/js/109.02db8538.js"><link rel="prefetch" href="/vuebloger/assets/js/11.b649e2a0.js"><link rel="prefetch" href="/vuebloger/assets/js/110.55981253.js"><link rel="prefetch" href="/vuebloger/assets/js/111.632d87dc.js"><link rel="prefetch" href="/vuebloger/assets/js/112.dd860ee0.js"><link rel="prefetch" href="/vuebloger/assets/js/113.7744c61c.js"><link rel="prefetch" href="/vuebloger/assets/js/114.afc5a900.js"><link rel="prefetch" href="/vuebloger/assets/js/12.831b2cd3.js"><link rel="prefetch" href="/vuebloger/assets/js/13.930f2726.js"><link rel="prefetch" href="/vuebloger/assets/js/14.e5c8f6df.js"><link rel="prefetch" href="/vuebloger/assets/js/15.ddb9535d.js"><link rel="prefetch" href="/vuebloger/assets/js/16.27874b69.js"><link rel="prefetch" href="/vuebloger/assets/js/17.29657b5e.js"><link rel="prefetch" href="/vuebloger/assets/js/18.3dade952.js"><link rel="prefetch" href="/vuebloger/assets/js/19.1c5b1a3e.js"><link rel="prefetch" href="/vuebloger/assets/js/20.d852b555.js"><link rel="prefetch" href="/vuebloger/assets/js/21.6de1dc73.js"><link rel="prefetch" href="/vuebloger/assets/js/22.361a90fc.js"><link rel="prefetch" href="/vuebloger/assets/js/23.91894daf.js"><link rel="prefetch" href="/vuebloger/assets/js/24.b66b149f.js"><link rel="prefetch" href="/vuebloger/assets/js/25.4349a352.js"><link rel="prefetch" href="/vuebloger/assets/js/26.0ac1aa03.js"><link rel="prefetch" href="/vuebloger/assets/js/27.fb78ea0b.js"><link rel="prefetch" href="/vuebloger/assets/js/28.b6774032.js"><link rel="prefetch" href="/vuebloger/assets/js/29.7b9797d4.js"><link rel="prefetch" href="/vuebloger/assets/js/30.af27d07d.js"><link rel="prefetch" href="/vuebloger/assets/js/32.699dcf06.js"><link rel="prefetch" href="/vuebloger/assets/js/33.e5d64564.js"><link rel="prefetch" href="/vuebloger/assets/js/34.8e99aa4f.js"><link rel="prefetch" href="/vuebloger/assets/js/35.366931a8.js"><link rel="prefetch" href="/vuebloger/assets/js/36.ff1f4304.js"><link rel="prefetch" href="/vuebloger/assets/js/37.ce68e1a6.js"><link rel="prefetch" href="/vuebloger/assets/js/38.cd2e1b6a.js"><link rel="prefetch" href="/vuebloger/assets/js/39.6cb88b55.js"><link rel="prefetch" href="/vuebloger/assets/js/4.493208fc.js"><link rel="prefetch" href="/vuebloger/assets/js/40.8e273d47.js"><link rel="prefetch" href="/vuebloger/assets/js/41.afa41a27.js"><link rel="prefetch" href="/vuebloger/assets/js/43.4bc7941e.js"><link rel="prefetch" href="/vuebloger/assets/js/44.87d042eb.js"><link rel="prefetch" href="/vuebloger/assets/js/45.9b21e29f.js"><link rel="prefetch" href="/vuebloger/assets/js/46.23a27bb6.js"><link rel="prefetch" href="/vuebloger/assets/js/47.395a793a.js"><link rel="prefetch" href="/vuebloger/assets/js/48.6bf78796.js"><link rel="prefetch" href="/vuebloger/assets/js/49.7553f93d.js"><link rel="prefetch" href="/vuebloger/assets/js/5.cb43f664.js"><link rel="prefetch" href="/vuebloger/assets/js/50.7d83d420.js"><link rel="prefetch" href="/vuebloger/assets/js/51.6e8405b6.js"><link rel="prefetch" href="/vuebloger/assets/js/52.755ebd1d.js"><link rel="prefetch" href="/vuebloger/assets/js/53.13897655.js"><link rel="prefetch" href="/vuebloger/assets/js/54.ae6325c1.js"><link rel="prefetch" href="/vuebloger/assets/js/55.b8ce2d26.js"><link rel="prefetch" href="/vuebloger/assets/js/56.135f7068.js"><link rel="prefetch" href="/vuebloger/assets/js/57.be7db1dd.js"><link rel="prefetch" href="/vuebloger/assets/js/58.bbb04e01.js"><link rel="prefetch" href="/vuebloger/assets/js/59.e7ebb591.js"><link rel="prefetch" href="/vuebloger/assets/js/6.ff7e748f.js"><link rel="prefetch" href="/vuebloger/assets/js/60.3080a154.js"><link rel="prefetch" href="/vuebloger/assets/js/61.24831605.js"><link rel="prefetch" href="/vuebloger/assets/js/62.cad7945d.js"><link rel="prefetch" href="/vuebloger/assets/js/63.2dbcc32c.js"><link rel="prefetch" href="/vuebloger/assets/js/64.97bc0bff.js"><link rel="prefetch" href="/vuebloger/assets/js/65.5f4e8786.js"><link rel="prefetch" href="/vuebloger/assets/js/66.8b6546a7.js"><link rel="prefetch" href="/vuebloger/assets/js/67.8546a43f.js"><link rel="prefetch" href="/vuebloger/assets/js/68.8377182a.js"><link rel="prefetch" href="/vuebloger/assets/js/69.5196d10d.js"><link rel="prefetch" href="/vuebloger/assets/js/70.fd04c687.js"><link rel="prefetch" href="/vuebloger/assets/js/71.b82b2a89.js"><link rel="prefetch" href="/vuebloger/assets/js/72.f4fffc0d.js"><link rel="prefetch" href="/vuebloger/assets/js/73.654837b1.js"><link rel="prefetch" href="/vuebloger/assets/js/74.d748d39a.js"><link rel="prefetch" href="/vuebloger/assets/js/75.c98adff3.js"><link rel="prefetch" href="/vuebloger/assets/js/76.2108b240.js"><link rel="prefetch" href="/vuebloger/assets/js/77.7f773ffe.js"><link rel="prefetch" href="/vuebloger/assets/js/78.254a623a.js"><link rel="prefetch" href="/vuebloger/assets/js/79.dded7f8d.js"><link rel="prefetch" href="/vuebloger/assets/js/8.664f264d.js"><link rel="prefetch" href="/vuebloger/assets/js/80.56ac9285.js"><link rel="prefetch" href="/vuebloger/assets/js/81.7e441eca.js"><link rel="prefetch" href="/vuebloger/assets/js/82.520984fb.js"><link rel="prefetch" href="/vuebloger/assets/js/83.b0b3a95d.js"><link rel="prefetch" href="/vuebloger/assets/js/84.65ca6db6.js"><link rel="prefetch" href="/vuebloger/assets/js/85.ba5097a3.js"><link rel="prefetch" href="/vuebloger/assets/js/86.a9db20e0.js"><link rel="prefetch" href="/vuebloger/assets/js/87.295987bc.js"><link rel="prefetch" href="/vuebloger/assets/js/88.1151df7d.js"><link rel="prefetch" href="/vuebloger/assets/js/89.02c5822a.js"><link rel="prefetch" href="/vuebloger/assets/js/9.6529d756.js"><link rel="prefetch" href="/vuebloger/assets/js/90.618470a9.js"><link rel="prefetch" href="/vuebloger/assets/js/91.a1dd8864.js"><link rel="prefetch" href="/vuebloger/assets/js/92.b2795203.js"><link rel="prefetch" href="/vuebloger/assets/js/93.a5764a86.js"><link rel="prefetch" href="/vuebloger/assets/js/94.b1649dff.js"><link rel="prefetch" href="/vuebloger/assets/js/95.86cb3072.js"><link rel="prefetch" href="/vuebloger/assets/js/96.13f133b3.js"><link rel="prefetch" href="/vuebloger/assets/js/97.34a8e3d4.js"><link rel="prefetch" href="/vuebloger/assets/js/98.12a2317d.js"><link rel="prefetch" href="/vuebloger/assets/js/99.15d7de8a.js"><link rel="prefetch" href="/vuebloger/assets/js/vendors~docsearch.84ba8335.js">
    <link rel="stylesheet" href="/vuebloger/assets/css/0.styles.1f5c579b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuebloger/" class="home-link router-link-active"><img src="/vuebloger/img/logo.jpeg" alt="邹先生博客记录" class="logo"> <span class="site-name can-hide">邹先生博客记录</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <div style="margin-left:20px;margin-right:20px;">
    音乐
    <div role="switch" class="el-switch"><input type="checkbox" name="" true-value="true" class="el-switch__input"><!----><span class="el-switch__core" style="width:40px;"></span><!----></div> <audio><source src="/vuebloger/mp3/065b_520b_0409_111c898908eab454414c3c326fe77c36.mp3" type="audio/mpeg"></audio></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>angular-cdk详解</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk初识" class="sidebar-link">angular-cdk初识</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-coercion" class="sidebar-link">@angular/cdk/coercion</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-keycodes" class="sidebar-link">@angular/cdk/keycodes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#keycodes常用键码" class="sidebar-link">keycodes常用键码</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#keycodes方法" class="sidebar-link">Keycodes方法</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#keycodes使用" class="sidebar-link">Keycodes使用</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-platform" class="sidebar-link">@angular/cdk/platform</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#platform提供的service" class="sidebar-link">Platform提供的Service</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#platform里面提供的方法" class="sidebar-link">Platform里面提供的方法</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#platform使用" class="sidebar-link">Platform使用</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-portal" class="sidebar-link">@angular/cdk/portal</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#portals指令" class="sidebar-link">Portals指令</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#portals类-接口" class="sidebar-link">Portals类/接口</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#动态显示componentportal" class="sidebar-link">动态显示ComponentPortal</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#动态显示templateportal" class="sidebar-link">动态显示TemplatePortal</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkportal指令的使用" class="sidebar-link">CdkPortal指令的使用</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkportaloutlet指令使用" class="sidebar-link">CdkPortalOutlet指令使用</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#用法汇总实例" class="sidebar-link">用法汇总实例</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-overlay" class="sidebar-link">@angular/cdk/overlay</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#位置策略-positionstrategy" class="sidebar-link">位置策略(PositionStrategy)</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#滑动策略-scrollstrategy" class="sidebar-link">滑动策略(ScrollStrategy)</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#overlay-service" class="sidebar-link">Overlay(Service)</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#overlay-directive" class="sidebar-link">Overlay(directive)</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#overlay使用" class="sidebar-link">Overlay使用</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-scrolling" class="sidebar-link">@angular/cdk/scrolling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkscrollable-scrolldispatcher" class="sidebar-link">cdkScrollable/ScrollDispatcher</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#viewportruler" class="sidebar-link">ViewportRuler</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#示例汇总" class="sidebar-link">示例汇总</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkvirtualscrollviewport" class="sidebar-link">CdkVirtualScrollViewport</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-drag-drop" class="sidebar-link">@angular/cdk/drag-drop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkdrag" class="sidebar-link">CdkDrag</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkdroplist" class="sidebar-link">CdkDropList</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkdroplistgroup" class="sidebar-link">CdkDropListGroup</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkdraghandle" class="sidebar-link">CdkDragHandle</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkdragpreview" class="sidebar-link">CdkDragPreview</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkdragplaceholder" class="sidebar-link">CdkDragPlaceholder</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-observers" class="sidebar-link">@angular/cdk/observers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#contentobserver" class="sidebar-link">ContentObserver</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkobservecontent" class="sidebar-link">CdkObserveContent</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-layout" class="sidebar-link">@angular/cdk/layout</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#breakpointobserver" class="sidebar-link">BreakpointObserver</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#mediamatcher" class="sidebar-link">MediaMatcher</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#breakpoints" class="sidebar-link">Breakpoints</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#示例汇总-2" class="sidebar-link">示例汇总</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-bidi" class="sidebar-link">@angular/cdk/bidi</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#directionality" class="sidebar-link">Directionality</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#dir" class="sidebar-link">Dir</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-a11y" class="sidebar-link">@angular/cdk/a11y</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#listkeymanager" class="sidebar-link">ListKeyManager</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#focustrap" class="sidebar-link">FocusTrap</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#focusmonitor" class="sidebar-link">FocusMonitor</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#focustrapfactory" class="sidebar-link">FocusTrapFactory</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#interactivitychecker" class="sidebar-link">InteractivityChecker</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#liveannouncer" class="sidebar-link">LiveAnnouncer</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#angular-cdk-stepper" class="sidebar-link">@angular/cdk/stepper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkstep" class="sidebar-link">CdkStep</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkstepper" class="sidebar-link">CdkStepper</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdksteplabel" class="sidebar-link">CdkStepLabel</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdksteppernext" class="sidebar-link">CdkStepperNext</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkstepperprevious" class="sidebar-link">CdkStepperPrevious</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#cdkstepheader" class="sidebar-link">CdkStepHeader</a></li></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#相关策略" class="sidebar-link">相关策略</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular-cdk%E8%AF%A6%E8%A7%A3.html#资料" class="sidebar-link">资料</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content__default"><h2 id="angular-cdk初识"><a href="#angular-cdk初识" class="header-anchor">#</a> angular-cdk初识</h2> <p>cdk(Component Dev Kit组件开发包)是Angular官方在开发基于Material Design的组件库时抽象出来单独的一个开发包，里面封装了一些开发组件时的公共逻辑并且跟Material Design 设计无关，可以用来封装自己的组件库或者直接在业务开发中使用。cdk库里面的功能模块有以下几个部分：</p> <table><thead><tr><th style="text-align:left;">cdk库模块</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">Coercion</td> <td style="text-align:left;">常用类型转换工具</td></tr> <tr><td style="text-align:left;">Keycodes</td> <td style="text-align:left;">常用键码</td></tr> <tr><td style="text-align:left;">Accessibility</td> <td style="text-align:left;">放置一些方便与使用者互动的功能</td></tr> <tr><td style="text-align:left;">Bidirectionality</td> <td style="text-align:left;">布局方向</td></tr> <tr><td style="text-align:left;">Dragand Drop</td> <td style="text-align:left;">组件托拽工具类</td></tr> <tr><td style="text-align:left;">Layout</td> <td style="text-align:left;">响应式布局工具</td></tr> <tr><td style="text-align:left;">Observers</td> <td style="text-align:left;">监听内容变化</td></tr> <tr><td style="text-align:left;">Overlay</td> <td style="text-align:left;">处理页面的弹出层</td></tr> <tr><td style="text-align:left;">Platform</td> <td style="text-align:left;">获取平台信息，以及平台支持的功能</td></tr> <tr><td style="text-align:left;">Portal</td> <td style="text-align:left;">动态内容呈现</td></tr> <tr><td style="text-align:left;">Scrolling</td> <td style="text-align:left;">处理滚动</td></tr> <tr><td style="text-align:left;">Text field</td> <td style="text-align:left;">处理文字的输入</td></tr> <tr><td style="text-align:left;">Stepper</td> <td style="text-align:left;">类似工作流里面经常用到的分步填写表单</td></tr> <tr><td style="text-align:left;">Table</td> <td style="text-align:left;">表格</td></tr> <tr><td style="text-align:left;">Tree</td> <td style="text-align:left;">树</td></tr></tbody></table> <h2 id="angular-cdk-coercion"><a href="#angular-cdk-coercion" class="header-anchor">#</a> @angular/cdk/coercion</h2> <p>coercion模块提供常用类型转换工具，转number、转boolean、转array、转CSS pixel value。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  coerceArray<span class="token punctuation">,</span>
  coerceBooleanProperty<span class="token punctuation">,</span>
  coerceNumberProperty<span class="token punctuation">,</span>
  _isNumberValue<span class="token punctuation">,</span>
   coerceCssPixelValue<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/coercion&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&quot;coercion&quot;</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">&quot;./coercion.component.html&quot;</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./coercion.component.scss&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CoercionComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">// 转化为array</span>
    <span class="token keyword">let</span> aa <span class="token operator">=</span> <span class="token function">coerceArray</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aa<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 转化为boolean</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token function">coerceBooleanProperty</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 转化为number</span>
    <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token function">coerceNumberProperty</span><span class="token punctuation">(</span><span class="token string">&quot;10.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;是否是number类型: &quot;</span> <span class="token operator">+</span> <span class="token function">coerceNumberProperty</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">coerceNumberFallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 判断是否number</span>
    <span class="token keyword">let</span> isNum <span class="token operator">=</span> <span class="token function">_isNumberValue</span><span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 转CSS pixel value</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;转CSS像素: &quot;</span> <span class="token operator">+</span> <span class="token function">coerceCssPixelValue</span><span class="token punctuation">(</span><span class="token string">'10'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 当转number的时候发生了错误时候的返回值
     */</span>
    <span class="token function">coerceNumberFallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="angular-cdk-keycodes"><a href="#angular-cdk-keycodes" class="header-anchor">#</a> @angular/cdk/keycodes</h2> <h3 id="keycodes常用键码"><a href="#keycodes常用键码" class="header-anchor">#</a> keycodes常用键码</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">MAC_ENTER</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">BACKSPACE</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">TAB</span> <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUM_CENTER</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">ENTER</span> <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SHIFT</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">CONTROL</span> <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">ALT</span> <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">PAUSE</span> <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">CAPS_LOCK</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">ESCAPE</span> <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SPACE</span> <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">PAGE_UP</span> <span class="token operator">=</span> <span class="token number">33</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">PAGE_DOWN</span> <span class="token operator">=</span> <span class="token number">34</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">END</span> <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">HOME</span> <span class="token operator">=</span> <span class="token number">36</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">LEFT_ARROW</span> <span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">UP_ARROW</span> <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">RIGHT_ARROW</span> <span class="token operator">=</span> <span class="token number">39</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">DOWN_ARROW</span> <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">PLUS_SIGN</span> <span class="token operator">=</span> <span class="token number">43</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">PRINT_SCREEN</span> <span class="token operator">=</span> <span class="token number">44</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">INSERT</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">DELETE</span> <span class="token operator">=</span> <span class="token number">46</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">ZERO</span> <span class="token operator">=</span> <span class="token number">48</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">ONE</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">TWO</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">THREE</span> <span class="token operator">=</span> <span class="token number">51</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FOUR</span> <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FIVE</span> <span class="token operator">=</span> <span class="token number">53</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SIX</span> <span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SEVEN</span> <span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">EIGHT</span> <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NINE</span> <span class="token operator">=</span> <span class="token number">57</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FF_SEMICOLON</span> <span class="token operator">=</span> <span class="token number">59</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FF_EQUALS</span> <span class="token operator">=</span> <span class="token number">61</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">QUESTION_MARK</span> <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">AT_SIGN</span> <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">B</span> <span class="token operator">=</span> <span class="token number">66</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">D</span> <span class="token operator">=</span> <span class="token number">68</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">E</span> <span class="token operator">=</span> <span class="token number">69</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F</span> <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">G</span> <span class="token operator">=</span> <span class="token number">71</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">I</span> <span class="token operator">=</span> <span class="token number">73</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">J</span> <span class="token operator">=</span> <span class="token number">74</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">K</span> <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">L</span> <span class="token operator">=</span> <span class="token number">76</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">M</span> <span class="token operator">=</span> <span class="token number">77</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">N</span> <span class="token operator">=</span> <span class="token number">78</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">O</span> <span class="token operator">=</span> <span class="token number">79</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">P</span> <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">Q</span> <span class="token operator">=</span> <span class="token number">81</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token number">82</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">S</span> <span class="token operator">=</span> <span class="token number">83</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token number">84</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">U</span> <span class="token operator">=</span> <span class="token number">85</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">V</span> <span class="token operator">=</span> <span class="token number">86</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">W</span> <span class="token operator">=</span> <span class="token number">87</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">Y</span> <span class="token operator">=</span> <span class="token number">89</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">Z</span> <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">META</span> <span class="token operator">=</span> <span class="token number">91</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">MAC_WK_CMD_LEFT</span> <span class="token operator">=</span> <span class="token number">91</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">MAC_WK_CMD_RIGHT</span> <span class="token operator">=</span> <span class="token number">93</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">CONTEXT_MENU</span> <span class="token operator">=</span> <span class="token number">93</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_ZERO</span> <span class="token operator">=</span> <span class="token number">96</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_ONE</span> <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_TWO</span> <span class="token operator">=</span> <span class="token number">98</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_THREE</span> <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_FOUR</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_FIVE</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_SIX</span> <span class="token operator">=</span> <span class="token number">102</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_SEVEN</span> <span class="token operator">=</span> <span class="token number">103</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_EIGHT</span> <span class="token operator">=</span> <span class="token number">104</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_NINE</span> <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_MULTIPLY</span> <span class="token operator">=</span> <span class="token number">106</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_PLUS</span> <span class="token operator">=</span> <span class="token number">107</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_MINUS</span> <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_PERIOD</span> <span class="token operator">=</span> <span class="token number">110</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUMPAD_DIVIDE</span> <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F1</span> <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F2</span> <span class="token operator">=</span> <span class="token number">113</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F3</span> <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F4</span> <span class="token operator">=</span> <span class="token number">115</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F5</span> <span class="token operator">=</span> <span class="token number">116</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F6</span> <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F7</span> <span class="token operator">=</span> <span class="token number">118</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F8</span> <span class="token operator">=</span> <span class="token number">119</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F9</span> <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F10</span> <span class="token operator">=</span> <span class="token number">121</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F11</span> <span class="token operator">=</span> <span class="token number">122</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">F12</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">NUM_LOCK</span> <span class="token operator">=</span> <span class="token number">144</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SCROLL_LOCK</span> <span class="token operator">=</span> <span class="token number">145</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FIRST_MEDIA</span> <span class="token operator">=</span> <span class="token number">166</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FF_MINUS</span> <span class="token operator">=</span> <span class="token number">173</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">MUTE</span> <span class="token operator">=</span> <span class="token number">173</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">VOLUME_DOWN</span> <span class="token operator">=</span> <span class="token number">174</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">VOLUME_UP</span> <span class="token operator">=</span> <span class="token number">175</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FF_MUTE</span> <span class="token operator">=</span> <span class="token number">181</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FF_VOLUME_DOWN</span> <span class="token operator">=</span> <span class="token number">182</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">LAST_MEDIA</span> <span class="token operator">=</span> <span class="token number">183</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">FF_VOLUME_UP</span> <span class="token operator">=</span> <span class="token number">183</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SEMICOLON</span> <span class="token operator">=</span> <span class="token number">186</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">EQUALS</span> <span class="token operator">=</span> <span class="token number">187</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">COMMA</span> <span class="token operator">=</span> <span class="token number">188</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">DASH</span> <span class="token operator">=</span> <span class="token number">189</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SLASH</span> <span class="token operator">=</span> <span class="token number">191</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">APOSTROPHE</span> <span class="token operator">=</span> <span class="token number">192</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">TILDE</span> <span class="token operator">=</span> <span class="token number">192</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">OPEN_SQUARE_BRACKET</span> <span class="token operator">=</span> <span class="token number">219</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">BACKSLASH</span> <span class="token operator">=</span> <span class="token number">220</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">CLOSE_SQUARE_BRACKET</span> <span class="token operator">=</span> <span class="token number">221</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">SINGLE_QUOTE</span> <span class="token operator">=</span> <span class="token number">222</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">MAC_META</span> <span class="token operator">=</span> <span class="token number">224</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br></div></div><h3 id="keycodes方法"><a href="#keycodes方法" class="header-anchor">#</a> Keycodes方法</h3> <p>就提供了一个方法hasModifierKey，判断是否按下了组合键。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">type</span> ModifierKey <span class="token operator">=</span> <span class="token string">'altKey'</span> <span class="token operator">|</span> <span class="token string">'shiftKey'</span> <span class="token operator">|</span> <span class="token string">'ctrlKey'</span> <span class="token operator">|</span> <span class="token string">'metaKey'</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 判断是否是按下了组合按钮，比如 alt + c 键
 */</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">hasModifierKey</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> KeyboardEvent<span class="token punctuation">,</span> <span class="token operator">...</span>modifiers<span class="token operator">:</span> ModifierKey<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="keycodes使用"><a href="#keycodes使用" class="header-anchor">#</a> Keycodes使用</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">DELETE</span><span class="token punctuation">,</span> <span class="token constant">ENTER</span><span class="token punctuation">,</span> hasModifierKey<span class="token punctuation">,</span> <span class="token constant">MAC_ENTER</span><span class="token punctuation">,</span> <span class="token constant">TAB</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/keycodes'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-key-codes'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;input placeholder=&quot;keycodes测试&quot; (keyup)=&quot;onKeyDown($event)&quot; #input&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-key-codes.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkKeyCodesComponent</span> <span class="token punctuation">{</span>
    <span class="token function">onKeyDown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * 组合按键判断(如果按下的是 ctr按键 + 其他的按键的时候 返回true)
         */</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">hasModifierKey</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token string">'ctrlKey'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * 打印按键值
         */</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/**
         * 通过 cdk 判断按键类型
         */</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token constant">MAC_ENTER</span><span class="token operator">:</span>
            <span class="token keyword">case</span> <span class="token constant">ENTER</span><span class="token operator">:</span>
                <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前按键: Enter键'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token constant">TAB</span><span class="token operator">:</span>
                <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前按键: Tab键'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token constant">DELETE</span><span class="token operator">:</span>
                <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前按键: Delete键'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="angular-cdk-platform"><a href="#angular-cdk-platform" class="header-anchor">#</a> @angular/cdk/platform</h2> <p>platform用于获取当前平台的信息以及当前平台支持的功能,Platform里面给提供了PlatformModule模块，使用之前先imports</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>PlatformModule<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/platform'</span><span class="token punctuation">;</span>
@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        PlatformModule<span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="platform提供的service"><a href="#platform提供的service" class="header-anchor">#</a> Platform提供的Service</h3> <table><thead><tr><th style="text-align:left;">Platform类属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">ANDROID</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台是否android系统</td></tr> <tr><td style="text-align:left;">IOS</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台是否IOS系统</td></tr> <tr><td style="text-align:left;">isBrowser</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台是否浏览器</td></tr> <tr><td style="text-align:left;">EDGE</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台是否edge浏览器</td></tr> <tr><td style="text-align:left;">FIREFOX</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台是否firefox浏览器</td></tr> <tr><td style="text-align:left;">SAFARI</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台是否safari浏览器</td></tr> <tr><td style="text-align:left;">TRIDENT</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台浏览器的render engine是否为Microsoft Trident</td></tr> <tr><td style="text-align:left;">WEBKIT</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台浏览器的render engine是否为Webkit</td></tr> <tr><td style="text-align:left;">BLINK</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前平台浏览器的render engine是否为Blink</td></tr></tbody></table> <h3 id="platform里面提供的方法"><a href="#platform里面提供的方法" class="header-anchor">#</a> Platform里面提供的方法</h3> <table><thead><tr><th style="text-align:left;">Platform模块方法</th> <th style="text-align:left;">参数</th> <th style="text-align:left;">返回值</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">getSupportedInputTypes</td> <td style="text-align:left;">无</td> <td style="text-align:left;">Set</td> <td style="text-align:left;">当前浏览器支持的输入类型(比如color, button, checkbox, date等)</td></tr> <tr><td style="text-align:left;">supportsPassiveEventListeners</td> <td style="text-align:left;">无</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前浏览器是否支持被动事件监听器</td></tr> <tr><td style="text-align:left;">normalizePassiveListenerOptions</td> <td style="text-align:left;">AddEventListenerOptions</td> <td style="text-align:left;">AddEventListenerOptions 或者 boolean</td> <td style="text-align:left;">目前还不清楚是干啥的，待补充</td></tr> <tr><td style="text-align:left;">supportsScrollBehavior</td> <td style="text-align:left;">无</td> <td style="text-align:left;">boolean</td> <td style="text-align:left;">当前浏览器是否支持滑动行为</td></tr> <tr><td style="text-align:left;">getRtlScrollAxisType</td> <td style="text-align:left;">无</td> <td style="text-align:left;">RtlScrollAxisType</td> <td style="text-align:left;">获取当前浏览器使用的RTL滚动轴的类型(Chrome的是NORMAL, Firefox和 Safari的是NEGATED, IE和Edge的是INVERTED.)</td></tr></tbody></table> <h3 id="platform使用"><a href="#platform使用" class="header-anchor">#</a> Platform使用</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Platform 服务</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  Platform<span class="token punctuation">,</span>
  supportsPassiveEventListeners<span class="token punctuation">,</span>
  getSupportedInputTypes<span class="token punctuation">,</span>
  supportsScrollBehavior
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/platform&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&quot;platform&quot;</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">&quot;./platform.component.html&quot;</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./platform.component.scss&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PlatformComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> plat<span class="token operator">:</span> Platform</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 是否支持被动监听</span>
    <span class="token keyword">let</span> isSupportsPassiveEventListeners <span class="token operator">=</span> <span class="token function">supportsPassiveEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;isSupportsPassiveEventListeners&quot;</span><span class="token punctuation">,</span>isSupportsPassiveEventListeners<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">// 是否支持滑动行为</span>
    <span class="token keyword">let</span> supportsScrollBehavior <span class="token operator">=</span> <span class="token function">supportsScrollBehavior</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;supportsScrollBehavior&quot;</span><span class="token punctuation">,</span>supportsScrollBehavior<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 支持输入的类型</span>
    <span class="token keyword">let</span> supportedInputTypes <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token function">getSupportedInputTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;supportedInputTypes&quot;</span><span class="token punctuation">,</span> supportedInputTypes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否安卓</span>
    <span class="token keyword">let</span> <span class="token constant">ANDROID</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">ANDROID</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否IOS</span>
    <span class="token keyword">let</span> <span class="token constant">IOS</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">IOS</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否BLINK引擎</span>
    <span class="token keyword">let</span> <span class="token constant">BLINK</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">BLINK</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否DEGE浏览器</span>
    <span class="token keyword">let</span> <span class="token constant">EDGE</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">EDGE</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否FIREFOX浏览器</span>
    <span class="token keyword">let</span> <span class="token constant">FIREFOX</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">FIREFOX</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否SAFARI</span>
    <span class="token keyword">let</span> <span class="token constant">SAFARI</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">SAFARI</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否TRIDENT</span>
    <span class="token keyword">let</span> <span class="token constant">TRIDENT</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">TRIDENT</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否WEBKIT</span>
    <span class="token keyword">let</span> <span class="token constant">WEBKIT</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span><span class="token constant">WEBKIT</span><span class="token punctuation">;</span>
    <span class="token comment">// 是否浏览器</span>
    <span class="token keyword">let</span> isBrowser <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plat<span class="token punctuation">.</span>isBrowser<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="angular-cdk-portal"><a href="#angular-cdk-portal" class="header-anchor">#</a> @angular/cdk/portal</h2> <p>portal将动态内容(这个内容可以是Component也可以是一个TemplateRef)呈现到应用程序中。即把Portal放到指定位置(我们把他叫做插槽PortalOutlet)。Portal有两个子类ComponentPortal(对应组件)或者TemplatePortal(对应TemplateRef)。</p> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>Portal:表示内容。PortalOutlet: 放置内容的位置。</p> <p>在使用Portals之前我们先要import PortalModule。</p></div> <h3 id="portals指令"><a href="#portals指令" class="header-anchor">#</a> Portals指令</h3> <h4 id="cdkportal"><a href="#cdkportal" class="header-anchor">#</a> CdkPortal</h4> <ol><li>CdkPortal extends TemplatePortal</li></ol> <ul><li>Selector: <code>[cdk-portal] [cdkPortal] [portal]</code></li> <li>Exported as: cdkPortal</li> <li>CdkPortal指令继承自TemplatePortal，CdkPortal指令代表当前元素是一个Portal，这个Portal是可以放置到PortalOutlet里面去的。</li> <li>注意：CdkPortal指令没有提供@Input()和@Output()。</li></ul> <ol start="2"><li>CdkPortal指令里面的属性(其实就是TemplatePortal的属性)</li></ol> <table><thead><tr><th style="text-align:left;">CdkPortal属性</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">context: <code>C | undefined</code></td> <td style="text-align:left;">ng-template需要传递的参数，可以参考ngTemplateOutletContext的用法</td></tr> <tr><td style="text-align:left;">isAttached: boolean</td> <td style="text-align:left;">是否attach到节点里面去了</td></tr> <tr><td style="text-align:left;">templateRef: TemplateRef</td> <td style="text-align:left;">嵌入视图</td></tr> <tr><td style="text-align:left;">viewContainerRef: ViewContainerRef</td> <td style="text-align:left;">视图容器(内部会通过上下文拿到)，内部应该是要通过视图容器来插入元素</td></tr></tbody></table> <ol start="3"><li>CdkPortal指令里面的方法</li></ol> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * 把CdkPortal对应的Portal attach 到 PortalOutlet里面去(把组件显示出来)
 * @Param host PortalOutlet
 * @Param context ng-template需要传入的内容
 */</span>
<span class="token function">attach</span><span class="token punctuation">(</span>host<span class="token operator">:</span> PortalOutlet<span class="token punctuation">,</span> context<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">C</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 把CdkPortal对应的Portal从PortalOutlet detach移除掉
 */</span>
<span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="cdkportaloutlet"><a href="#cdkportaloutlet" class="header-anchor">#</a> CdkPortalOutlet</h4> <ol><li>CdkPortalOutlet extends BasePortalOutlet</li></ol> <ul><li>Selector: <code>[cdkPortalOutlet], [cdkPortalHost], [portalHost]</code></li></ul> <ol start="2"><li>CdkPortalOutlet指令里面的属性</li></ol> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;"></th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">portal: <code>Portal | null</code></td> <td style="text-align:left;">@Input(cdkPortalOutlet)</td> <td style="text-align:left;">CdkPortalOutlet位置attach的Portal</td></tr> <tr><td style="text-align:left;">attached: EventEmitter</td> <td style="text-align:left;">@Output()</td> <td style="text-align:left;">当有Portal attach到CdkPortalOutlet位置的时候会回调</td></tr> <tr><td style="text-align:left;">attachedRef: CdkPortalOutletAttachedRef</td> <td style="text-align:left;"></td> <td style="text-align:left;">已经attach的宿主视图或者嵌入视图(ComponentRef-Component提供</td></tr></tbody></table> <ol start="3"><li>CdkPortalOutlet指令里面的方法</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/** 是否有Portal attach到当前PortalOutlet上了 */</span>
<span class="token function">hasAttached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token comment">/**
 * 把Portal(ComponentPortal、TemplatePortal) attach 到PortalOutlet上去
 */</span>
attach<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> ComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> ComponentRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
attach<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> EmbeddedViewRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token function">attach</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> any<span class="token punctuation">)</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token comment">/**
 * 把ComponentPortal attach 到PortalOutlet上去，使用ComponentFactoryResolver
 */</span>
attachComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> ComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> ComponentRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 把TemplatePortal attach 到PortalOutlet上去，使用ComponentFactoryResolver
 */</span>
attachTemplatePortal<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> EmbeddedViewRef<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 把当前PortalOutlet里面的Portal detach掉
 */</span>
<span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 永久性的dispatch掉Portal
 */</span>
<span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="portals类-接口"><a href="#portals类-接口" class="header-anchor">#</a> Portals类/接口</h3> <h4 id="portal类"><a href="#portal类" class="header-anchor">#</a> Portal类</h4> <p>Portal类代表我们将要显示的动态内容。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Portal代表动态内容(可以代表)
 */</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Portal</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _attachedHost<span class="token punctuation">;</span>
    <span class="token comment">/** Portal attach 到PortalOutlet里面去 */</span>
    <span class="token function">attach</span><span class="token punctuation">(</span>host<span class="token operator">:</span> PortalOutlet<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
    <span class="token comment">/** 把Portal从PortalOutlet里面移除掉*/</span>
    <span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 当前portal是否attach到PortalOutlet上了
     */</span>
    <span class="token keyword">readonly</span> isAttached<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 在 attach() 和 detach()调用的时候，这个函数会被PortalOutlet调用。我们使用的时候是不需要调用这个函数的
     */</span>
    <span class="token function">setAttachedHost</span><span class="token punctuation">(</span>host<span class="token operator">:</span> PortalOutlet <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="componentportal-extends-portal"><a href="#componentportal-extends-portal" class="header-anchor">#</a> ComponentPortal extends Portal</h4> <p>ComponentPortal类是组件视图对应的Portal，重点在构造函数。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Portal代表动态内容(可以代表)
 */</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Portal</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _attachedHost<span class="token punctuation">;</span>
    <span class="token comment">/** Portal attach 到PortalOutlet里面去 */</span>
    <span class="token function">attach</span><span class="token punctuation">(</span>host<span class="token operator">:</span> PortalOutlet<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
    <span class="token comment">/** 把Portal从PortalOutlet里面移除掉*/</span>
    <span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 当前portal是否attach到PortalOutlet上了
     */</span>
    <span class="token keyword">readonly</span> isAttached<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 在 attach() 和 detach()调用的时候，这个函数会被PortalOutlet调用。我们使用的时候是不需要调用这个函数的
     */</span>
    <span class="token function">setAttachedHost</span><span class="token punctuation">(</span>host<span class="token operator">:</span> PortalOutlet <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="componentportal-extends-portal-2"><a href="#componentportal-extends-portal-2" class="header-anchor">#</a> ComponentPortal extends Portal</h4> <p>ComponentPortal类是组件视图对应的Portal，重点在构造函数。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * ComponentPortal组件对应的Portal
 */</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">ComponentPortal</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token keyword">extends</span> <span class="token class-name">Portal</span><span class="token operator">&lt;</span>ComponentRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    component<span class="token operator">:</span> ComponentType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    viewContainerRef<span class="token operator">?</span><span class="token operator">:</span> ViewContainerRef <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    injector<span class="token operator">?</span><span class="token operator">:</span> Injector <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    componentFactoryResolver<span class="token operator">?</span><span class="token operator">:</span> ComponentFactoryResolver <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 构造函数
     * @param component: 组件
     * @param viewContainerRef: 试图容器
     * @param injector: 注入器(用它来给组件传递参数)，关于怎么传递参数，我们会在下面的实例里面讲到
     * @param componentFactoryResolver： 组件工厂解析器
     */</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>component<span class="token operator">:</span> ComponentType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> viewContainerRef<span class="token operator">?</span><span class="token operator">:</span> ViewContainerRef <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> injector<span class="token operator">?</span><span class="token operator">:</span> Injector <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> componentFactoryResolver<span class="token operator">?</span><span class="token operator">:</span> ComponentFactoryResolver <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="templateportal-extends-portal"><a href="#templateportal-extends-portal" class="header-anchor">#</a> TemplatePortal extends Portal</h4> <p>TemplatePortal类是嵌入视图对应的Portal，</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * TemplatePortal是嵌入试图对应的Portal
 */</span>
<span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">TemplatePortal</span><span class="token operator">&lt;</span><span class="token constant">C</span> <span class="token operator">=</span> any<span class="token operator">&gt;</span> <span class="token keyword">extends</span> <span class="token class-name">Portal</span><span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    templateRef<span class="token operator">:</span> TemplateRef<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    viewContainerRef<span class="token operator">:</span> ViewContainerRef<span class="token punctuation">;</span>
    context<span class="token operator">:</span> <span class="token constant">C</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     *
     * @param template: 嵌入试图对应的模板
     * @param viewContainerRef： 试图容器
     * @param context： 嵌入试图需要传递的参数
     */</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>template<span class="token operator">:</span> TemplateRef<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> viewContainerRef<span class="token operator">:</span> ViewContainerRef<span class="token punctuation">,</span> context<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    readonly origin<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>
    <span class="token function">attach</span><span class="token punctuation">(</span>host<span class="token operator">:</span> PortalOutlet<span class="token punctuation">,</span> context<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">C</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">;</span>
    <span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="portaloutlet"><a href="#portaloutlet" class="header-anchor">#</a> PortalOutlet</h4> <p>PortalOutlet是代表我们动态内容需要放置的地方(插槽)，用来放置ComponentPortal或者TemplatePortal。 PortalOutlet是一个接口。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Portal所要放置的位置
 */</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PortalOutlet</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 把Portal对应的内容放置在PortalOutlet
     */</span>
    <span class="token function">attach</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> Portal<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * D把PortalOutlet的内容移除掉
     */</span>
    <span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 在destroyed之前清理掉 PortalOutlet里面的内容，一帮我们自己很少调用
     */</span>
    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 判断PortalOutlet里面是否attach了Portal
     */</span>
    <span class="token function">hasAttached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="baseportaloutlet-implements-portaloutlet"><a href="#baseportaloutlet-implements-portaloutlet" class="header-anchor">#</a> BasePortalOutlet implements PortalOutlet</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * BasePortalOutlet是一个抽象类，实现了PortalOutlet，话句话说BasePortalOutlet实现了ComponentPortal、 TemplatePortal的放置
 * ComponentPortal and TemplatePortal.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BasePortalOutlet</span> <span class="token keyword">implements</span> <span class="token class-name">PortalOutlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> _attachedPortal<span class="token operator">:</span> Portal<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> _disposeFn<span class="token punctuation">;</span>
    <span class="token keyword">private</span> _isDisposed<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 判断PortalOutlet里面是否attach了Portal
     */</span>
    <span class="token function">hasAttached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 在PortalOutlet里面放置ComponentPortal
     */</span>
    attach<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> ComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> ComponentRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 在PortalOutlet里面放置TemplatePortal
     */</span>
    attach<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> EmbeddedViewRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token function">attach</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token keyword">abstract</span> attachComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> ComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> ComponentRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token keyword">abstract</span> attachTemplatePortal<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> EmbeddedViewRef<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 把PortalOutlet的内容移除掉
     */</span>
    <span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     *  永久性的移除PortalOutlet的内容，在destroy之前调用
     */</span>
    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** @docs-private */</span>
    <span class="token function">setDisposeFn</span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> _invokeDisposeFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h4 id="domportaloutlet-extends-baseportaloutlet"><a href="#domportaloutlet-extends-baseportaloutlet" class="header-anchor">#</a> DomPortalOutlet extends BasePortalOutlet</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
* Dom 形式下的PortalOutlet
*/</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">DomPortalOutlet</span> <span class="token keyword">extends</span> <span class="token class-name">BasePortalOutlet</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * PortalOutlet 对应的Element，Portal的内容将会添加在这个Element下面
     */</span>
    outletElement<span class="token operator">:</span> Element<span class="token punctuation">;</span>
    <span class="token keyword">private</span> _componentFactoryResolver<span class="token punctuation">;</span>
    <span class="token keyword">private</span> _appRef<span class="token punctuation">;</span>
    <span class="token keyword">private</span> _defaultInjector<span class="token punctuation">;</span>

    <span class="token comment">/**
     *
     * @param outletElement: PortalOutlet对应的节点Element，Portal添加的位置
     * @param _componentFactoryResolver：组件工厂解析器
     * @param _appRef：变化检测工具类
     * @param _defaultInjector：注入器，用于传递参数
     */</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>
        <span class="token comment">/** Element into which the content is projected. */</span>
        outletElement<span class="token operator">:</span> Element<span class="token punctuation">,</span> _componentFactoryResolver<span class="token operator">:</span> ComponentFactoryResolver<span class="token punctuation">,</span> _appRef<span class="token operator">:</span> ApplicationRef<span class="token punctuation">,</span> _defaultInjector<span class="token operator">:</span> Injector<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * attach ComponentPortal
     */</span>
    attachComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> ComponentPortal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> ComponentRef<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * attach TemplatePortal
     */</span>
    attachTemplatePortal<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>portal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> EmbeddedViewRef<span class="token operator">&lt;</span><span class="token constant">C</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 情况DomPortalOutlet下面所有的Portal
     */</span>
    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** Gets the root HTMLElement for an instantiated component. */</span>
    <span class="token keyword">private</span> _getComponentRootNode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="动态显示componentportal"><a href="#动态显示componentportal" class="header-anchor">#</a> 动态显示ComponentPortal</h3> <p>动态显示宿主视图(Host View),由Component提供，也就是我们常说的组件了。第一步，我们肯定会有一个自定义的组件的。比如我们新建一个非常简单的组件PortalChildComponent，并且给组件传递一个参数.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> EventEmitter<span class="token punctuation">,</span> Inject<span class="token punctuation">,</span> InjectionToken<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 用于动态创建PortalChildComponent的时候传递参数
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PORTAL_CHILD_DATA</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InjectionToken</span><span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'PORTAL_CHILD_DATA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-portal-child'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;h1&gt;portal child show&lt;/h1&gt;
        &lt;button (click)=&quot;onButtonClick()&quot;&gt;点击&lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PortalChildComponent</span> <span class="token punctuation">{</span>
    outEvent<span class="token operator">:</span> EventEmitter<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 构造函数
     * @param initData 创建组件的时候传递过来的参数(为了测试用了any类型，推荐根据业务使用特定的类型，尽量不要使用any)
     */</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token constant">PORTAL_CHILD_DATA</span><span class="token punctuation">)</span> <span class="token keyword">public</span> initData<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>initData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 用来测试把Portal里面的事件返回上去
     */</span>
    <span class="token function">onButtonClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>outEvent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>outEvent<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'child 里面被点击了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>因为PortalChildComponent是动态组件，所以@NgModule里面除了declarations里面需要添加PortalChildComponent，entryComponents里面也需要添加PortalChildComponent</p></div> <p>第二步，动态显示PortalChildComponent，这里我们新建一个PortalComponentComponent 组件，把PortalChildComponent动态的添加到PortalComponentComponent里面去。(注意下是怎么传递参数的,传出参数，业务绝大部分的场景都是需要给动态组件传递参数的)</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
    ApplicationRef<span class="token punctuation">,</span>
    Component<span class="token punctuation">,</span>
    ComponentFactoryResolver<span class="token punctuation">,</span> ComponentRef<span class="token punctuation">,</span>
    ElementRef<span class="token punctuation">,</span> EventEmitter<span class="token punctuation">,</span>
    Injector<span class="token punctuation">,</span> OnDestroy<span class="token punctuation">,</span>
    OnInit<span class="token punctuation">,</span>
    ViewContainerRef
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ComponentPortal<span class="token punctuation">,</span> DomPortalHost<span class="token punctuation">,</span> PortalInjector<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/portal'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">PORTAL_CHILD_DATA</span><span class="token punctuation">,</span> PortalChildComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../portal-child-component/portal-child.component'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Subject<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>takeUntil<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs/operators&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-portal-component'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PortalComponentComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span><span class="token punctuation">,</span> OnDestroy <span class="token punctuation">{</span>
    <span class="token keyword">private</span> portalHost<span class="token operator">:</span> DomPortalHost<span class="token punctuation">;</span>
    <span class="token keyword">private</span> _$destroy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token keyword">private</span> elementRef<span class="token operator">:</span> ElementRef<span class="token punctuation">,</span>
        <span class="token keyword">private</span> injector<span class="token operator">:</span> Injector<span class="token punctuation">,</span>
        <span class="token keyword">private</span> appRef<span class="token operator">:</span> ApplicationRef<span class="token punctuation">,</span>
        <span class="token keyword">private</span> viewContainerRef<span class="token operator">:</span> ViewContainerRef<span class="token punctuation">,</span>
        <span class="token keyword">private</span> componentFactoryResolver<span class="token operator">:</span> ComponentFactoryResolver<span class="token punctuation">,</span></span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. 创建DomPortalHost</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>portalHost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DomPortalHost</span><span class="token punctuation">(</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementRef<span class="token punctuation">.</span>nativeElement <span class="token keyword">as</span> HTMLElement<span class="token punctuation">,</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>componentFactoryResolver<span class="token punctuation">,</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>appRef<span class="token punctuation">,</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>injector
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// injectionTokens用于传递参数，如果不想传递参数，直接const templatePortal = new ComponentPortal(PortalChildComponent) 就可以了</span>
        <span class="token keyword">const</span> injectionTokens <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        injectionTokens<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token constant">PORTAL_CHILD_DATA</span><span class="token punctuation">,</span> <span class="token string">'构建组件传递的参数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 创建ComponentPortal</span>
        <span class="token keyword">const</span> templatePortal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComponentPortal</span><span class="token punctuation">(</span>PortalChildComponent
            <span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef
            <span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PortalInjector</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>injector<span class="token punctuation">,</span> injectionTokens<span class="token punctuation">)</span>
            <span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>componentFactoryResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. ComponentPortal attach 到DomPortalHost里面去, 并且把ComponentPortal里面的时间返回上来</span>
        <span class="token comment">// 如果不需要传出参数，this.portalHost.attach(templatePortal); 就可以了</span>
        <span class="token keyword">const</span> portalComponentRef<span class="token operator">:</span> ComponentRef<span class="token operator">&lt;</span>PortalChildComponent<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>portalHost<span class="token punctuation">.</span><span class="token function">attachComponentPortal</span><span class="token punctuation">(</span>templatePortal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 处理返回回来的事件</span>
        <span class="token keyword">const</span> eventEmitter<span class="token operator">:</span> EventEmitter<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        portalComponentRef<span class="token punctuation">.</span>instance<span class="token punctuation">.</span>outEvent <span class="token operator">=</span> eventEmitter<span class="token punctuation">;</span>
        eventEmitter<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">takeUntil</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_$destroy<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handlerPortalEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token function">handlerPortalEvent</span><span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'收到了Portal返回上来的事件信息:'</span> <span class="token operator">+</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_$destroy<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_$destroy<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">总结</p> <ul><li>第一动态组件需要在declarations和entryComponents里面申明。</li> <li>第二动态组件传入参数。(@Input())</li> <li>第三动态组件传出参数。(@Output())</li></ul></div> <h3 id="动态显示templateportal"><a href="#动态显示templateportal" class="header-anchor">#</a> 动态显示TemplatePortal</h3> <p>动态显示嵌入视图(Embedded View),由Template提供，和我们常说的ng-template标签对应。把ng-template的内容在指定的位置显示出来。下面的例子我们创建一个PortalTemplateComponent组件，然后把ng-template标签对应的内容在这个组件里面显示出来。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
   ApplicationRef<span class="token punctuation">,</span>
   Component<span class="token punctuation">,</span>
   ComponentFactoryResolver<span class="token punctuation">,</span>
   ElementRef<span class="token punctuation">,</span>
   Injector<span class="token punctuation">,</span>
   OnInit<span class="token punctuation">,</span>
   TemplateRef<span class="token punctuation">,</span>
   ViewChild<span class="token punctuation">,</span>
   ViewContainerRef
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>DomPortalHost<span class="token punctuation">,</span> TemplatePortal<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/portal&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   selector<span class="token operator">:</span> <span class="token string">'app-portal-template'</span><span class="token punctuation">,</span>
   template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
       &lt;!-- 我们定义一个ng-template节点，并且需要传递一个参数 --&gt;
       &lt;ng-template #portalTemplate let-data&gt;
           &lt;div&gt;参数: {{ data }}&lt;/div&gt;
       &lt;/ng-template&gt;
   </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PortalTemplateComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
   @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'portalTemplate'</span><span class="token punctuation">)</span> testTemplate<span class="token operator">:</span> TemplateRef<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
   <span class="token keyword">constructor</span><span class="token punctuation">(</span>
       <span class="token parameter"><span class="token keyword">private</span> elementRef<span class="token operator">:</span> ElementRef<span class="token punctuation">,</span>
       <span class="token keyword">private</span> injector<span class="token operator">:</span> Injector<span class="token punctuation">,</span>
       <span class="token keyword">private</span> appRef<span class="token operator">:</span> ApplicationRef<span class="token punctuation">,</span>
       <span class="token keyword">private</span> viewContainerRef<span class="token operator">:</span> ViewContainerRef<span class="token punctuation">,</span>
       <span class="token keyword">private</span> componentFactoryResolver<span class="token operator">:</span> ComponentFactoryResolver<span class="token punctuation">,</span></span>
   <span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token punctuation">}</span>
   <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// 1. DomPortalHost</span>
       <span class="token keyword">const</span> portalHost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DomPortalHost</span><span class="token punctuation">(</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>elementRef<span class="token punctuation">.</span>nativeElement <span class="token keyword">as</span> HTMLElement<span class="token punctuation">,</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>componentFactoryResolver<span class="token punctuation">,</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>appRef<span class="token punctuation">,</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>injector
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// 2. TemplatePortal</span>
       <span class="token keyword">const</span> templatePortal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TemplatePortal</span><span class="token punctuation">(</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>testTemplate<span class="token punctuation">,</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef<span class="token punctuation">,</span>
           <span class="token punctuation">{</span>
               $implicit<span class="token operator">:</span> <span class="token string">&quot;我是传递进来的数据&quot;</span><span class="token punctuation">,</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// 3. attach</span>
       portalHost<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>templatePortal<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h3 id="cdkportal指令的使用"><a href="#cdkportal指令的使用" class="header-anchor">#</a> CdkPortal指令的使用</h3> <p>模板语法中某个标签使用了CdkPortal指令，可以简单的认为这个标签对应的元素就已经被封装成TemplatePortal了。</p> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>添加了CdkPortal指令的元素是不会在页面中显示出来的，除非你给CdkPortal指定了CdkPortalOutlet的位置。即使是div元素你给添加了*cdkPortal也是不会显示出来的。</p></div> <p>比如我们有如下的代码，ng-templat和div都添加了CdkPortal指令。如果我们不做任何处理，他们是不会显示的。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> #divPortal<span class="token operator">=</span><span class="token string">&quot;cdkPortal&quot;</span><span class="token punctuation">,</span>CdkPortal指令有exportAs<span class="token operator">:</span> <span class="token string">'cdkPortal'</span>元数据，所以我们才可以这么写来获取，来获取CdkPortal对象  <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template #divPortal<span class="token operator">=</span><span class="token string">&quot;cdkPortal&quot;</span> cdkPortal <span class="token keyword">let</span><span class="token operator">-</span>obj <span class="token keyword">let</span><span class="token operator">-</span>location<span class="token operator">=</span><span class="token string">&quot;location&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>ng<span class="token operator">-</span>template <span class="token function">指定的内容</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span> 外部参数 <span class="token punctuation">{</span><span class="token punctuation">{</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 不建议在div上添加<span class="token operator">*</span>cdkPortal指令，完全可以用ng<span class="token operator">-</span>template代替 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div <span class="token operator">*</span>cdkPortal<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>ng<span class="token operator">-</span>template <span class="token function">指定的内容</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>接下来得给他们指定一个位置让他们显示出来。在显示之前，咱们得在对应的ts文件里面得到cdkPortal指令对应的TemplatePortal。使用@ViewChildren，@ViewChild找到他们。</p> <ol><li>通过@ViewChildren获取CdkPortal，@ViewChildren selector参数是TemplatePortalDirective，这样我们就拿到了当前html里面所有添加了CdkPortal指令的对象的TemplatePortal。</li></ol> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code> <span class="token comment">// 获取到对应html里面所有添加了cdkPortal指令的元素的TemplatePortal</span>
    @<span class="token function">ViewChildren</span><span class="token punctuation">(</span>TemplatePortalDirective<span class="token punctuation">)</span> templatePortals<span class="token operator">:</span> QueryList<span class="token operator">&lt;</span>TemplatePortal<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>通过@ViewChild获取指定添加了CdkPortal指令的TemplatePortal，html模板语法里面对应CdkPortal指令标签需要写上#templatePortal=“cdkPortal”</li></ol> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// 获取单个的cdkPortal指令的元素的TemplatePortal 【#templatePortal=&quot;cdkPortal&quot;】</span>
    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'templatePortal'</span><span class="token punctuation">)</span> divTemplatePortal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>CdkPortal指令对应的视图内容(嵌入视图)已经自动帮我们封装成了TemplatePortal，我们也已经拿到了这些TemplatePortal，剩下的就是在什么位置显示他们了。有两种方式显示他们，第一种自己new DomPortalHost来attach，这个我们上面的例子中有实际的例子、第二种通过CdkPortalOutlet指令来显示。这个也是我们下面要讲到的内容。</p> <h3 id="cdkportaloutlet指令使用"><a href="#cdkportaloutlet指令使用" class="header-anchor">#</a> CdkPortalOutlet指令使用</h3> <p>CdkPortalOutlet表示添加了该指令的元素是一个PortalOutlet，可以在他上面添加Portal元素。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ViewChild<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>TemplatePortal<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/portal'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-portal'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- Portal显示的位置 --&gt;
        &lt;div class=&quot;demo-portal-host&quot;&gt;
            &lt;!-- cdkPortalOutlet来指定动态内容需要放置的地方，参数是selectedPortal他是一个ComponentPortal或者TemplatePortal
             显示的内容会根据selectedPortal的改变而改变--&gt;
            &lt;ng-template cdkPortalHost [cdkPortalOutlet]=&quot;templatePortal&quot; (attached)=&quot;onPortalAttached()&quot;&gt;&lt;/ng-template&gt;
        &lt;/div&gt;

        &lt;!-- #divPortal=&quot;cdkPortal&quot;,CdkPortal指令有exportAs: 'cdkPortal'元数据，所以我们才可以这么写来获取，来获取CdkPortal对象  --&gt;
        &lt;ng-template #templatePortal=&quot;cdkPortal&quot; cdkPortal&gt;
            &lt;h2&gt; cdkPortalHost cdkPortal 配合使用动态显示&lt;/h2&gt;
        &lt;/ng-template&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-portal.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkPortalComponent</span>  <span class="token punctuation">{</span>
    <span class="token comment">// cdkPortal指令对应的Portal</span>
    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'templatePortal'</span><span class="token punctuation">)</span> templatePortal<span class="token operator">:</span> TemplatePortal<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token function">onPortalAttached</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'PortalOutlet 有元素attach上来了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="用法汇总实例"><a href="#用法汇总实例" class="header-anchor">#</a> 用法汇总实例</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>h2 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>我是component<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template #portalComponentOutlet cdkPortalOutlet<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>h2 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>我是template<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template #portalTemplateOutlet cdkPortalOutlet<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>h2 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>我是会变得<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template <span class="token punctuation">[</span>cdkPortalOutlet<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;greeting&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>h2 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>我是自动获取的<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template <span class="token punctuation">[</span>cdkPortalOutlet<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;myCdkPortal2&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template cdkPortal #myCdkPortal<span class="token operator">&gt;</span>
  我是自动获取的，我是自动获取的
<span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>ng<span class="token operator">-</span>template #tpl<span class="token operator">&gt;</span>
  ng template portal
<span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>template<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  Component<span class="token punctuation">,</span>
  OnInit<span class="token punctuation">,</span>
  ViewChild<span class="token punctuation">,</span>
  TemplateRef<span class="token punctuation">,</span>
  ViewContainerRef
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  CdkPortalOutlet<span class="token punctuation">,</span>
  ComponentPortal<span class="token punctuation">,</span>
  TemplatePortal<span class="token punctuation">,</span>
  CdkPortal
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/portal&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PortalCompComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./portal-comp/portal-comp.component&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&quot;app-portal&quot;</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">&quot;./portal.component.html&quot;</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./portal.component.scss&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PortalComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  greeting<span class="token operator">:</span> any<span class="token punctuation">;</span>
  @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;portalComponentOutlet&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> CdkPortalOutlet <span class="token punctuation">}</span><span class="token punctuation">)</span>
  portalComponentOutlet<span class="token operator">:</span> CdkPortalOutlet<span class="token punctuation">;</span>

  @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;portalTemplateOutlet&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> CdkPortalOutlet <span class="token punctuation">}</span><span class="token punctuation">)</span>
  portalTemplateOutlet<span class="token operator">:</span> CdkPortalOutlet<span class="token punctuation">;</span>

  @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;myCdkPortal&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> CdkPortal <span class="token punctuation">}</span><span class="token punctuation">)</span>
  myCdkPortal2<span class="token operator">:</span> CdkPortal<span class="token punctuation">;</span>

  @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;tpl&quot;</span><span class="token punctuation">)</span> tpl<span class="token operator">:</span> TemplateRef<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> view<span class="token operator">:</span> ViewContainerRef</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>myCdkPortal2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> componentPortal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComponentPortal</span><span class="token punctuation">(</span>PortalCompComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> templatePortal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TemplatePortal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tpl<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// attach后不可变</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>portalComponentOutlet<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>componentPortal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// attach后不可变</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>portalTemplateOutlet<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>templatePortal<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 可以检测自动变更 推荐</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> componentPortal<span class="token punctuation">;</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">===</span> templatePortal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> componentPortal<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> templatePortal<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br></div></div><h2 id="angular-cdk-overlay"><a href="#angular-cdk-overlay" class="header-anchor">#</a> @angular/cdk/overlay</h2> <p>cdk Overlay主要用来实现在界面上创建浮动面板，例如弹窗(Dialog)，下拉框(select)等等都可以通过cdk Overlay来实现。OverlayRef(Overlay service里面的create函数创建)就对应着Portals里面的PortalOutlet，Overlay里面我们需要放置的内容就对应着Portals里面的Portal。</p> <p>Overlay的使用也很简单，关键在两个地方：位置策略、滑动策略。一个处理overlay的显示位置，一个处理有滑动的时候overlay的动作。</p> <h3 id="位置策略-positionstrategy"><a href="#位置策略-positionstrategy" class="header-anchor">#</a> 位置策略(PositionStrategy)</h3> <p>位置策略(PositionStrategy)：用来确定overlay在页面中的显示位置。overlay里面提供了OverlayPositionBuilder类来构建PositionStrategy。overlay也给我们提供了三种PositionStrategy：GlobalPositionStrategy、ConnectedPositionStrategy和FlexibleConnectedPositionStrategy。</p> <h4 id="globalpositionstrategy"><a href="#globalpositionstrategy" class="header-anchor">#</a> GlobalPositionStrategy</h4> <p>当overlay的PositionStrategy设置成GlobalPositionStrategy的时候，overlay的位置是相对整个窗口而言的。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">GlobalPositionStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">PositionStrategy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * overlay距离上边
     */</span>
    <span class="token function">top</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * overlay距离左边
     */</span>
    <span class="token function">left</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * overlay距离下边
     */</span>
    <span class="token function">bottom</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * overlay距离右边
     */</span>
    <span class="token function">right</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * overlay宽度
     */</span>
    <span class="token function">width</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * overlay 高度
     */</span>
    <span class="token function">height</span><span class="token punctuation">(</span>value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 水平居中
     */</span>
    <span class="token function">centerHorizontally</span><span class="token punctuation">(</span>offset<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 垂直居中
     */</span>
    <span class="token function">centerVertically</span><span class="token punctuation">(</span>offset<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="connectedpositionstrategy"><a href="#connectedpositionstrategy" class="header-anchor">#</a> ConnectedPositionStrategy</h4> <p>当overlay的位置需要依赖于另外一个视图的位置的时候采用该ConnectedPositionStrategy来确定overlay的位置。因为ConnectedPositionStrategy完全可以用FlexibleConnectedPositionStrategy来代替。所有我们直接看FlexibleConnectedPositionStrategy。</p> <h4 id="flexibleconnectedpositionstrategy"><a href="#flexibleconnectedpositionstrategy" class="header-anchor">#</a> FlexibleConnectedPositionStrategy</h4> <p>overlay的位置依赖于某个视图的位置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">GlobalPositionStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">PositionStrategy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 当origin视图位置改变之后，可以调用该函数来重写设置overlay的位置
     */</span>
    <span class="token function">reapplyLastPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * Sets the list of Scrollable containers that host the origin element so that
     * on reposition we can evaluate if it or the overlay has been clipped or outside view. Every
     * Scrollable must be an ancestor element of the strategy's origin element.
     * 看上面英文的意思是，当origin视图包含在CdkScrollable里面的时候，需要设置。我现在还没搞明白这个函数的使用，等后续看了scrolling 看下
     */</span>
    <span class="token function">withScrollableContainers</span><span class="token punctuation">(</span>scrollables<span class="token operator">:</span> CdkScrollable<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置overlay的位置 (我们要重点解释下为什么是数组，比如有这种情况，你本来想把overlay放在origin视图的下面的，有可能会有这种情况吧
     * 比如，放下面已经放不下了，在窗口外面去了，这个时候就会去取数组里面的第二个元素布局了)
     * ConnectedPosition其实也很好理解，origin视图的哪个点（originX，originY）和overlay（overlayX， overlayY）重合确定位置
     */</span>
    <span class="token function">withPositions</span><span class="token punctuation">(</span>positions<span class="token operator">:</span> ConnectedPosition<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置overlay相对窗口的margin。确定位置判断的时候会用到
     */</span>
    <span class="token function">withViewportMargin</span><span class="token punctuation">(</span>margin<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置是否限制在窗体内，设置为true的时候withScrollableContainers里面的数组就有效果了
     */</span>
    <span class="token function">withFlexibleDimensions</span><span class="token punctuation">(</span>flexibleDimensions<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/** Sets whether the overlay can grow after the initial open via flexible width/height. */</span>
    <span class="token function">withGrowAfterOpen</span><span class="token punctuation">(</span>growAfterOpen<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/** Sets whether the overlay can be pushed on-screen if none of the provided positions fit. */</span>
    <span class="token function">withPush</span><span class="token punctuation">(</span>canPush<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * ScrollStrategy设置RepositionScrollStrategy的时候，
     * 如果是true，overlay会一直跟着origin视图。false的时候，overlay滑倒窗口边缘的时候就不会动了
     */</span>
    <span class="token function">withLockedPosition</span><span class="token punctuation">(</span>isLocked<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置origin视图(overlay依赖的视图)
     */</span>
    <span class="token function">setOrigin</span><span class="token punctuation">(</span>origin<span class="token operator">:</span> ElementRef <span class="token operator">|</span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 默认x的偏移量
     */</span>
    <span class="token function">withDefaultOffsetX</span><span class="token punctuation">(</span>offset<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 默认y偏移量
     */</span>
    <span class="token function">withDefaultOffsetY</span><span class="token punctuation">(</span>offset<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><h3 id="滑动策略-scrollstrategy"><a href="#滑动策略-scrollstrategy" class="header-anchor">#</a> 滑动策略(ScrollStrategy)</h3> <p>滑动策略(ScrollStrategy)：当PositionStrategy是ConnectedPositionStrategy或者FlexibleConnectedPositionStrategy的时候，如果overlay依赖的控件位置改变的时候overlay的位置应该怎么变化。</p> <p>overlay里面通过ScrollStrategyOptions来创建ScrollStrategy。同样overlay里面也给我们提供了四种ScrollStrategy：NoopScrollStrategy、CloseScrollStrategy、BlockScrollStrategy和RepositionScrollStrategy。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>ScrollStrategy的使用一般配合PositionStrategy的ConnectedPositionStrategy、FlexibleConnectedPositionStrategy来使用。因为GlobalPositionStrategy的时候很少有scroll的情况。所以文章中提到的origin指的是overlay依赖的那个视图。</p></div> <table><thead><tr><th style="text-align:left;">ScrollStrategy</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">NoopScrollStrategy</td> <td style="text-align:left;">origin滚动的时候，overlay位置不动</td></tr> <tr><td style="text-align:left;">CloseScrollStrategy</td> <td style="text-align:left;">origin位置变动的时候，overlay会自动关掉</td></tr> <tr><td style="text-align:left;">BlockScrollStrategy</td> <td style="text-align:left;">origin的滚动也消失了，直接把origin的滚动干没了</td></tr> <tr><td style="text-align:left;">RepositionScrollStrategy</td> <td style="text-align:left;">overlay会跟着origin位置的变动而变动</td></tr></tbody></table> <h3 id="overlay-service"><a href="#overlay-service" class="header-anchor">#</a> Overlay(Service)</h3> <p>Overlay是一个Service。Overlay主要用来帮我们干三件事：创建OverlayRef(对应overlay视图，然后我们就可以把自定义的组件或者ng-tempalate里面的内容attach到OverlayRef上。这样就是overlay了)、创建PositionStrategy、创建ScrollStrategy。Overlay主要方法介绍：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">Overlay</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * ScrollStrategyOptions - ScrollStrategy构造
     */</span>
    scrollStrategies<span class="token operator">:</span> ScrollStrategyOptions<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 构造函数，这个我们不用管，我们只需要知道service怎么用就可以了
     */</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>
        scrollStrategies<span class="token operator">:</span> ScrollStrategyOptions<span class="token punctuation">,</span> _overlayContainer<span class="token operator">:</span> OverlayContainer
        <span class="token punctuation">,</span> _componentFactoryResolver<span class="token operator">:</span> ComponentFactoryResolver
        <span class="token punctuation">,</span> _positionBuilder<span class="token operator">:</span> OverlayPositionBuilder
        <span class="token punctuation">,</span> _keyboardDispatcher<span class="token operator">:</span> OverlayKeyboardDispatcher
        <span class="token punctuation">,</span> _injector<span class="token operator">:</span> Injector<span class="token punctuation">,</span> _ngZone<span class="token operator">:</span> NgZone
        <span class="token punctuation">,</span> _document<span class="token operator">:</span> any<span class="token punctuation">,</span> _directionality<span class="token operator">:</span> Directionality
        <span class="token punctuation">,</span> _location<span class="token operator">?</span><span class="token operator">:</span> Location <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 创建OverlayRef
     */</span>
    <span class="token function">create</span><span class="token punctuation">(</span>config<span class="token operator">?</span><span class="token operator">:</span> OverlayConfig<span class="token punctuation">)</span><span class="token operator">:</span> OverlayRef<span class="token punctuation">;</span>
    <span class="token comment">/**
     * OverlayPositionBuilder - PositionStrategy构造器
     */</span>
    <span class="token function">position</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OverlayPositionBuilder<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>默认情况下overlay是直接添加在body的第一次层节点下面的，这部分的内容是通过OverlayContainer Service来实现的。有兴趣的可以看下OverlayContainer内部的实现。同时cdk Overlay里面也给提供了FullscreenOverlayContainer Service用来应对可能我们某些组件需要设置全屏的情况，比如有一个播放节点video。有全屏播放的功能。在全屏播放的时候你也想弹出overlay来的。这个时候就得添加providers: <code>[{provide: OverlayContainer, useClass: FullscreenOverlayContainer}]</code>。</p></div> <h3 id="overlay-directive"><a href="#overlay-directive" class="header-anchor">#</a> Overlay(directive)</h3> <p>cdk Overlay里面给提供了两个指令CdkOverlayOrigin和CdkConnectedOverlay。一个对应origin(overlay定位依赖的视图),一个对应overlay。</p> <h4 id="cdkoverlayorigin"><a href="#cdkoverlayorigin" class="header-anchor">#</a> CdkOverlayOrigin</h4> <p>添加了CdkOverlayOrigin指令的视图表示该视图是overlay的origin视图。CdkOverlayOrigin指令的使用非常简单没有@Input、@Output。</p> <ul><li>Selector: <code>[cdk-overlay-origin] [overlay-origin] [cdkOverlayOrigin]</code></li> <li>Exported as: cdkOverlayOrigin</li></ul> <h4 id="cdkconnectedoverlay"><a href="#cdkconnectedoverlay" class="header-anchor">#</a> CdkConnectedOverlay</h4> <p>添加了CdkConnectedOverlay指令的嵌入视图元素(一般都是加载ng-template上)表明该嵌入元素是一个overlay。</p> <ul><li>Selector: [cdk-connected-overlay] [connected-overlay] [cdkConnectedOverlay]</li> <li>Exported as: cdkConnectedOverlay</li></ul> <p>CdkConnectedOverlay指令提供的属性有:</p> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">backdropClass: string</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayBackdropClass’)</td> <td style="text-align:left;">背景层class</td></tr> <tr><td style="text-align:left;">flexibleDimensions: boolean</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayFlexibleDimensions’)</td> <td style="text-align:left;">overlay是否需要限制在窗口内</td></tr> <tr><td style="text-align:left;">growAfterOpen: boolean</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayGrowAfterOpen’)</td> <td style="text-align:left;">覆盖层是否可以在初始打开后增长</td></tr> <tr><td style="text-align:left;">hasBackdrop: any</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayHasBackdrop’)</td> <td style="text-align:left;">是否给overlay设置背景层 RepositionScrollStrategy的时候overlay是否一致跟着origin走，就算origin滑出到屏幕</td></tr> <tr><td style="text-align:left;">height: number</td> <td style="text-align:left;">string</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayHeight’)</td></tr> <tr><td style="text-align:left;">lockPosition: any</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayLockPosition’)</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">minHeight: number</td> <td style="text-align:left;">string</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayMinHeight’)</td></tr> <tr><td style="text-align:left;">minWidth: number</td> <td style="text-align:left;">string</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayMinWidth’)</td></tr> <tr><td style="text-align:left;">offsetX: number</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayOffsetX’)</td> <td style="text-align:left;">overlay x偏移</td></tr> <tr><td style="text-align:left;">offsetY: number</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayOffsetY’)</td> <td style="text-align:left;">overlay y偏移</td></tr> <tr><td style="text-align:left;">open: boolean</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayOpen’)</td> <td style="text-align:left;">overlay显示隐藏</td></tr> <tr><td style="text-align:left;">origin: CdkOverlayOrigin</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayOrigin’)</td> <td style="text-align:left;">设置overlay的origin(依赖的视图)</td></tr> <tr><td style="text-align:left;">panelClass: string</td> <td style="text-align:left;">string[]</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayPanelClass’)</td></tr> <tr><td style="text-align:left;">positions: ConnectedPosition[]</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayPositions’)</td> <td style="text-align:left;">overlay位置设定</td></tr> <tr><td style="text-align:left;">push: boolean</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayPush’)</td> <td style="text-align:left;">如果我们给overlay提供的位置都不适合的时候，是否可以重叠显示</td></tr> <tr><td style="text-align:left;">scrollStrategy: ScrollStrategy</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayScrollStrategy’)</td> <td style="text-align:left;">ScrollStrategy</td></tr> <tr><td style="text-align:left;">viewportMargin: number</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayViewportMargin’)</td> <td style="text-align:left;">overlay窗口margin</td></tr> <tr><td style="text-align:left;">width: number</td> <td style="text-align:left;">string</td> <td style="text-align:left;">@Input(‘cdkConnectedOverlayWidth’)</td></tr> <tr><td style="text-align:left;">attach: EventEmitter</td> <td style="text-align:left;">@Output()</td> <td style="text-align:left;">overlay attach的时候回调</td></tr> <tr><td style="text-align:left;">backdropClick: EventEmitter</td> <td style="text-align:left;">@Output()</td> <td style="text-align:left;">点击了overlay背景层的回调</td></tr> <tr><td style="text-align:left;">detach: EventEmitter</td> <td style="text-align:left;">@Output()	overlay detach的时候调用</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">overlayKeydown: EventEmitter</td> <td style="text-align:left;">@Output()</td> <td style="text-align:left;">overlay显示的时候有键盘按键按下</td></tr> <tr><td style="text-align:left;">positionChange: EventEmitter</td> <td style="text-align:left;">@Output()</td> <td style="text-align:left;">overlay位置改变的时候的回调</td></tr> <tr><td style="text-align:left;">dir: Direction</td> <td style="text-align:left;">无</td> <td style="text-align:left;">overlay里面的布局方向</td></tr> <tr><td style="text-align:left;">overlayRef: OverlayRef</td> <td style="text-align:left;">无</td> <td style="text-align:left;">overlay对应的OverlayRef(对overlay的一个封装，类似ElementRef)</td></tr></tbody></table> <h3 id="overlay使用"><a href="#overlay使用" class="header-anchor">#</a> Overlay使用</h3> <ol><li>使用之前要加上Overlay库里面的css同时导入OverlayModule.`@import '~@angular/cdk/overlay-prebuilt.css';</li> <li>导入OverlayModule</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>NgModule<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>OverlayModule<span class="token punctuation">,</span> OverlayContainer<span class="token punctuation">,</span> FullscreenOverlayContainer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/overlay&quot;</span><span class="token punctuation">;</span>
@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    imports<span class="token operator">:</span> <span class="token punctuation">[</span>
        OverlayModule<span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayModule</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="3"><li>在实例之前我们先自定义一个非常简单的动态组件，后面的实例我们都会用到这个组件，注意哦这个动态组件除了在declarations里面需要申明，在entryComponents里面也需要申明。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">'app-overlay-panel'</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;p class=&quot;wu-overlay-pane&quot;&gt;Overlay展示&lt;/p&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    .wu-overlay-pane {
      margin: 0;
      padding: 10px;
      border: 1px solid black;
      background-color: skyblue;
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">OverlayPanelComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    declarations<span class="token operator">:</span> <span class="token punctuation">[</span>
        OverlayPanelComponent
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    entryComponents<span class="token operator">:</span> <span class="token punctuation">[</span>
        OverlayPanelComponent
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayModule</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="把overlaypanelcomponent组件显示在屏幕中间"><a href="#把overlaypanelcomponent组件显示在屏幕中间" class="header-anchor">#</a> 把OverlayPanelComponent组件显示在屏幕中间</h4> <p>这里主要是GlobalPositionStrategy的使用，以及hasBackdrop的使用。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ViewContainerRef<span class="token punctuation">,</span> ViewEncapsulation<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Overlay<span class="token punctuation">,</span> OverlayConfig<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ComponentPortal<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/portal'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>OverlayPanelComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./panel/overlay-panel.component'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-overlay'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- 全局显示 页面中心显示 (点击的时候显示) --&gt;
        &lt;button (click)=&quot;showOverlayGlobalPanelCenter()&quot;&gt;页面中心显示&lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    preserveWhitespaces<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayComponent</span> <span class="token punctuation">{</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> overlay<span class="token operator">:</span> Overlay
        <span class="token punctuation">,</span> <span class="token keyword">public</span> viewContainerRef<span class="token operator">:</span> ViewContainerRef</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * overlay 在整个屏幕的中间显示
     */</span>
    <span class="token function">showOverlayGlobalPanelCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// config: OverlayConfig overlay的配置，配置显示位置，和滑动策略</span>
        <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OverlayConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>positionStrategy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 全局显示</span>
            <span class="token punctuation">.</span><span class="token function">centerHorizontally</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 水平居中</span>
            <span class="token punctuation">.</span><span class="token function">centerVertically</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 垂直居中</span>
        config<span class="token punctuation">.</span>hasBackdrop <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 设置overlay后面有一层背景, 当然你也可以设置backdropClass 来设置这层背景的class</span>
        <span class="token keyword">const</span> overlayRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OverlayRef, overlay层</span>
        overlayRef<span class="token punctuation">.</span><span class="token function">backdropClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 点击了backdrop背景</span>
            overlayRef<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// OverlayPanelComponent是动态组件</span>
        <span class="token comment">// 创建一个ComponentPortal，attach到OverlayRef，这个时候我们这个overlay层就显示出来了。</span>
        overlayRef<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ComponentPortal</span><span class="token punctuation">(</span>OverlayPanelComponent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 监听overlayRef上的键盘按键事件</span>
        overlayRef<span class="token punctuation">.</span><span class="token function">keydownEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> KeyboardEvent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>overlayRef<span class="token punctuation">.</span>_keydownEventSubscriptions <span class="token operator">+</span> <span class="token string">' times'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h4 id="把overlaypanelcomponent组件显示在屏幕上，自己控制位置"><a href="#把overlaypanelcomponent组件显示在屏幕上，自己控制位置" class="header-anchor">#</a> 把OverlayPanelComponent组件显示在屏幕上，自己控制位置</h4> <p>GlobalPositionStrategy的使用，GlobalPositionStrategy自定义位置。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> Inject<span class="token punctuation">,</span> ViewContainerRef<span class="token punctuation">,</span> ViewEncapsulation<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Overlay<span class="token punctuation">,</span> OverlayConfig<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ComponentPortal<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/portal'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>OverlayPanelComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./panel/overlay-panel.component'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">DOCUMENT</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/common'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-overlay'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- 全局显示 页面中显示位置自己控制 --&gt;
        &lt;button (click)=&quot;showOverlayGlobalPanelPosition()&quot;&gt;页面中显示，自己控制位置&lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    preserveWhitespaces<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayComponent</span> <span class="token punctuation">{</span>
    globalOverlayPosition <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> overlay<span class="token operator">:</span> Overlay
        <span class="token punctuation">,</span> <span class="token keyword">public</span> viewContainerRef<span class="token operator">:</span> ViewContainerRef
        <span class="token punctuation">,</span> @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token constant">DOCUMENT</span><span class="token punctuation">)</span> <span class="token keyword">public</span> _document<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * overlay 在整个屏幕位置，自己控制位置
     */</span>
    <span class="token function">showOverlayGlobalPanelPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OverlayConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>positionStrategy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>globalOverlayPosition<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// 自己控制位置</span>
            <span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>globalOverlayPosition<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>globalOverlayPosition <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>hasBackdrop <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> overlayRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        overlayRef<span class="token punctuation">.</span><span class="token function">backdropClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            overlayRef<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 点击背景关掉弹窗</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        overlayRef<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ComponentPortal</span><span class="token punctuation">(</span>OverlayPanelComponent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h4 id="overlay里面显示ng-template内容"><a href="#overlay里面显示ng-template内容" class="header-anchor">#</a> overlay里面显示ng-template内容</h4> <p>怎么在overlay上显示ng-template里面的内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ViewChild<span class="token punctuation">,</span> ViewEncapsulation<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Overlay<span class="token punctuation">,</span> OverlayConfig<span class="token punctuation">,</span> OverlayRef<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>TemplatePortalDirective<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/portal'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-overlay'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- 鼠标移入的时候显示 ng-template对应的内容，移出的时候不显示 --&gt;
        &lt;button style=&quot;margin-left: 10px&quot; (mouseenter)=&quot;showOverlayPanelTemplate()&quot;
                (mouseleave)=&quot;dismissOverlayPanelTemplate()&quot;&gt;
            显示 ng-template 内容
        &lt;/button&gt;
        &lt;!-- ng-template overlay 将要显示的内容 --&gt;
        &lt;ng-template cdk-portal #overlayGlobalTemplate=&quot;cdkPortal&quot;&gt;
            &lt;p class=&quot;template-overlay-pane&quot;&gt; ng-temtortelliniTemplateplate显示 &lt;/p&gt;
        &lt;/ng-template&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .template-overlay-pane {
            padding: 10px;
            border: 1px solid black;
            background-color: skyblue;
        }</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    preserveWhitespaces<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayComponent</span> <span class="token punctuation">{</span>

    globalOverlayPosition <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> _overlayTemplateRef<span class="token operator">:</span> OverlayRef<span class="token punctuation">;</span>

    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'overlayGlobalTemplate'</span><span class="token punctuation">)</span> templateGlobalPortals<span class="token operator">:</span> TemplatePortalDirective<span class="token punctuation">;</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> overlay<span class="token operator">:</span> Overlay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 显示 ng-template 的内容
     */</span>
    <span class="token function">showOverlayPanelTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OverlayConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>positionStrategy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">centerHorizontally</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>globalOverlayPosition<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>globalOverlayPosition <span class="token operator">+=</span> <span class="token number">30</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayTemplateRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayTemplateRef<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>templateGlobalPortals<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 移除 ng-template 内容
     */</span>
    <span class="token function">dismissOverlayPanelTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_overlayTemplateRef <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayTemplateRef<span class="token punctuation">.</span><span class="token function">hasAttached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayTemplateRef<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h4 id="overlay依赖于某个视图-origin-显示"><a href="#overlay依赖于某个视图-origin-显示" class="header-anchor">#</a> overlay依赖于某个视图(origin)显示</h4> <p>FlexibleConnectedPositionStrategy的使用，怎么通过FlexibleConnectedPositionStrategy来控制显示的位置(ConnectedPosition)。同时也有ScrollStrategy的使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> ViewChild<span class="token punctuation">,</span> ViewContainerRef<span class="token punctuation">,</span> ViewEncapsulation<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Overlay<span class="token punctuation">,</span> OverlayConfig<span class="token punctuation">,</span> OverlayRef<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ComponentPortal<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/portal'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>OverlayPanelComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./panel/overlay-panel.component'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-overlay'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- 依附某个组件或者template显示,鼠标移入的时候显示，移出来的时候不显示 --&gt;
        &lt;button style=&quot;margin-left: 10px&quot; #connectComponentOrigin
                (mouseenter)=&quot;showOverlayPanelConnectComponent()&quot;
                (mouseleave)=&quot;dismissOverlayPanelConnectComponent()&quot;&gt;
            overlay connect 组件显示
        &lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    preserveWhitespaces<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayComponent</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> _overlayConnectRef<span class="token operator">:</span> OverlayRef<span class="token punctuation">;</span>

    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'connectComponentOrigin'</span><span class="token punctuation">)</span> _overlayConnectComponentOrigin<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> overlay<span class="token operator">:</span> Overlay
        <span class="token punctuation">,</span> <span class="token keyword">public</span> viewContainerRef<span class="token operator">:</span> ViewContainerRef</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * overlay connect origin 显示，依附某个组件显示
     */</span>
    <span class="token function">showOverlayPanelConnectComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> strategy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">flexibleConnectedTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_overlayConnectComponentOrigin<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withPositions</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
                originX<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                originY<span class="token operator">:</span> <span class="token string">'bottom'</span><span class="token punctuation">,</span>
                overlayX<span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
                overlayY<span class="token operator">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span>
                offsetX<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                offsetY<span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 这么理解 origin 组件(依附空组件) 的那个点(originX, originY) 和 overlay组件的点(overlayX, overlayY)</span>
        <span class="token comment">// 重合，从而确定overlay组件显示的位置</span>
        strategy<span class="token punctuation">.</span><span class="token function">withLockedPosition</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OverlayConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>positionStrategy<span class="token operator">:</span> strategy<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span>scrollStrategy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span>scrollStrategies<span class="token punctuation">.</span><span class="token function">reposition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 更随滑动的策略</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayConnectRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overlay<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayConnectRef<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ComponentPortal</span><span class="token punctuation">(</span>OverlayPanelComponent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">dismissOverlayPanelConnectComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_overlayConnectRef <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayConnectRef<span class="token punctuation">.</span><span class="token function">hasAttached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_overlayConnectRef<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h4 id="指令使用"><a href="#指令使用" class="header-anchor">#</a> 指令使用</h4> <p>cdk-overlay-origin和cdk-connected-overlay怎么配合起来使用，怎么把两个指令关联起来。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ViewEncapsulation<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Overlay<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-overlay'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;button cdk-overlay-origin #trigger=&quot;cdkOverlayOrigin&quot; (click)=&quot;isMenuOpen = !isMenuOpen&quot;&gt;
            指令实现
        &lt;/button&gt;
        &lt;ng-template cdk-connected-overlay
                     [cdkConnectedOverlayOrigin]=&quot;trigger&quot;
                     [cdkConnectedOverlayWidth]=&quot;500&quot;
                     cdkConnectedOverlayHasBackdrop
                     [cdkConnectedOverlayOpen]=&quot;isMenuOpen&quot;
                     (backdropClick)=&quot;isMenuOpen=false&quot;&gt;
            &lt;div class=&quot;menu-wrap&quot;&gt;
                我是通过指令实现的Overlay
            &lt;/div&gt;
        &lt;/ng-template&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-overlay.component.less'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    preserveWhitespaces<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkOverlayComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * overlay是否显示
     */</span>
    isMenuOpen <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> overlay<span class="token operator">:</span> Overlay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="angular-cdk-scrolling"><a href="#angular-cdk-scrolling" class="header-anchor">#</a> @angular/cdk/scrolling</h2> <p>scrolling 对滚动事件做出响应的工具包。</p> <p>想要在我们项目中使用cdk Scrolling功能，需要在我们模块里面 <code>import {ScrollDispatchModule} from ‘@angular/cdk/scrolling’;</code></p> <p>然而<code>ScrollDispatcher/CdkScrollable/ViewportRuler</code>来自<code>@angular/cdk/overlay</code>。</p> <h3 id="cdkscrollable-scrolldispatcher"><a href="#cdkscrollable-scrolldispatcher" class="header-anchor">#</a> cdkScrollable/ScrollDispatcher</h3> <p>cdkScrollable指令单独使用的时候没有特别的效果，cdkScrollable指令一般用来配合ScrollDispatcher Service使用。任何添加了cdkScrollable指令的视图元素都会注册到ScrollDispatcher里面去。然后可以在ScrollDispatcher里面去监听元素的滑动事件。</p> <h4 id="scrolldispatcher常用方法介绍"><a href="#scrolldispatcher常用方法介绍" class="header-anchor">#</a> ScrollDispatcher常用方法介绍</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">ScrollDispatcher</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 订阅全局`scroll`和`resize`
     */</span>
    _globalSubscription<span class="token operator">:</span> Subscription <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 注册到ScrollDispatcher里面的元素(添加了CdkScrollable指令的元素)
     */</span>
    scrollContainers<span class="token operator">:</span> Map<span class="token operator">&lt;</span>CdkScrollable<span class="token punctuation">,</span> Subscription<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 注册CdkScrollable(我们不用管，我们在某个视图元素上添加CdkScrollable指令会自动注册的)
     */</span>
    <span class="token function">register</span><span class="token punctuation">(</span>scrollable<span class="token operator">:</span> CdkScrollable<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 取消注册
     */</span>
    <span class="token function">deregister</span><span class="token punctuation">(</span>scrollable<span class="token operator">:</span> CdkScrollable<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 可以去订阅任务一个注册CdkScrollable的scroll事件
     *
     * **Note:** 为了避免每次滚动都发送状态变化检测,内部采用的是NgZone.runOutsideAngular。所以如果你想每次都检测变化就采用NgZone.run的放
     * 有疑问可以去搜下NgZone的使用
     */</span>
    <span class="token function">scrolled</span><span class="token punctuation">(</span>auditTimeInMs<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>CdkScrollable <span class="token operator">|</span> <span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 监听elementRef视图元素的祖先元素有滚动事件，当然了对应的祖先元素需要添加CdkScrollable指令
     * auditTimeInMs参数是为了防止事件发送过快，可以设置多长时间收一次事件
     */</span>
    <span class="token function">ancestorScrolled</span><span class="token punctuation">(</span>elementRef<span class="token operator">:</span> ElementRef<span class="token punctuation">,</span> auditTimeInMs<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>CdkScrollable <span class="token operator">|</span> <span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     *  elementRef添加了CdkScrollable指令的祖先元素
     */</span>
    <span class="token function">getAncestorScrollContainers</span><span class="token punctuation">(</span>elementRef<span class="token operator">:</span> ElementRef<span class="token punctuation">)</span><span class="token operator">:</span> CdkScrollable<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="cdkscrollable-scrolldispatcher使用"><a href="#cdkscrollable-scrolldispatcher使用" class="header-anchor">#</a> cdkScrollable/ScrollDispatcher使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>AfterViewInit<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> OnInit<span class="token punctuation">,</span> ViewChild<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkScrollable<span class="token punctuation">,</span> ScrollDispatcher<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-scrolling'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- 通过cdkScrollable指令配合ScrollDispatcher来监听节点的scrolling --&gt;
        &lt;div cdkScrollable class=&quot;scrolling-parent&quot;&gt;
            &lt;div #scrollingParent class=&quot;scrolling-item&quot;&gt;item 1&lt;/div&gt;
            &lt;div class=&quot;scrolling-item&quot;&gt;item 2&lt;/div&gt;
            &lt;div class=&quot;scrolling-item&quot;&gt;item 3&lt;/div&gt;
        &lt;/div&gt;
        &lt;!-- 这个div没有添加cdkScrollable指令，所以这个div的scrolling事件ScrollDispatcher获取不到 --&gt;
        &lt;div class=&quot;scrolling-parent&quot;&gt;
            &lt;div class=&quot;scrolling-item&quot;&gt;item 1&lt;/div&gt;
            &lt;div class=&quot;scrolling-item&quot;&gt;item 2&lt;/div&gt;
            &lt;div class=&quot;scrolling-item&quot;&gt;item 3&lt;/div&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .scrolling-parent {
            height: 100px;
            width: 200px;
            border: 1px solid black;
            padding: 8px;
            overflow-y: auto;
        }
        .scrolling-item {
            height: 50px;
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkScrollingComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span><span class="token punctuation">,</span> AfterViewInit <span class="token punctuation">{</span>

    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'scrollingParent'</span><span class="token punctuation">)</span>
    childDiv<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> scrollDispatcher<span class="token operator">:</span> ScrollDispatcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * 监听所有ScrollDispatcher里面注册的CdkScrollable的scroll事件
         */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">scrolled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">scrollable<span class="token operator">:</span> CdkScrollable</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>scrollable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'发生scroll了，來源于：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>scrollable<span class="token punctuation">.</span><span class="token function">getElementRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * 第二个参数auditTimeInMs表示事件延时多少秒发生
         * 当祖先设置了cdkScrollable指令，在孩子里面也能抓到scrolling事件
         */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">ancestorScrolled</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>childDiv<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">scrollable<span class="token operator">:</span> CdkScrollable</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>scrollable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'祖先发生scroll了，來源于：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>scrollable<span class="token punctuation">.</span><span class="token function">getElementRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取ScrollDispatcher里面所有注册了scrolling的组件信息</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span>scrollContainers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h3 id="viewportruler"><a href="#viewportruler" class="header-anchor">#</a> ViewportRuler</h3> <p>ViewportRuler也是cdk Scrolling里面提供的一个Service。用来测量浏览器的视图窗口信息。</p> <h4 id="viewportruler常用方法"><a href="#viewportruler常用方法" class="header-anchor">#</a> ViewportRuler常用方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">ViewportRuler</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 获取浏览器窗口的宽度和高度 
     */</span>
    <span class="token function">getViewportSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Readonly<span class="token operator">&lt;</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> number<span class="token punctuation">;</span>
        height<span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 获取浏览器窗口的rect信息(left、top、right、bottom) 
     */</span>
    <span class="token function">getViewportRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ClientRect<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 获取浏览器窗口的滑动位置(top、left) 
     */</span>
    <span class="token function">getViewportScrollPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ViewportScrollPosition<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 监听浏览器窗口大小变化
     */</span>
    <span class="token function">change</span><span class="token punctuation">(</span>throttleTime<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>Event<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="viewportruler使用实例"><a href="#viewportruler使用实例" class="header-anchor">#</a> ViewportRuler使用实例</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ViewportRuler<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-scrolling'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkScrollingComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> viewPortRuler<span class="token operator">:</span> ViewportRuler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * ViewportRuler 用来监听窗口的大小
         */</span>
        <span class="token comment">// { width, height }</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>viewPortRuler<span class="token punctuation">.</span><span class="token function">getViewportSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// { bottom, height, left, right, top, width }</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>viewPortRuler<span class="token punctuation">.</span><span class="token function">getViewportRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// { top, left }</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>viewPortRuler<span class="token punctuation">.</span><span class="token function">getViewportScrollPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// native resize event object</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>viewPortRuler<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">resizeEvent</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resizeEvent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="示例汇总"><a href="#示例汇总" class="header-anchor">#</a> 示例汇总</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ScrollDispatcher 滚动调度器</span>
  @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;scrollAble&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> CdkScrollable <span class="token punctuation">}</span><span class="token punctuation">)</span>
  scrollAble<span class="token operator">:</span> CdkScrollable<span class="token punctuation">;</span>
  @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;scrollAble2&quot;</span><span class="token punctuation">)</span> scrollable2<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">public</span> scrollDispatcher<span class="token operator">:</span> ScrollDispatcher<span class="token punctuation">,</span>
    <span class="token keyword">public</span> ele<span class="token operator">:</span> ElementRef</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取所有cdkScrollable</span>
    <span class="token keyword">const</span> scrollContainers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span>scrollContainers<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;scrollContainers&quot;</span><span class="token punctuation">,</span> scrollContainers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 注销一个cdkScrollable</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">deregister</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollAble<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 注册一个cdkScrollable</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scrollAble<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取上级滚动容器</span>
    <span class="token keyword">let</span> elementRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollAble<span class="token punctuation">.</span><span class="token function">getElementRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> ancestorScrollContainers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">getAncestorScrollContainers</span><span class="token punctuation">(</span>
      elementRef
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> ancestorScrollContainers2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">getAncestorScrollContainers</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>scrollable2
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ancestorScrollContainers&quot;</span><span class="token punctuation">,</span> ancestorScrollContainers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ancestorScrollContainers2&quot;</span><span class="token punctuation">,</span> ancestorScrollContainers2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 滚动监听</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scrollDispatcher<span class="token punctuation">.</span><span class="token function">scrolled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">// CdkScrollable 可滚动指令,用于注册可滚动元素</span>
@<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">&quot;scrollAble&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> CdkScrollable <span class="token punctuation">}</span><span class="token punctuation">)</span>
scrollAble<span class="token operator">:</span> CdkScrollable<span class="token punctuation">;</span>
<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> scrollDispatcher<span class="token operator">:</span> ScrollDispatcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 元素是否滚动了</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>scrollAble<span class="token punctuation">.</span><span class="token function">elementScrolled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;scroll able scrolling&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取scroll able 的 ElementRef</span>
    <span class="token keyword">let</span> scrollable1ElementRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scrollAble<span class="token punctuation">.</span><span class="token function">getElementRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;scroll able element ref&quot;</span><span class="token punctuation">,</span> scrollable1ElementRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ViewportRuler 视口</span>
<span class="token comment">//import { ViewportRuler} from '@angular/material/core/overlay/position/viewport-ruler'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ViewportRuler<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/overlay'</span><span class="token punctuation">;</span>
<span class="token comment">// 注入视口尺寸服务</span>
<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> viewPort<span class="token operator">:</span> ViewportRuler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监控视口变化</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>viewPort<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getViewPortInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getViewPortInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 获取视口信息</span>
<span class="token function">getViewPortInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> viewRect <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewPort<span class="token punctuation">.</span><span class="token function">getViewportRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;view rect&quot;</span><span class="token punctuation">,</span> viewRect<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { width, height }</span>
    <span class="token keyword">let</span> viewPortScrollPosition <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewPort<span class="token punctuation">.</span><span class="token function">getViewportScrollPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;viewPortScrollPosition&quot;</span><span class="token punctuation">,</span> viewPortScrollPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// { top, left }</span>
    <span class="token keyword">let</span> viewPortSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>viewPort<span class="token punctuation">.</span><span class="token function">getViewportSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;viewPortSize&quot;</span><span class="token punctuation">,</span> viewPortSize<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">this</span><span class="token punctuation">.</span>viewPortRuler<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">resizeEvent</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resizeEvent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// native resize event object</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><h3 id="cdkvirtualscrollviewport"><a href="#cdkvirtualscrollviewport" class="header-anchor">#</a> CdkVirtualScrollViewport</h3> <p>angular cdk 里面给提供了一个scrolling的组件CdkVirtualScrollViewport - cdk-virtual-scroll-viewport。CdkVirtualScrollViewport组件在list展示的时候非常有用，比如有我们list里面的item有1000项的时候。CdkVirtualScrollViewport 并不会直接给我们加载出1000项。只会加载部分项。一边滑动一边加载。如果有做过android的话，应该会知道ListView里面的回收机制。CdkVirtualScrollViewport组件做的也是类似的事情。</p> <h4 id="cdkvirtualscrollviewport主要方法"><a href="#cdkvirtualscrollviewport主要方法" class="header-anchor">#</a> CdkVirtualScrollViewport主要方法:</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkVirtualScrollViewport</span> <span class="token keyword">extends</span> <span class="token class-name">CdkScrollable</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span><span class="token punctuation">,</span> OnDestroy <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 这个是CdkFixedSizeVirtualScroll里面的属性，也是可以设置在CdkVirtualScrollViewport组件上的
     * CdkVirtualScrollViewport组件里面每个item的大小(通过orientation来知道是高度还宽度)
     */</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">get</span> <span class="token function">itemSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_itemSize<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 这个是CdkFixedSizeVirtualScroll里面的属性，也是可以设置在CdkVirtualScrollViewport组件上的
     * 多加载滚动范围之后多少像素的距离(最小值)，比如CdkVirtualScrollViewport的高度是200px,minBufferPx
     * 是100px;  item有好多的情况下不用全部绘制出来。绘制200像素的内容就好了。
     */</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">get</span> <span class="token function">minBufferPx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_minBufferPx<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 这个是CdkFixedSizeVirtualScroll里面的属性，也是可以设置在CdkVirtualScrollViewport组件上的
     * 多加载滚动范围之后多少像素的距离(最大值)
     */</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">get</span> <span class="token function">maxBufferPx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_maxBufferPx<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment">/**
     * viewport 方向
     */</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> orientation<span class="token operator">:</span> <span class="token string">'horizontal'</span> <span class="token operator">|</span> <span class="token string">'vertical'</span> <span class="token operator">=</span> <span class="token string">'vertical'</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 活动过程中，当前可见第一项的index
     */</span>
    @<span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> scrolledIndexChange<span class="token operator">:</span> Observable<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span> <span class="token operator">=</span>
        Observable<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">observer<span class="token operator">:</span> Observer<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_scrollStrategy<span class="token punctuation">.</span>scrolledIndexChange<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">index</span> <span class="token operator">=&gt;</span>
                Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ngZone<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置滑动位置
     */</span>
    <span class="token function">scrollToOffset</span><span class="token punctuation">(</span>offset<span class="token operator">:</span> number<span class="token punctuation">,</span> behavior<span class="token operator">:</span> ScrollBehavior <span class="token operator">=</span> <span class="token string">'auto'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">/**
     * 设置滑动的index
     */</span>
    <span class="token function">scrollToIndex</span><span class="token punctuation">(</span>index<span class="token operator">:</span> number<span class="token punctuation">,</span>  behavior<span class="token operator">:</span> ScrollBehavior <span class="token operator">=</span> <span class="token string">'auto'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">/**
     * 测量可滑动的大小
     */</span>
    <span class="token function">measureScrollOffset</span><span class="token punctuation">(</span><span class="token keyword">from</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'top'</span> <span class="token operator">|</span> <span class="token string">'left'</span> <span class="token operator">|</span> <span class="token string">'right'</span> <span class="token operator">|</span> <span class="token string">'bottom'</span> <span class="token operator">|</span> <span class="token string">'start'</span> <span class="token operator">|</span> <span class="token string">'end'</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">/**
     * 测量所有item在一起的高度
     */</span>
    <span class="token function">measureRenderedContentSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> number<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>上面主要方法介绍我把CdkVirtualScrollViewport组件和CdkFixedSizeVirtualScroll指令揉到一起去介绍了，因为它俩本来就是一起配合使用的。</p></div> <h4 id="cdkvirtualforof指令"><a href="#cdkvirtualforof指令" class="header-anchor">#</a> CdkVirtualForOf指令</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Selector<span class="token operator">:</span> <span class="token punctuation">[</span>cdkVirtualFor<span class="token punctuation">]</span><span class="token punctuation">[</span>cdkVirtualForOf<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>CdkVirtualScrollViewport适用于list的情况，list循环的时候得配合CdkVirtualForOf指令来使用，CdkVirtualForOf的用法和ngFor的用法是一样的。CdkVirtualForOf指令是专门为CdkVirtualScrollViewport组件提供的。 就不用ngFor指令了。切记。如果想咱们平常一样用ngFor指令去循环，很多CdkVirtualScrollViewport组件里面特有的功能就用不了了。</p> <h4 id="cdkvirtualforof的使用"><a href="#cdkvirtualforof的使用" class="header-anchor">#</a> CdkVirtualForOf的使用</h4> <p>主要是知道CdkVirtualForOf里面有哪些参数是可用的</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ViewChild<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkVirtualScrollViewport<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/scrolling&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-virtual-scroll'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- itemSize是每个item的高度 --&gt;
        &lt;cdk-virtual-scroll-viewport #scrollComponent [itemSize]=&quot;18 * 7&quot; class=&quot;example-viewport&quot;&gt;
            &lt;!-- cdkVirtualFor的可以用参数如下 --&gt;
            &lt;div *cdkVirtualFor=&quot;let item of items;
                       let index = index;
                       let count = count;
                       let first = first;
                       let last = last;
                       let even = even;
                       let odd = odd;&quot; [class.example-alternate]=&quot;odd&quot;&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;Item: {{item}}&lt;/div&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;Index: {{index}}&lt;/div&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;Count: {{count}}&lt;/div&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;First: {{first ? 'Yes' : 'No'}}&lt;/div&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;Last: {{last ? 'Yes' : 'No'}}&lt;/div&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;Even: {{even ? 'Yes' : 'No'}}&lt;/div&gt;
                &lt;div class=&quot;example-item-detail&quot;&gt;Odd: {{odd ? 'Yes' : 'No'}}&lt;/div&gt;
            &lt;/div&gt;
        &lt;/cdk-virtual-scroll-viewport&gt;

        &lt;button style=&quot;margin-top: 8px; margin-bottom: 8px; background-color: #007bff; color: red&quot;
                (click)=&quot;onButtonClick()&quot;&gt;
            点击跳转到第10个item
        &lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .example-viewport {
            height: 200px;
            width: 200px;
            border: 1px solid black;
        }

        .example-item-detail {
            height: 18px;
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">VirtualScrollComponent</span> <span class="token punctuation">{</span>

    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'scrollComponent'</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> _scrollViewport<span class="token operator">:</span> CdkVirtualScrollViewport<span class="token punctuation">;</span>

    <span class="token comment">/**
     * CdkVirtualScrollViewport组件的数据源
     */</span>
    items <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span>length<span class="token operator">:</span> <span class="token number">100000</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Item #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 点击按钮的时候跳转到第10项
     */</span>
    <span class="token function">onButtonClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_scrollViewport<span class="token punctuation">.</span><span class="token function">scrollToIndex</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>水平方向滚动的CdkVirtualScrollViewport组件，主要是知道orientation属性的使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>ChangeDetectionStrategy<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> ViewEncapsulation<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-virtual-scroll-horizontal'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div class=&quot;cdk-virtual-scroll-data-source-example&quot;&gt;
            &lt;cdk-virtual-scroll-viewport orientation=&quot;horizontal&quot; itemSize=&quot;50&quot; class=&quot;example-viewport&quot;&gt;
                &lt;div *cdkVirtualFor=&quot;let item of items&quot; class=&quot;example-item&quot;&gt;{{item}}&lt;/div&gt;
            &lt;/cdk-virtual-scroll-viewport&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .cdk-virtual-scroll-data-source-example .example-viewport {
            height: 200px;
            width: 200px;
            border: 1px solid black;
        }
        .cdk-virtual-scroll-data-source-example .example-viewport .cdk-virtual-scroll-content-wrapper {
            display: flex;
            flex-direction: row;
        }
        .cdk-virtual-scroll-data-source-example .example-item {
            width: 50px;
            height: 100%;
            writing-mode: vertical-lr;
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    changeDetection<span class="token operator">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">VirtualScrollHorizontalComponent</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * CdkVirtualScrollViewport组件里面的数据源
     */</span>
    items <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">{</span>length<span class="token operator">:</span> <span class="token number">100000</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Item #</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="angular-cdk-drag-drop"><a href="#angular-cdk-drag-drop" class="header-anchor">#</a> @angular/cdk/drag-drop</h2> <p>Angualr drag-drop里面的功能能让我们非常方便的处理页面上视图的拖拽(自由拖拽、列表排序拖拽、列表之间拖拽)问题。drag-drop使用之前也需要导入DragDropModule模块</p> <h3 id="cdkdrag"><a href="#cdkdrag" class="header-anchor">#</a> CdkDrag</h3> <p>CdkDrag是一个指令。添加了CdkDrag指令的视图，表明该视图是可以拖拽的。</p> <ul><li>Selector: <code>[cdkDrag]</code></li> <li>Exported as: cdkDrag</li></ul> <h4 id="cdkdrag属性"><a href="#cdkdrag属性" class="header-anchor">#</a> CdkDrag属性</h4> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">data: T</td> <td style="text-align:left;">@Input(‘cdkDragData’)</td> <td style="text-align:left;">CdkDrag指令对应组件元素实例上的数据</td></tr> <tr><td style="text-align:left;">disabled: boolean</td> <td style="text-align:left;">@Input(‘cdkDragDisabled’)</td> <td style="text-align:left;">是否禁用从此容器启动拖动序列(我试了下这个属性好像没效果)</td></tr> <tr><td style="text-align:left;">lockAxis: ‘x’</td> <td style="text-align:left;">‘y’</td> <td style="text-align:left;">@Input(‘cdkDragLockAxis’)</td></tr> <tr><td style="text-align:left;">rootElementSelector: string</td> <td style="text-align:left;">@Input(‘cdkDragRootElement’)</td> <td style="text-align:left;">传递可拖动元素替代的根元素(换句话说现在是拖动根元素了)</td></tr> <tr><td style="text-align:left;">dropped: <code>EventEmitter&lt;CdkDragDrop&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDragDropped’)</td> <td style="text-align:left;">当一个拖拽的元素松开的时候，并且是在一个container(容器)里面的时候会回调</td></tr> <tr><td style="text-align:left;">ended: EventEmitter</td> <td style="text-align:left;">@Output(‘cdkDragEnded’)</td> <td style="text-align:left;">拖拽结束的时候调用</td></tr> <tr><td style="text-align:left;">entered: <code>EventEmitter&lt;CdkDragEnter&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDragEntered’)</td> <td style="text-align:left;">拖拽的时候进入到一个新的容器的时候回调(两个list之间拖拽的时候用到CdkDropList)</td></tr> <tr><td style="text-align:left;">exited: <code>EventEmitter&lt;CdkDragExit&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDragExited’)</td> <td style="text-align:left;">拖拽的时候退出当前容器的时候回调</td></tr> <tr><td style="text-align:left;">moved: <code>Observable&lt;CdkDragMove&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDragMoved’)</td> <td style="text-align:left;">在拖拽的过程中会回调</td></tr> <tr><td style="text-align:left;">started: EventEmitter</td> <td style="text-align:left;">@Output(‘cdkDragStarted’)</td> <td style="text-align:left;">在开始拖拽的时候调用</td></tr> <tr><td style="text-align:left;">dropContainer: CdkDropListContainer</td> <td style="text-align:left;">无</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">element: ElementRef</td> <td style="text-align:left;">无</td> <td style="text-align:left;"></td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>上面表格中大量的提到了容器，我们可以把下文中提到的CdkDropList指令对应的视图元素当做是一个视图。</p></div> <h4 id="cdkdrag使用"><a href="#cdkdrag使用" class="header-anchor">#</a> CdkDrag使用</h4> <p>很简单，就是我们在想要拖动的视图元素上添加CdkDrag指令。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-drop'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div class=&quot;dragParent&quot; style=&quot;width: 500px; height: 500px; background-color: #f1f1f1&quot;&gt;
            &lt;div class=&quot;example-box&quot; cdkDrag cdkDragRootElement=&quot;.dragParent&quot;&gt;
                可以到处拖拽
            &lt;/div&gt;
        &lt;/div&gt;

    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .example-box {
            width: 100px;
            height: 100px;
            border: solid 1px #ccc;
            color: rgba(0, 0, 0, 0.87);
            cursor: move;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: #fff;
            border-radius: 4px;
            position: relative;
            z-index: 1;
            transition: box-shadow 200ms cubic-bezier(0, 0, 0.2, 1);
            box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2),
            0 2px 2px 0 rgba(0, 0, 0, 0.14),
            0 1px 5px 0 rgba(0, 0, 0, 0.12);
        }

        .example-box:active {
            box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
            0 8px 10px 1px rgba(0, 0, 0, 0.14),
            0 3px 14px 2px rgba(0, 0, 0, 0.12);
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropDropComponent</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p><img src="/vuebloger/img/post/20181218112026966.gif" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>上图中因为我设置CdkDrag指令的cdkDragRootElement属性为灰色的div，所以拖动的是整个灰色的div。</p></div> <h3 id="cdkdroplist"><a href="#cdkdroplist" class="header-anchor">#</a> CdkDropList</h3> <p>可以拖拽item的一个集合，说白了就是把一些可拖元素始放到一起来。</p> <ul><li>Selector: <code>[cdkDropList]</code> cdk-drop-list</li> <li>Exported as: cdkDropList</li></ul> <h4 id="cdkdroplist属性"><a href="#cdkdroplist属性" class="header-anchor">#</a> CdkDropList属性</h4> <table><thead><tr><th style="text-align:left;">属性名字</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">connectedTo: (CdkDropList	string)[]</td> <td style="text-align:left;">CdkDropList</td> <td style="text-align:left;"></td></tr> <tr><td style="text-align:left;">data: T</td> <td style="text-align:left;">@Input(‘cdkDropListData’)</td> <td style="text-align:left;">拖拽容器上的数据(通常是一个数组或者list)</td></tr> <tr><td style="text-align:left;">disabled: boolean</td> <td style="text-align:left;">@Input(‘cdkDropListDisabled’)</td> <td style="text-align:left;">是否禁用从此容器启动拖动序列</td></tr> <tr><td style="text-align:left;">enterPredicate: (drag: CdkDrag, drop: CdkDropList) =&gt; boolean</td> <td style="text-align:left;">@Input(‘cdkDropListEnterPredicate’)</td> <td style="text-align:left;">指定哪些item是可以拖拽到当前容器</td></tr> <tr><td style="text-align:left;">id: string</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">唯一的id,cdkDropListConnectedTo属性的时候可以使用</td></tr> <tr><td style="text-align:left;">lockAxis: ‘x’</td> <td style="text-align:left;">‘y’</td> <td style="text-align:left;">@Input(‘cdkDropListLockAxis’)</td></tr> <tr><td style="text-align:left;">orientation: ‘horizontal’</td> <td style="text-align:left;">‘vertical’	@Input(‘cdkDropListOrientation’)</td> <td style="text-align:left;">容器里面item的摆放方向(垂直，水平)</td></tr> <tr><td style="text-align:left;">dropped: <code>EventEmitter&lt;CdkDragDrop&lt;T, any&gt;&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDropListDropped’)</td> <td style="text-align:left;">拖拽结束的时候，当有item落到当前容器的时候回调</td></tr> <tr><td style="text-align:left;">entered: <code>EventEmitter&lt;CdkDragEnter&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDropListEntered’)</td> <td style="text-align:left;">当item进入当前容器的时候回调</td></tr> <tr><td style="text-align:left;">exited:<code>EventEmitter&lt;CdkDragExit&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDropListExited’)</td> <td style="text-align:left;">当item离开当前容器的时候回调</td></tr> <tr><td style="text-align:left;">sorted: <code>EventEmitter&lt;CdkDragSortEvent&gt;</code></td> <td style="text-align:left;">@Output(‘cdkDropListSorted’)</td> <td style="text-align:left;">拖拽过程中交换item的时候回调</td></tr></tbody></table> <h4 id="cdkdroplist使用"><a href="#cdkdroplist使用" class="header-anchor">#</a> CdkDropList使用</h4> <ol><li>水平方向的CdkDropList( cdkDropListOrientation属性的使用)</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkDragDrop<span class="token punctuation">,</span> moveItemInArray<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/drag-drop'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-orientation-drag'</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;div cdkDropList cdkDropListOrientation=&quot;horizontal&quot; class=&quot;example-list&quot; (cdkDropListDropped)=&quot;drop($event)&quot;&gt;
          &lt;div class=&quot;example-box&quot; *ngFor=&quot;let timePeriod of timePeriods&quot; cdkDrag&gt;{{timePeriod}}&lt;/div&gt;
      &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      .example-list {
          width: 1000px;
          max-width: 100%;
          border: solid 1px #ccc;
          min-height: 60px;
          display: flex;
          flex-direction: row;
          background: white;
          border-radius: 4px;
          overflow: hidden;
      }
      .example-box {
          padding: 20px 10px;
          border-right: solid 1px #ccc;
          color: rgba(0, 0, 0, 0.87);
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          box-sizing: border-box;
          cursor: move;
          background: white;
          font-size: 14px;
          flex-grow: 1;
          flex-basis: 0;
      }
      .cdk-drag-preview {
          box-sizing: border-box;
          border-radius: 4px;
          box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
          0 8px 10px 1px rgba(0, 0, 0, 0.14),
          0 3px 14px 2px rgba(0, 0, 0, 0.12);
      }
      .cdk-drag-placeholder {
          opacity: 0;
      }
      .cdk-drag-animating {
          transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
      }
      .example-box:last-child {
          border: none;
      }
      .example-list.cdk-drop-list-dragging .example-box:not(.cdk-drag-placeholder) {
          transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
      }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropOrientationDragComponent</span> <span class="token punctuation">{</span>
    timePeriods <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'Bronze age'</span><span class="token punctuation">,</span>
        <span class="token string">'Iron age'</span><span class="token punctuation">,</span>
        <span class="token string">'Middle ages'</span><span class="token punctuation">,</span>
        <span class="token string">'Early modern period'</span><span class="token punctuation">,</span>
        <span class="token string">'Long nineteenth century'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 移动item的时候，item之间的位置变换
     * @param event
     */</span>
    <span class="token function">drop</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> CdkDragDrop<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">moveItemInArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timePeriods<span class="token punctuation">,</span> event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span> event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><p><img src="/vuebloger/img/post/20181218112056485.gif" alt=""></p> <ol start="2"><li>两个list之间数据交换
CdkDropList指令cdkDropListConnectedTo属性的使用。同时为方便大家的使用cdk drag-drop也给提供了transferArrayItem()、moveItemInArray()用于两个list之间交互item和单个list之间item位置变换。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkDragDrop<span class="token punctuation">,</span> moveItemInArray<span class="token punctuation">,</span> transferArrayItem<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/drag-drop'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-transferring-item'</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;div class=&quot;example-container&quot;&gt;
          &lt;h2&gt;左边list&lt;/h2&gt;
          &lt;div
                  cdkDropList
                  #todoList=&quot;cdkDropList&quot;
                  [cdkDropListData]=&quot;leftSource&quot;
                  [cdkDropListConnectedTo]=&quot;[doneList]&quot;
                  class=&quot;example-list&quot;
                  (cdkDropListDropped)=&quot;drop($event)&quot;&gt;
              &lt;div class=&quot;example-box&quot; *ngFor=&quot;let item of leftSource&quot; cdkDrag&gt;{{item}}&lt;/div&gt;
          &lt;/div&gt;
      &lt;/div&gt;

      &lt;div class=&quot;example-container&quot;&gt;
          &lt;h2&gt;右边list&lt;/h2&gt;
          &lt;div
                  cdkDropList
                  #doneList=&quot;cdkDropList&quot;
                  [cdkDropListData]=&quot;rightSource&quot;
                  [cdkDropListConnectedTo]=&quot;[todoList]&quot;
                  class=&quot;example-list&quot;
                  (cdkDropListDropped)=&quot;drop($event)&quot;&gt;
              &lt;div class=&quot;example-box&quot; *ngFor=&quot;let item of rightSource&quot; cdkDrag&gt;{{item}}&lt;/div&gt;
          &lt;/div&gt;
      &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      .example-container {
          width: 400px;
          max-width: 100%;
          margin: 0 25px 25px 0;
          display: inline-block;
          vertical-align: top;
      }

      .example-list {
          border: solid 1px #ccc;
          min-height: 60px;
          background: white;
          border-radius: 4px;
          overflow: hidden;
          display: block;
      }

      .example-box {
          padding: 20px 10px;
          border-bottom: solid 1px #ccc;
          color: rgba(0, 0, 0, 0.87);
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          box-sizing: border-box;
          cursor: move;
          background: white;
          font-size: 14px;
      }

      .cdk-drag-preview {
          box-sizing: border-box;
          border-radius: 4px;
          box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
          0 8px 10px 1px rgba(0, 0, 0, 0.14),
          0 3px 14px 2px rgba(0, 0, 0, 0.12);
      }

      .cdk-drag-placeholder {
          opacity: 0;
      }

      .cdk-drag-animating {
          transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
      }

      .example-box:last-child {
          border: none;
      }

      .example-list.cdk-drop-list-dragging .example-box:not(.cdk-drag-placeholder) {
          transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
      }

  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropTransferringItemComponent</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 左边类别数据源
     */</span>
    leftSource <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'Get to work'</span><span class="token punctuation">,</span>
        <span class="token string">'Pick up groceries'</span><span class="token punctuation">,</span>
        <span class="token string">'Go home'</span><span class="token punctuation">,</span>
        <span class="token string">'Fall asleep'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 右边列表数据源
     */</span>
    rightSource <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'Get up'</span><span class="token punctuation">,</span>
        <span class="token string">'Brush teeth'</span><span class="token punctuation">,</span>
        <span class="token string">'Take a shower'</span><span class="token punctuation">,</span>
        <span class="token string">'Check e-mail'</span><span class="token punctuation">,</span>
        <span class="token string">'Walk dog'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 拖动的时候，list交换item或者单个list里面item位置的变换
     * @param event
     */</span>
    <span class="token function">drop</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> CdkDragDrop<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>previousContainer <span class="token operator">===</span> event<span class="token punctuation">.</span>container<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">moveItemInArray</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>container<span class="token punctuation">.</span>data<span class="token punctuation">,</span> event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span> event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">transferArrayItem</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>previousContainer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                event<span class="token punctuation">.</span>container<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span>
                event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br></div></div><p><img src="/vuebloger/img/post/20181218112152287.gif" alt=""></p> <ol start="3"><li>可以自己去控制哪些item可以拖进来
我们有一个这样的例子，左边的list里面不接受其他list的数据拖进来，右边的list只接受其他list里面的偶数。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkDrag<span class="token punctuation">,</span> CdkDragDrop<span class="token punctuation">,</span> moveItemInArray<span class="token punctuation">,</span> transferArrayItem<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/drag-drop'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-controlling-with-item'</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;div class=&quot;example-container&quot;&gt;
          &lt;h2&gt;不接受其他list的数据&lt;/h2&gt;
          &lt;div
                  id=&quot;all&quot;
                  cdkDropList
                  [cdkDropListData]=&quot;all&quot;
                  cdkDropListConnectedTo=&quot;even&quot;
                  class=&quot;example-list&quot;
                  (cdkDropListDropped)=&quot;drop($event)&quot;
                  [cdkDropListEnterPredicate]=&quot;noReturnPredicate&quot;&gt;
              &lt;div
                      class=&quot;example-box&quot;
                      *ngFor=&quot;let number of all&quot;
                      [cdkDragData]=&quot;number&quot;
                      cdkDrag&gt;
                  {{number}}
              &lt;/div&gt;
          &lt;/div&gt;
      &lt;/div&gt;

      &lt;div class=&quot;example-container&quot;&gt;
          &lt;h2&gt;只接受其他list里面的偶数&lt;/h2&gt;
          &lt;div
                  id=&quot;even&quot;
                  cdkDropList
                  [cdkDropListData]=&quot;even&quot;
                  cdkDropListConnectedTo=&quot;all&quot;
                  class=&quot;example-list&quot;
                  (cdkDropListDropped)=&quot;drop($event)&quot;
                  [cdkDropListEnterPredicate]=&quot;evenPredicate&quot;&gt;
              &lt;div
                      class=&quot;example-box&quot;
                      *ngFor=&quot;let number of even&quot;
                      cdkDrag
                      [cdkDragData]=&quot;number&quot;&gt;{{number}}
              &lt;/div&gt;
          &lt;/div&gt;
      &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      .example-container {
          width: 400px;
          max-width: 100%;
          margin: 0 25px 25px 0;
          display: inline-block;
          vertical-align: top;
      }

      .example-list {
          border: solid 1px #ccc;
          min-height: 60px;
          background: white;
          border-radius: 4px;
          overflow: hidden;
          display: block;
      }

      .example-box {
          padding: 20px 10px;
          border-bottom: solid 1px #ccc;
          color: rgba(0, 0, 0, 0.87);
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: space-between;
          box-sizing: border-box;
          cursor: move;
          background: white;
          font-size: 14px;
      }

      .cdk-drag-preview {
          box-sizing: border-box;
          border-radius: 4px;
          box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
          0 8px 10px 1px rgba(0, 0, 0, 0.14),
          0 3px 14px 2px rgba(0, 0, 0, 0.12);
      }

      .cdk-drag-placeholder {
          opacity: 0;
      }

      .cdk-drag-animating {
          transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
      }

      .example-box:last-child {
          border: none;
      }

      .example-list.cdk-drop-list-dragging .example-box:not(.cdk-drag-placeholder) {
          transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
      }

  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropControllingWithItemComponent</span> <span class="token punctuation">{</span>

    all <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    even <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">drop</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> CdkDragDrop<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>previousContainer <span class="token operator">===</span> event<span class="token punctuation">.</span>container<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">moveItemInArray</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>container<span class="token punctuation">.</span>data<span class="token punctuation">,</span> event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span> event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">transferArrayItem</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>previousContainer<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                event<span class="token punctuation">.</span>container<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span>
                event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/** 只接受其他list里面的偶数 */</span>
    <span class="token function">evenPredicate</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token operator">:</span> CdkDrag<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> item<span class="token punctuation">.</span>data <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/** 不让其他list里面的数据移入到这个里面来 */</span>
    <span class="token function">noReturnPredicate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br></div></div><p><img src="/vuebloger/img/post/20181218112252530.gif" alt=""></p> <h3 id="cdkdroplistgroup"><a href="#cdkdroplistgroup" class="header-anchor">#</a> CdkDropListGroup</h3> <p>CdkDropListGroup指令的范围比CdkDropList要大一级。CdkDropListGroup可以包含多个CdkDropList。而且当CdkDropListGroup包含多个CdkDropList的时候，这些CdkDropList直接是相互connect的(CdkDropList就不用去写cdkDropListConnectedTo属性了)。</p> <ul><li>Selector: [cdkDropListGroup]</li> <li>Exported as: cdkDropListGroup</li></ul> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>CdkDropListGroup使用场景：当我们在多个list之间的item需要相互拖动的时候派上用场。</p></div> <h3 id="cdkdraghandle"><a href="#cdkdraghandle" class="header-anchor">#</a> CdkDragHandle</h3> <p>拖动CdkDrag实例的句柄，简单来说就是指定一个元素。当我们拖动这个元素的时候整个CdkDrag实例都会动。</p> <h4 id="cdkdraghandle的使用"><a href="#cdkdraghandle的使用" class="header-anchor">#</a> CdkDragHandle的使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-handle-drag-area'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div class=&quot;example-box&quot; cdkDrag&gt;
            I can only be dragged using the handle
            &lt;div class=&quot;example-handle&quot; cdkDragHandle&gt;
                &lt;svg width=&quot;24px&quot; fill=&quot;currentColor&quot; viewBox=&quot;0 0 24 24&quot;&gt;
                    &lt;path d=&quot;M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z&quot;&gt;

                    &lt;/path&gt;
                    &lt;path d=&quot;M0 0h24v24H0z&quot; fill=&quot;none&quot;&gt;&lt;/path&gt;
                &lt;/svg&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .example-box {
            width: 200px;
            height: 200px;
            padding: 10px;
            box-sizing: border-box;
            border: solid 1px #ccc;
            color: rgba(0, 0, 0, 0.87);
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: #fff;
            border-radius: 4px;
            position: relative;
            z-index: 1;
            transition: box-shadow 200ms cubic-bezier(0, 0, 0.2, 1);
            box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2),
            0 2px 2px 0 rgba(0, 0, 0, 0.14),
            0 1px 5px 0 rgba(0, 0, 0, 0.12);
        }
        .example-box:active {
            box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
            0 8px 10px 1px rgba(0, 0, 0, 0.14),
            0 3px 14px 2px rgba(0, 0, 0, 0.12);
        }
        .example-handle {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #ccc;
            cursor: move;
            width: 24px;
            height: 24px;
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropHandleDragAreaComponent</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p><img src="/vuebloger/img/post/20181218112326258.gif" alt=""></p> <h3 id="cdkdragpreview"><a href="#cdkdragpreview" class="header-anchor">#</a> CdkDragPreview</h3> <p>简单点就是drag拖动过程中拖动的item的展示形式。</p> <h4 id="cdkdragpreview的使用"><a href="#cdkdragpreview的使用" class="header-anchor">#</a> CdkDragPreview的使用</h4> <p>比如一个这里的例子，展示影片名字列表，在拖动的时候展示影片对应的图片。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkDragDrop<span class="token punctuation">,</span> moveItemInArray<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/drag-drop'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-customizing-drag-preview'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div cdkDropList class=&quot;example-list&quot; (cdkDropListDropped)=&quot;drop($event)&quot;&gt;
            &lt;div class=&quot;example-box&quot; *ngFor=&quot;let movie of movies&quot; cdkDrag&gt;
                {{movie.title}}
                &lt;img *cdkDragPreview [src]=&quot;movie.poster&quot; [alt]=&quot;movie.title&quot;&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .example-list {
            width: 500px;
            max-width: 100%;
            border: solid 1px #ccc;
            min-height: 60px;
            display: block;
            background: white;
            border-radius: 4px;
            overflow: hidden;
        }

        .example-box {
            padding: 20px 10px;
            border-bottom: solid 1px #ccc;
            color: rgba(0, 0, 0, 0.87);
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            box-sizing: border-box;
            cursor: move;
            background: white;
            font-size: 14px;
        }

        .cdk-drag-preview {
            box-sizing: border-box;
            border-radius: 4px;
            box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
            0 8px 10px 1px rgba(0, 0, 0, 0.14),
            0 3px 14px 2px rgba(0, 0, 0, 0.12);
        }

        .cdk-drag-placeholder {
            opacity: 0;
        }

        .cdk-drag-animating {
            transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
        }

        .example-box:last-child {
            border: none;
        }

        .example-list.cdk-drop-list-dragging .example-box:not(.cdk-drag-placeholder) {
            transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
        }

    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropCustomizingDragPreviewComponent</span> <span class="token punctuation">{</span>

    movies <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode I - The Phantom Menace'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/4/40/Star_Wars_Phantom_Menace_poster.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode II - Attack of the Clones'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/3/32/Star_Wars_-_Episode_II_Attack_of_the_Clones_%28movie_poster%29.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode III - Revenge of the Sith'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/9/93/Star_Wars_Episode_III_Revenge_of_the_Sith_poster.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode IV - A New Hope'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/8/87/StarWarsMoviePoster1977.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode V - The Empire Strikes Back'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/3/3c/SW_-_Empire_Strikes_Back.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode VI - Return of the Jedi'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/b/b2/ReturnOfTheJediPoster1983.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode VII - The Force Awakens'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/a/a2/Star_Wars_The_Force_Awakens_Theatrical_Poster.jpg'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            title<span class="token operator">:</span> <span class="token string">'Episode VIII - The Last Jedi'</span><span class="token punctuation">,</span>
            poster<span class="token operator">:</span> <span class="token string">'https://upload.wikimedia.org/wikipedia/en/7/7f/Star_Wars_The_Last_Jedi.jpg'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">drop</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> CdkDragDrop<span class="token operator">&lt;</span><span class="token punctuation">{</span> title<span class="token operator">:</span> string<span class="token punctuation">,</span> poster<span class="token operator">:</span> string <span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">moveItemInArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>movies<span class="token punctuation">,</span> event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span> event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br></div></div><p><img src="/vuebloger/img/post/20181218112426225.gif" alt=""></p> <h3 id="cdkdragplaceholder"><a href="#cdkdragplaceholder" class="header-anchor">#</a> CdkDragPlaceholder</h3> <p>简单来说就是drag过程中，drag item对应的container里面item的占位符。</p> <h4 id="cdkdragplaceholder使用"><a href="#cdkdragplaceholder使用" class="header-anchor">#</a> CdkDragPlaceholder使用</h4> <p>如下的例子，拖动的时候，CdkDragPlaceholder对应加个灰色的背景</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkDragDrop<span class="token punctuation">,</span> moveItemInArray<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/drag-drop&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-drag-drop-customizing-drag-place-holder'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div cdkDropList class=&quot;example-list&quot; (cdkDropListDropped)=&quot;drop($event)&quot;&gt;
            &lt;div class=&quot;example-box&quot; *ngFor=&quot;let movie of movies&quot; cdkDrag&gt;
                &lt;div class=&quot;example-custom-placeholder&quot; *cdkDragPlaceholder&gt;&lt;/div&gt;
                {{movie}}
            &lt;/div&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .example-list {
            width: 500px;
            max-width: 100%;
            border: solid 1px #ccc;
            min-height: 60px;
            display: block;
            background: white;
            border-radius: 4px;
            overflow: hidden;
        }

        .example-box {
            padding: 20px 10px;
            border-bottom: solid 1px #ccc;
            color: rgba(0, 0, 0, 0.87);
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            box-sizing: border-box;
            cursor: move;
            background: white;
            font-size: 14px;
        }

        .cdk-drag-preview {
            box-sizing: border-box;
            border-radius: 4px;
            box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2),
            0 8px 10px 1px rgba(0, 0, 0, 0.14),
            0 3px 14px 2px rgba(0, 0, 0, 0.12);
        }

        .cdk-drag-animating {
            transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
        }

        .example-box:last-child {
            border: none;
        }

        .example-list.cdk-drop-list-dragging .example-box:not(.cdk-drag-placeholder) {
            transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
        }

        .example-custom-placeholder {
            background: #ccc;
            border: dotted 3px #999;
            min-height: 60px;
            transition: transform 250ms cubic-bezier(0, 0, 0.2, 1);
        }

    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DragDropCustomizingDragPlaceHolderComponent</span> <span class="token punctuation">{</span>

    movies <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'Episode I - The Phantom Menace'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode II - Attack of the Clones'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode III - Revenge of the Sith'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode IV - A New Hope'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode V - The Empire Strikes Back'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode VI - Return of the Jedi'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode VII - The Force Awakens'</span><span class="token punctuation">,</span>
        <span class="token string">'Episode VIII - The Last Jedi'</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">drop</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> CdkDragDrop<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">moveItemInArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>movies<span class="token punctuation">,</span> event<span class="token punctuation">.</span>previousIndex<span class="token punctuation">,</span> event<span class="token punctuation">.</span>currentIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><p><img src="/vuebloger/img/post/20181218112454651.gif" alt=""></p> <h2 id="angular-cdk-observers"><a href="#angular-cdk-observers" class="header-anchor">#</a> @angular/cdk/observers</h2> <p>observers 监听dom变化,想使用Observers里面的功能需要先<code>import {ObserversModule} from '@angular/cdk/observers';</code>再<code>provider ObserversModule</code></p> <h3 id="contentobserver"><a href="#contentobserver" class="header-anchor">#</a> ContentObserver</h3> <p>ContentObserver是cdk Observers模块里面提供的一个service。用来监听某个视图元素内容的变化。ContentObserver里面的方法也比较简单。ContentObserver里面的方法如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">ContentObserver</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 监听视图元素内容的变化，参数--Element
     */</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>element<span class="token operator">:</span> Element<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>MutationRecord<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 监听视图元素内容的变化，参数--ElementRef
     */</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>element<span class="token operator">:</span> ElementRef<span class="token operator">&lt;</span>Element<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>MutationRecord<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="contentobserver的使用"><a href="#contentobserver的使用" class="header-anchor">#</a> ContentObserver的使用</h4> <p>针对ContentObserver Service的使用，我们举一个非常简单的例子。每秒去变化一下内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>AfterViewInit<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> ViewChild<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ContentObserver<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/observers'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-observers'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div #observerSource&gt;
            {{content}}
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkObserversComponent</span> <span class="token keyword">implements</span> <span class="token class-name">AfterViewInit</span> <span class="token punctuation">{</span>
    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'observerSource'</span><span class="token punctuation">)</span>
    observerSource<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>
    content <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * ContentObserver service
     */</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> observer<span class="token operator">:</span> ContentObserver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * 启动一个定时任务，去改变内容
         */</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token comment">// ContentObserver 监听视图元素内容的变化，只是简单的打印</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>observerSource<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> MutationRecord<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="cdkobservecontent"><a href="#cdkobservecontent" class="header-anchor">#</a> CdkObserveContent</h3> <p>CdkObserveContent是cdk Observers里面提供的指令。可以监听添加了CdkObserveContent指令视图元素的内容的变化。</p> <ul><li>Selector: [cdkObserveContent]</li> <li>Exported as: cdkObserveContent</li></ul> <h4 id="cdkobservecontent指令属性"><a href="#cdkobservecontent指令属性" class="header-anchor">#</a> CdkObserveContent指令属性</h4> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">debounce: number</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">有的时候视图元素内容的变化是很频繁的，用来设置多长时间监听变化的事件</td></tr> <tr><td style="text-align:left;">disabled: any</td> <td style="text-align:left;">@Input(‘cdkObserveContentDisabled’)</td> <td style="text-align:left;">动态设置是否监听变化事件</td></tr> <tr><td style="text-align:left;">event: EventEmitter&lt;MutationRecord[]&gt;</td> <td style="text-align:left;">@Output(‘cdkObserveContent’)</td> <td style="text-align:left;">内容变化回调事件</td></tr></tbody></table> <h4 id="cdkobservecontent指令的使用"><a href="#cdkobservecontent指令的使用" class="header-anchor">#</a> CdkObserveContent指令的使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-observers'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div cdkObserveContent (cdkObserveContent)=&quot;onContentChange($event)&quot;&gt;
            {{content}}
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkObserversComponent</span> <span class="token punctuation">{</span>
    content <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">onContentChange</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> MutationRecord<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>关于angular里面内容变化这块的内容，我倒是想到了另一个东西NgZone。用来应对在模板中咱们动态绑定了一个值。但是这个值频繁的在变化。如果不做其他的处理我们知道Angular会跟踪变化，并且把变化的内容实时的展示在页面上。这样肯定是会有性能的损耗的。这个时候NgZone就派上用场了。NgZone里面提供了两个函数：runOutsideAngular() 使你的上下文不会触发Angular跟踪变化、run()方法让Angular重新跟踪变化。</p> <h2 id="angular-cdk-layout"><a href="#angular-cdk-layout" class="header-anchor">#</a> @angular/cdk/layout</h2> <p>cdk Layout是cdk 提供的响应式布局工具，提供了实用程序来构建响应屏幕大小更改的响应UI，其服务可以轻松检测窗口大小并与媒体查询匹配。这使得你可以完全控制UI并适应不同的屏幕尺寸。layout使用之前也要provider LayoutModule:<code>import {LayoutModule} from '@angular/cdk/layout';</code>layout 响应式布局工具包含：</p> <ul><li>breakpoints 屏幕尺寸</li> <li>breakpointObserver 观察器</li> <li>mediaMatcher 媒体查询匹配</li></ul> <h3 id="breakpointobserver"><a href="#breakpointobserver" class="header-anchor">#</a> BreakpointObserver</h3> <p>BreakpointObserver是cdk Layout里面提供的Service。用于评估媒体查询和对其变化作出反应的一个Service。</p> <h4 id="breakpointobserver属性方法"><a href="#breakpointobserver属性方法" class="header-anchor">#</a> BreakpointObserver属性方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">BreakpointObserver</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 简单的一次性匹配，判断当前屏幕是否符合匹配条件
     */</span>
    <span class="token function">isMatched</span><span class="token punctuation">(</span>value<span class="token operator">:</span> string <span class="token operator">|</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 监听设置的条件。在条件满足的时候，或者不满足的时候触发
     */</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>value<span class="token operator">:</span> string <span class="token operator">|</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>BreakpointState<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="breakpointobserver使用"><a href="#breakpointobserver使用" class="header-anchor">#</a> BreakpointObserver使用</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>BreakpointObserver<span class="token punctuation">,</span> Breakpoints<span class="token punctuation">,</span> BreakpointState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/layout'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-layout'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./cdk-layout.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-layout.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkLayoutComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> breakpointObserver<span class="token operator">:</span> BreakpointObserver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 简单的一次性匹配，可以使用isMatching方法。如果组件初始化时窗口至少为40rem高，则输出到控制台</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>breakpointObserver<span class="token punctuation">.</span><span class="token function">isMatched</span><span class="token punctuation">(</span><span class="token string">'(min-height: 40rem)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'窗口至少为40rem高!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'窗口没有40rem高!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 注意哦，不会一直回调哦，只会在第一次满足或者不满足条件的时候回调。</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>breakpointObserver
            <span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'(min-width: 500px)'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">:</span> BreakpointState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'窗口宽度大于或者等于500px!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'窗口不满足宽度大于或者等于500px!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 也可以使用Breakpoints对象，而不是使用手写的媒体查询，它为我们提供了常见断点的键。如果多个参数，当有一个条件满足或者不满足的时候就会触发</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>breakpointObserver
            <span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Breakpoints<span class="token punctuation">.</span>Small<span class="token punctuation">,</span> Breakpoints<span class="token punctuation">.</span>HandsetPortrait<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">:</span> BreakpointState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                        <span class="token string">'Breakpoints.Small or Breakpoints.HandsetPortrait'</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="mediamatcher"><a href="#mediamatcher" class="header-anchor">#</a> MediaMatcher</h3> <p>MediaMatcher也是一个Service，用于媒体查询匹配。</p> <h4 id="mediamatcher属性方法"><a href="#mediamatcher属性方法" class="header-anchor">#</a> MediaMatcher属性方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">MediaMatcher</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 评估给定的媒体查询并返回可从中检索结果的本机MediaQueryList。
     * 确认布局引擎将触发所提供的选择器查询st。
     */</span>
    <span class="token function">matchMedia</span><span class="token punctuation">(</span>query<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> MediaQueryList<span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="mediamatcher使用"><a href="#mediamatcher使用" class="header-anchor">#</a> MediaMatcher使用</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> OnDestroy<span class="token punctuation">,</span> OnInit<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>MediaMatcher<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/layout'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-layout'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./cdk-layout.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-layout.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkLayoutComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span><span class="token punctuation">,</span> OnDestroy <span class="token punctuation">{</span>
    matcher<span class="token operator">:</span> MediaQueryList<span class="token punctuation">;</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> mediaMatcher<span class="token operator">:</span> MediaMatcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>matcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mediaMatcher<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(min-width: 500px)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>matcher<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>matchMediaListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>matcher<span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>matchMediaListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">matchMediaListener</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>matches <span class="token operator">?</span> <span class="token string">'match'</span> <span class="token operator">:</span> <span class="token string">'no match'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>如果你在测试的时候发现没有打印，你可以试着去改变浏览器窗口的大小。</p></div> <h3 id="breakpoints"><a href="#breakpoints" class="header-anchor">#</a> Breakpoints</h3> <p>Breakpoints里面的内容是cdk里面提供的一些屏幕尺寸常量。如下所示。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> Breakpoints <span class="token operator">=</span> <span class="token punctuation">{</span>
  XSmall<span class="token operator">:</span> <span class="token string">'(max-width: 599.99px)'</span><span class="token punctuation">,</span>
  Small<span class="token operator">:</span> <span class="token string">'(min-width: 600px) and (max-width: 959.99px)'</span><span class="token punctuation">,</span>
  Medium<span class="token operator">:</span> <span class="token string">'(min-width: 960px) and (max-width: 1279.99px)'</span><span class="token punctuation">,</span>
  Large<span class="token operator">:</span> <span class="token string">'(min-width: 1280px) and (max-width: 1919.99px)'</span><span class="token punctuation">,</span>
  XLarge<span class="token operator">:</span> <span class="token string">'(min-width: 1920px)'</span><span class="token punctuation">,</span>

  Handset<span class="token operator">:</span> <span class="token string">'(max-width: 599.99px) and (orientation: portrait), '</span> <span class="token operator">+</span>
           <span class="token string">'(max-width: 959.99px) and (orientation: landscape)'</span><span class="token punctuation">,</span>
  Tablet<span class="token operator">:</span> <span class="token string">'(min-width: 600px) and (max-width: 839.99px) and (orientation: portrait), '</span> <span class="token operator">+</span>
          <span class="token string">'(min-width: 960px) and (max-width: 1279.99px) and (orientation: landscape)'</span><span class="token punctuation">,</span>
  Web<span class="token operator">:</span> <span class="token string">'(min-width: 840px) and (orientation: portrait), '</span> <span class="token operator">+</span>
       <span class="token string">'(min-width: 1280px) and (orientation: landscape)'</span><span class="token punctuation">,</span>

  HandsetPortrait<span class="token operator">:</span> <span class="token string">'(max-width: 599.99px) and (orientation: portrait)'</span><span class="token punctuation">,</span>
  TabletPortrait<span class="token operator">:</span> <span class="token string">'(min-width: 600px) and (max-width: 839.99px) and (orientation: portrait)'</span><span class="token punctuation">,</span>
  WebPortrait<span class="token operator">:</span> <span class="token string">'(min-width: 840px) and (orientation: portrait)'</span><span class="token punctuation">,</span>

  HandsetLandscape<span class="token operator">:</span> <span class="token string">'(max-width: 959.99px) and (orientation: landscape)'</span><span class="token punctuation">,</span>
  TabletLandscape<span class="token operator">:</span> <span class="token string">'(min-width: 960px) and (max-width: 1279.99px) and (orientation: landscape)'</span><span class="token punctuation">,</span>
  WebLandscape<span class="token operator">:</span> <span class="token string">'(min-width: 1280px) and (orientation: landscape)'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="示例汇总-2"><a href="#示例汇总-2" class="header-anchor">#</a> 示例汇总</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  BreakpointObserver<span class="token punctuation">,</span>
  BreakpointState<span class="token punctuation">,</span>
  MediaMatcher<span class="token punctuation">,</span>
  Breakpoints
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/layout&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs/Observable&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&quot;layout&quot;</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">&quot;./layout.component.html&quot;</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./layout.component.scss&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LayoutComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  isHandset<span class="token operator">:</span> Observable<span class="token operator">&lt;</span>BreakpointState<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> bm<span class="token operator">:</span> BreakpointObserver<span class="token punctuation">,</span> <span class="token keyword">public</span> media<span class="token operator">:</span> MediaMatcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 手持设备</span>
    <span class="token keyword">let</span> Handset <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>Handset<span class="token punctuation">;</span>
    <span class="token comment">// 手持landscape屏</span>
    <span class="token keyword">let</span> HandsetLandscape <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>HandsetLandscape<span class="token punctuation">;</span>
    <span class="token comment">//手持portrait屏</span>
    <span class="token keyword">let</span> HandsetPortrait <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>HandsetPortrait<span class="token punctuation">;</span>
    <span class="token comment">// 多媒体</span>
    <span class="token keyword">let</span> Medium <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>Medium<span class="token punctuation">;</span>
    <span class="token comment">// 平板电脑</span>
    <span class="token keyword">let</span> Tablet <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>Tablet<span class="token punctuation">;</span>
    <span class="token comment">// 平板电脑 Landscape</span>
    <span class="token keyword">let</span> TabletLandscape <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>TabletLandscape<span class="token punctuation">;</span>
    <span class="token comment">// 平板电脑 Portrait</span>
    <span class="token keyword">let</span> TabletPortrait <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>TabletPortrait<span class="token punctuation">;</span>
    <span class="token comment">// web</span>
    <span class="token keyword">let</span> Web <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>Web<span class="token punctuation">;</span>
    <span class="token comment">// web landscape</span>
    <span class="token keyword">let</span> WebLandscape <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>WebLandscape<span class="token punctuation">;</span>
    <span class="token comment">// web portrait</span>
    <span class="token keyword">let</span> WebPortrait <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>WebPortrait<span class="token punctuation">;</span>
    <span class="token comment">// 大屏幕</span>
    <span class="token keyword">let</span> Large <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>Large<span class="token punctuation">;</span>
    <span class="token comment">// 更大屏幕</span>
    <span class="token keyword">let</span> XLarge <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>XLarge<span class="token punctuation">;</span>
    <span class="token comment">// 更小屏幕</span>
    <span class="token keyword">let</span> XSmall <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>XSmall<span class="token punctuation">;</span>
    <span class="token comment">// 小屏幕</span>
    <span class="token keyword">let</span> Small <span class="token operator">=</span> Breakpoints<span class="token punctuation">.</span>Small<span class="token punctuation">;</span>
    <span class="token keyword">let</span> isSmall <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>media<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span>Small<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;is small matcher&quot;</span><span class="token punctuation">,</span> isSmall<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;is small&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bm<span class="token punctuation">.</span><span class="token function">isMatched</span><span class="token punctuation">(</span>Small<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> isXSmall <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>media<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span>XSmall<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;is xsmall matcher&quot;</span><span class="token punctuation">,</span> isXSmall<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;is xsmall&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bm<span class="token punctuation">.</span><span class="token function">isMatched</span><span class="token punctuation">(</span>XSmall<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 是否满足多个条件</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>bm
      <span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        Handset<span class="token punctuation">,</span>
        HandsetLandscape<span class="token punctuation">,</span>
        Handset<span class="token punctuation">,</span>
        Medium<span class="token punctuation">,</span>
        Tablet<span class="token punctuation">,</span>
        TabletLandscape<span class="token punctuation">,</span>
        TabletPortrait<span class="token punctuation">,</span>
        Web<span class="token punctuation">,</span>
        WebLandscape<span class="token punctuation">,</span>
        WebPortrait<span class="token punctuation">,</span>
        Large<span class="token punctuation">,</span>
        XLarge<span class="token punctuation">,</span>
        Small<span class="token punctuation">,</span>
        XSmall
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><h2 id="angular-cdk-bidi"><a href="#angular-cdk-bidi" class="header-anchor">#</a> @angular/cdk/bidi</h2> <p>cdk Bidirectionality提供给我们的功能，就是用来设置布局方向。 使用之前先provider BidiModule<code>import {BidiModule} from '@angular/cdk/bidi';</code>bidi里面咱们需要知道的就两个东西：一个Service Directionality、一个指令 Dir。bidi主要内容：</p> <ul><li>Directionality</li> <li>Direction</li> <li>DIR_DOCUMENT</li> <li>Dir</li> <li>BidiModule</li></ul> <h3 id="directionality"><a href="#directionality" class="header-anchor">#</a> Directionality</h3> <p>Directionality Service两个作用：获取当前应用程序的布局方向、监听应用程序布局方向的变化。</p> <h4 id="directionality-service属性方法"><a href="#directionality-service属性方法" class="header-anchor">#</a> Directionality Service属性方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">Directionality</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token comment">/** 当前应用程序的布局方向 'ltr' or 'rtl' */</span>
    readonly value<span class="token operator">:</span> Direction<span class="token punctuation">;</span>
    <span class="token comment">/** 当前应用程序的布局方向发生改变了的回调函数 'ltr' / 'rtl' state changes. */</span>
    readonly change<span class="token operator">:</span> EventEmitter<span class="token operator">&lt;</span>Direction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="directionality-service使用"><a href="#directionality-service使用" class="header-anchor">#</a> Directionality Service使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> Inject<span class="token punctuation">,</span> OnDestroy<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">DIR_DOCUMENT</span><span class="token punctuation">,</span> Directionality<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/bidi'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Subscription<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-bidi'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./cdk-bidi.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-bidi.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkBidiComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _dirChangeSubscription <span class="token operator">=</span> Subscription<span class="token punctuation">.</span><span class="token constant">EMPTY</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>
        <span class="token parameter">@<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token constant">DIR_DOCUMENT</span><span class="token punctuation">)</span> <span class="token keyword">public</span> dirDoc<span class="token operator">:</span> any<span class="token punctuation">,</span>
        <span class="token keyword">public</span> directionality<span class="token operator">:</span> Directionality</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_dirChangeSubscription <span class="token operator">=</span> directionality<span class="token punctuation">.</span>change<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bbb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_dirChangeSubscription<span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="dir"><a href="#dir" class="header-anchor">#</a> Dir</h3> <p>Dir指令用于设置布局方向和监听布局方向的变化。</p> <ul><li>Selector: [dir]</li> <li>Exported as: dir</li></ul> <h4 id="dir指令属性"><a href="#dir指令属性" class="header-anchor">#</a> Dir指令属性</h4> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">change: EventEmitter</td> <td style="text-align:left;">@Output(‘dirChange’)</td> <td style="text-align:left;">当前视图布局方向发生改变的时候调用</td></tr> <tr><td style="text-align:left;">value: Direction</td> <td style="text-align:left;"></td> <td style="text-align:left;">当前视图元素的布局方向</td></tr></tbody></table> <h4 id="dir指令使用"><a href="#dir指令使用" class="header-anchor">#</a> Dir指令使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-bidi'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!--从左到右--&gt;
        &lt;p dir=&quot;LTR&quot; style=&quot;border: solid 1px #ccc; color: red; padding: 10px&quot;&gt;
            从左到右排列
        &lt;/p&gt;
        &lt;!--从右到左--&gt;
        &lt;p dir=&quot;RTL&quot; style=&quot;border: solid 1px #ccc; color: red; padding: 10px&quot;&gt;
            从右到左排列
        &lt;/p&gt;
        &lt;div dir=&quot;RTL&quot; style=&quot;border: solid 1px #ccc; padding: 10px&quot;&gt;
            &lt;div style=&quot;margin-left: 8px; margin-right: 8px; display: inline-block; 
            width: 250px; background-color: #cccccc; padding: 4px; color: red&quot;
                 dir=&quot;LTR&quot;&gt;第一个位置--内容靠左
            &lt;/div&gt;
            &lt;div style=&quot;margin-left: 8px; margin-right: 8px; display: inline-block; 
            width: 250px; background-color: #cccccc; padding: 4px; color: red&quot;
                 dir=&quot;RTL&quot;&gt;第二个位置--内容靠右
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;!--可以控制方向--&gt;
        &lt;p [dir]=&quot;dir&quot; (dirChange)=&quot;dirChange()&quot; style=&quot;border: solid 1px #ccc; color: red; padding: 10px&quot;&gt;
            可以动态切换方向
        &lt;/p&gt;
        &lt;button (click)=&quot;switchDir()&quot;&gt;切换方向&lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkBidiComponent</span> <span class="token punctuation">{</span>
    dir <span class="token operator">=</span> <span class="token string">&quot;rtl&quot;</span><span class="token punctuation">;</span>
    <span class="token function">switchDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">===</span> <span class="token string">&quot;rtl&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> <span class="token string">&quot;ltr&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> <span class="token string">&quot;rtl&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">dirChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h4 id="示例汇总-3"><a href="#示例汇总-3" class="header-anchor">#</a> 示例汇总</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>从左到右<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p dir<span class="token operator">=</span><span class="token string">&quot;LTR&quot;</span><span class="token operator">&gt;</span>
  bidi works<span class="token operator">!</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>从右到左<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p dir<span class="token operator">=</span><span class="token string">&quot;RTL&quot;</span><span class="token operator">&gt;</span>
  bidi works<span class="token operator">!</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>可以控制方向<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p <span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;dir&quot;</span><span class="token operator">&gt;</span>
  bidi works<span class="token operator">!</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;javascript:;&quot;</span> <span class="token punctuation">(</span>click<span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">&quot;switchDir()&quot;</span><span class="token operator">&gt;</span>改变<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> OnInit<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">DIR_DOCUMENT</span><span class="token punctuation">,</span> Directionality <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/bidi&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&quot;bidi&quot;</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">&quot;./bidi.component.html&quot;</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./bidi.component.scss&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BidiComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  dir<span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">&quot;rtl&quot;</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter">@<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token constant">DIR_DOCUMENT</span><span class="token punctuation">)</span> <span class="token keyword">public</span> dirDoc<span class="token operator">:</span> any<span class="token punctuation">,</span>
    <span class="token keyword">public</span> directionlity<span class="token operator">:</span> Directionality</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取document</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dirDoc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ltr 获取当前值</span>
    <span class="token keyword">let</span> dir <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>directionlity<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;dir is &quot;</span><span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">switchDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">===</span> <span class="token string">&quot;rtl&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> <span class="token string">&quot;ltr&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> <span class="token string">&quot;rtl&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="angular-cdk-a11y"><a href="#angular-cdk-a11y" class="header-anchor">#</a> @angular/cdk/a11y</h2> <p>cdk ally里面提供的功能运用场景是 select, menu 这种有 list options 的组件, 负责处理键盘上下按钮时 option active 的逻辑。cdk ally使用之前也要provider导入A11yModule模块。<code>import {A11yModule} from '@angular/cdk/a11y';</code></p> <h3 id="listkeymanager"><a href="#listkeymanager" class="header-anchor">#</a> ListKeyManager</h3> <p>ListKeyManager主要做的事情就是去管理一堆的list 里面哪个item处于active状态(active代表一种状态，比如处于活动转换，获取焦点状态等等)。而且ListKeyManager管理的item必须实现ListKeyManagerOption接口。换句话说ListKeyManager用于管理一系列list的item,这些item就是ListKeyManagerOption。通过ListKeyManager来控制那个ListKeyManagerOption对应的item处于active状态。所以咱们先看下ListKeyManagerOption和ListKeyManager里面一些常见的方法。</p> <h4 id="listkeymanageroption"><a href="#listkeymanageroption" class="header-anchor">#</a> ListKeyManagerOption</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ListKeyManagerOption</span> <span class="token punctuation">{</span>
    <span class="token comment">/** 当前item是否disabled. */</span>
    disabled<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    <span class="token comment">/** 获取当前item对应的label,配合ListKeyManager里面withTypeAhead函数的使用
     *  适用于输入框的情况，比如输入框下面有一些list item。当输入框输入字符的时候list item 里面的active
     *  item 和输入的文字匹配
     */</span>
    getLabel<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="listkeymanager常用方法"><a href="#listkeymanager常用方法" class="header-anchor">#</a> ListKeyManager常用方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">ListKeyManager</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">ListKeyManagerOption</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * tab 按键的时候触发的
     */</span>
    tabOut<span class="token operator">:</span> Subject<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/** 当ListKeyManager里面的list item ,active item 改变的时候触发*/</span>
    change<span class="token operator">:</span> Subject<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置那些ListKeyManager管理的list里在移动(比如tab 按键切换)过程中那些item需要跳过。
     */</span>
    <span class="token function">skipPredicate</span><span class="token punctuation">(</span><span class="token function-variable function">predicate</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token operator">:</span> <span class="token constant">T</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置是否循环移动(当active item是最好一个的时候，继续下一个跳到第一个)
     */</span>
    <span class="token function">withWrap</span><span class="token punctuation">(</span>shouldWrap<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * active item 移动方向垂直(对应键盘方向键的 上下按键)
     */</span>
    <span class="token function">withVerticalOrientation</span><span class="token punctuation">(</span>enabled<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * active item 移动方向水平(对应键盘方向键的 左右按键)
     */</span>
    <span class="token function">withHorizontalOrientation</span><span class="token punctuation">(</span>direction<span class="token operator">:</span> <span class="token string">'ltr'</span> <span class="token operator">|</span> <span class="token string">'rtl'</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 用来处理组合按键的情况，比如 altr + 方向键的时候。同样达到方向按键的效果
     */</span>
    <span class="token function">withAllowedModifierKeys</span><span class="token punctuation">(</span>keys<span class="token operator">:</span> ListKeyManagerModifierKey<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置typeahead 模式 配合ListKeyManagerOption的getLabel()函数使用，一般用于配合有输入框的情况下使用，比如输入框输入一个字符，active item 会自动设置到包含这个字符item
     */</span>
    <span class="token function">withTypeAhead</span><span class="token punctuation">(</span>debounceInterval<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置 active item 对应的index
     */</span>
    <span class="token function">setActiveItem</span><span class="token punctuation">(</span>index<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置 active item 对应的item
     */</span>
    <span class="token function">setActiveItem</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置按键
     */</span>
    <span class="token function">onKeydown</span><span class="token punctuation">(</span>event<span class="token operator">:</span> KeyboardEvent<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 当前active item 对应的事件 */</span>
    readonly activeItemIndex<span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">/** 当前active item 对应的item */</span>
    readonly activeItem<span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">/** 设置第一个位置的item 为active item(当然了如果第一个item 是disable,则设置第二个) */</span>
    <span class="token function">setFirstItemActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 设置最后一个位置的item 为 active item */</span>
    <span class="token function">setLastItemActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 设置下一个item 为active item */</span>
    <span class="token function">setNextItemActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 设置上一个item 为active item */</span>
    <span class="token function">setPreviousItemActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置active item,但是不产生其他的效果
     */</span>
    <span class="token function">updateActiveItem</span><span class="token punctuation">(</span>index<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置active item,但是不产生其他的效果
     */</span>
    <span class="token function">updateActiveItem</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h4 id="listkeymanager的使用"><a href="#listkeymanager的使用" class="header-anchor">#</a> ListKeyManager的使用</h4> <p>接下来咱们通过ListKeyManager的两个具体继承类ActiveDescendantKeyManager和FocusKeyManager来说明ListKeyManager的具体使用。其实ActiveDescendantKeyManager里面管理的item必须实现Highlightable接口、FocusKeyManager里面管理的item必须实现FocusableOption。</p> <ol><li>ActiveDescendantKeyManager的使用
ActiveDescendantKeyManager里面管理的list item 必须实现Highlightable接口。</li></ol> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>ActiveDescendantKeyManager继承了ListKeyManager类，Highlightable实现了ListKeyManagerOption接口</p></div> <p>ActiveDescendantKeyManager使用场景：如果想ListKeyManager管理的list里面active的item标记为活动状态，其他的标记为非活动状态情况下使用。而且每个item都必须实现Highlightable接口。接下来咱们通过一个具体的实例来简单的说明下。咱们自定义一个item组件ItemActiveOptionComponent，这个组件实现Highlightable接口。组件里面做的事情也很简单就是去改变active item的class样式。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> HostBinding<span class="token punctuation">,</span> Input<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Highlightable<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-item-active-option'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div [class.disabled]=&quot;disabled&quot;&gt;
            &lt;ng-content&gt;&lt;/ng-content&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        .active {
            background-color: lightblue;
            color: #fff;
        }

        .disabled {
            opacity: 0.3;
        }
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ItemActiveOptionComponent</span> <span class="token keyword">implements</span> <span class="token class-name">Highlightable</span> <span class="token punctuation">{</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> item<span class="token punctuation">;</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> disabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> _isActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    @<span class="token function">HostBinding</span><span class="token punctuation">(</span><span class="token string">'class.active'</span><span class="token punctuation">)</span> <span class="token keyword">get</span> <span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_isActive<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 设置 active对应的class
     */</span>
    <span class="token function">setActiveStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_isActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 设置非active对应的class
     */</span>
    <span class="token function">setInactiveStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_isActive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">getLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// cdk-active-descendant.component.less</span>
<span class="token punctuation">.</span>form<span class="token operator">-</span>control <span class="token punctuation">{</span>
  display<span class="token operator">:</span> block<span class="token punctuation">;</span>
  width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">2.25</span>rem <span class="token operator">+</span> <span class="token number">2</span>px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  padding<span class="token operator">:</span> <span class="token number">.375</span>rem <span class="token number">.75</span>rem<span class="token punctuation">;</span>
  font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">1</span>rem<span class="token punctuation">;</span>
  line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
  color<span class="token operator">:</span> #<span class="token number">495057</span><span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  background<span class="token operator">-</span>clip<span class="token operator">:</span> padding<span class="token operator">-</span>box<span class="token punctuation">;</span>
  border<span class="token operator">:</span> <span class="token number">1</span>px solid #ced4da<span class="token punctuation">;</span>
  border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
  transition<span class="token operator">:</span> border<span class="token operator">-</span>color <span class="token number">.15</span>s ease<span class="token operator">-</span><span class="token keyword">in</span><span class="token operator">-</span>out<span class="token punctuation">,</span> box<span class="token operator">-</span>shadow <span class="token number">.15</span>s ease<span class="token operator">-</span><span class="token keyword">in</span><span class="token operator">-</span>out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>form<span class="token operator">-</span>control<span class="token operator">:</span>focus <span class="token punctuation">{</span>
  color<span class="token operator">:</span> #<span class="token number">495057</span><span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  border<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">80</span>bdff<span class="token punctuation">;</span>
  outline<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  box<span class="token operator">-</span>shadow<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0.2</span>rem <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">.25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item<span class="token operator">:</span>first<span class="token operator">-</span>child <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">1</span>rem<span class="token punctuation">;</span>
  border<span class="token operator">-</span>top<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
  border<span class="token operator">-</span>top<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item  <span class="token punctuation">{</span>
  position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
  display<span class="token operator">:</span> block<span class="token punctuation">;</span>
  padding<span class="token operator">:</span> <span class="token number">.75</span>rem <span class="token number">1.25</span>rem<span class="token punctuation">;</span>
  margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>px<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  border<span class="token operator">:</span> <span class="token number">1</span>px solid <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">.125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item<span class="token operator">:</span>last<span class="token operator">-</span>child <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  border<span class="token operator">-</span>bottom<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
  border<span class="token operator">-</span>bottom<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item<span class="token punctuation">.</span>active  <span class="token punctuation">{</span>
  z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
  color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">007</span>bff<span class="token punctuation">;</span>
  border<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">007</span>bff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br></div></div><p>ActiveDescendantKeyManager的使用，咱们放在这个组件里面实现。ActiveDescendantKeyManager里面管理的item就是咱们上面自定义的ItemActiveOptionComponent。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>AfterViewInit<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> QueryList<span class="token punctuation">,</span> ViewChildren<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ItemActiveOptionComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./active-item-option/item-active-option.component&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ActiveDescendantKeyManager<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-active-descendant'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- 输入框 --&gt;
        &lt;div class=&quot;form-group&quot;&gt;
            &lt;input class=&quot;form-control&quot; placeholder=&quot;Search...&quot; (keyup)=&quot;onKeyDown($event)&quot; #input&gt;
        &lt;/div&gt;

        &lt;section class=&quot;list-group&quot;&gt;
            &lt;!-- ActiveDescendantKeyManager要管理的item --&gt;
            &lt;app-item-active-option *ngFor=&quot;let user of users | filter: 'name' : input.value; index as index&quot;
                                    [item]=&quot;user&quot; class=&quot;list-group-item&quot;&gt;
                {{user.name}}
            &lt;/app-item-active-option&gt;
        &lt;/section&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'cdk-active-descendant.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkActiveDescendantComponent</span> <span class="token keyword">implements</span> <span class="token class-name">AfterViewInit</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 找到所有的item(ListKeyManagerOption - Highlightable)
     */</span>
    @<span class="token function">ViewChildren</span><span class="token punctuation">(</span>ItemActiveOptionComponent<span class="token punctuation">)</span> items<span class="token operator">:</span> QueryList<span class="token operator">&lt;</span>ItemActiveOptionComponent<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">// list item source list</span>
    users <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b902934d965e7501f4e1c6f&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Caroline Hodges&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029348f7eed8b6f5f02db&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Delores Rivas&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029346f48c8407c64d0d5&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Darlene Franklin&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029341eff315fa87f9e21&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Alfreda Love&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029342e8917c6ccdb9865&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Marcy Ratliff&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029349dbb48013460e01f&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Beulah Nielsen&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b902934f4f1586e5e72d74a&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Morton Kerr&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029347918bb204bf7014e&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Autumn Tillman&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b902934b86f80e1fc60c626&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Diane Bennett&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029348999f59215020349&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;June Eaton&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> keyManager<span class="token operator">:</span> ActiveDescendantKeyManager<span class="token operator">&lt;</span>ItemActiveOptionComponent<span class="token operator">&gt;</span><span class="token punctuation">;</span>

    <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// new ActiveDescendantKeyManager</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveDescendantKeyManager</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withWrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 循环</span>
            <span class="token punctuation">.</span><span class="token function">withTypeAhead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 支持搜索</span>

    <span class="token punctuation">}</span>

    <span class="token function">onKeyDown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 传递事件进去</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyManager<span class="token punctuation">.</span><span class="token function">onKeydown</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div><p><img src="/vuebloger/img/post/20181220090109772.gif" alt=""></p> <ol start="2"><li>FocusKeyManager的使用
FocusKeyManager里面管理的item必须实现FocusableOption接口。</li></ol> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>FocusKeyManager继承了ListKeyManager类，FocusableOption实现了ListKeyManagerOption接口</p></div> <p>FocusKeyManager使用场景：如果想ListKeyManager管理的list里面active item想直接接受到浏览器的焦点focus的时候使用。每个item都必须实现FocusableOption接口。下面自定义一个组件ItemFocusOptionComponent,并且这个组件实现了FocusableOption接口，FocusableOption接口的focus()方法里面设置当前item获取焦点。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> HostBinding<span class="token punctuation">,</span> Input<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>FocusableOption<span class="token punctuation">,</span> FocusOrigin<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-item-focus-option'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;ng-content&gt;&lt;/ng-content&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styles<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">:host:focus {
            background: lightblue;
            color: #fff;
        }</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ItemFocusOptionComponent</span> <span class="token keyword">implements</span> <span class="token class-name">FocusableOption</span> <span class="token punctuation">{</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> item<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 屏蔽掉默认的键盘事件，js里面自己控制键盘事件
     */</span>
    @<span class="token function">HostBinding</span><span class="token punctuation">(</span><span class="token string">'tabindex'</span><span class="token punctuation">)</span> tabindex <span class="token operator">=</span> <span class="token string">'-1'</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> host<span class="token operator">:</span> ElementRef</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">getLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 设置获取焦点
     */</span>
    <span class="token function">focus</span><span class="token punctuation">(</span>origin<span class="token operator">?</span><span class="token operator">:</span> FocusOrigin<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>host<span class="token punctuation">.</span>nativeElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// cdk-focus.component.less 样式文件</span>
<span class="token punctuation">.</span>form<span class="token operator">-</span>control <span class="token punctuation">{</span>
  display<span class="token operator">:</span> block<span class="token punctuation">;</span>
  width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">2.25</span>rem <span class="token operator">+</span> <span class="token number">2</span>px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  padding<span class="token operator">:</span> <span class="token number">.375</span>rem <span class="token number">.75</span>rem<span class="token punctuation">;</span>
  font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">1</span>rem<span class="token punctuation">;</span>
  line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
  color<span class="token operator">:</span> #<span class="token number">495057</span><span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  background<span class="token operator">-</span>clip<span class="token operator">:</span> padding<span class="token operator">-</span>box<span class="token punctuation">;</span>
  border<span class="token operator">:</span> <span class="token number">1</span>px solid #ced4da<span class="token punctuation">;</span>
  border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
  transition<span class="token operator">:</span> border<span class="token operator">-</span>color <span class="token number">.15</span>s ease<span class="token operator">-</span><span class="token keyword">in</span><span class="token operator">-</span>out<span class="token punctuation">,</span> box<span class="token operator">-</span>shadow <span class="token number">.15</span>s ease<span class="token operator">-</span><span class="token keyword">in</span><span class="token operator">-</span>out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>form<span class="token operator">-</span>control<span class="token operator">:</span>focus <span class="token punctuation">{</span>
  color<span class="token operator">:</span> #<span class="token number">495057</span><span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  border<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">80</span>bdff<span class="token punctuation">;</span>
  outline<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  box<span class="token operator">-</span>shadow<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0.2</span>rem <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">.25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item<span class="token operator">:</span>first<span class="token operator">-</span>child <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">1</span>rem<span class="token punctuation">;</span>
  border<span class="token operator">-</span>top<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
  border<span class="token operator">-</span>top<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item  <span class="token punctuation">{</span>
  position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
  display<span class="token operator">:</span> block<span class="token punctuation">;</span>
  padding<span class="token operator">:</span> <span class="token number">.75</span>rem <span class="token number">1.25</span>rem<span class="token punctuation">;</span>
  margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>px<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  border<span class="token operator">:</span> <span class="token number">1</span>px solid <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">.125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item<span class="token operator">:</span>last<span class="token operator">-</span>child <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  border<span class="token operator">-</span>bottom<span class="token operator">-</span>right<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
  border<span class="token operator">-</span>bottom<span class="token operator">-</span>left<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">.25</span>rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>list<span class="token operator">-</span>group<span class="token operator">-</span>item<span class="token punctuation">.</span>focus <span class="token punctuation">{</span>
  z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
  color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">007</span>bff<span class="token punctuation">;</span>
  border<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">007</span>bff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// FocusKeyManager的具体使用</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>AfterViewInit<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> QueryList<span class="token punctuation">,</span> ViewChildren<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>FocusableOption<span class="token punctuation">,</span> FocusKeyManager<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ItemFocusOptionComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./focus-item-option/item-focus-option.component&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-focus'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;section class=&quot;list-group&quot; (keyup)=&quot;onKeyDown($event)&quot;&gt;
            &lt;app-item-focus-option *ngFor=&quot;let user of users; index as index&quot;
                                   [item]=&quot;user&quot; class=&quot;list-group-item&quot;
                                   (click)=&quot;selectItem(index)&quot;&gt;
                {{user.name}}
            &lt;/app-item-focus-option&gt;
        &lt;/section&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./cdk-focus.component.less'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkFocusComponent</span> <span class="token keyword">implements</span> <span class="token class-name">AfterViewInit</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取搜有实现了FocusableOption接口的item</span>
    @<span class="token function">ViewChildren</span><span class="token punctuation">(</span>ItemFocusOptionComponent<span class="token punctuation">)</span> items<span class="token operator">:</span> QueryList<span class="token operator">&lt;</span>ItemFocusOptionComponent<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">// list source</span>
    users <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b902934d965e7501f4e1c6f&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Caroline Hodges&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029348f7eed8b6f5f02db&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Delores Rivas&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029346f48c8407c64d0d5&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Darlene Franklin&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029341eff315fa87f9e21&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Alfreda Love&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029342e8917c6ccdb9865&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Marcy Ratliff&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029349dbb48013460e01f&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Beulah Nielsen&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b902934f4f1586e5e72d74a&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Morton Kerr&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029347918bb204bf7014e&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Autumn Tillman&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b902934b86f80e1fc60c626&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Diane Bennett&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5b9029348999f59215020349&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;June Eaton&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> keyManager<span class="token operator">:</span> FocusKeyManager<span class="token operator">&lt;</span>ItemFocusOptionComponent<span class="token operator">&gt;</span><span class="token punctuation">;</span>

    <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建FocusKeyManager对象</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FocusKeyManager</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withWrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withTypeAhead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 传递按键事件
     * @param event
     */</span>
    <span class="token function">onKeyDown</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyManager<span class="token punctuation">.</span><span class="token function">onKeydown</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 点击选中
     * @param index
     */</span>
    <span class="token function">selectItem</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyManager<span class="token punctuation">.</span><span class="token function">setActiveItem</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br></div></div><p><img src="/vuebloger/img/post/2018122009021547.gif" alt=""></p> <h3 id="focustrap"><a href="#focustrap" class="header-anchor">#</a> FocusTrap</h3> <p>focusTrap是cdk ally模块里面提供的一个指令。用于捕获元素中的Tab键焦点。同时控制焦点的范围,Tab切换焦点的时候不会跳出这个区域。举个例子比如有一个视图元素添加了FocusTrap指令，这个视图元素里面有三个input。这样Tab键切换焦点的时候焦点会在这三个input之间切换。</p> <ul><li>Selector: [cdkTrapFocus]</li> <li>Exported as: cdkTrapFocus
还有几个其他的指令可以配合FocusTrap指令来使用:cdkFocusRegionStart、cdkFocusRegionEnd、cdkFocusInitial。咱们上面不是说了FocusTrap指令会控制焦点的范围。cdkFocusRegionStart和cdkFocusRegionEnd指令有可以进一步的控制焦点的范围</li> <li>cdkFocusRegionStart：FocusTrap范围的起点</li> <li>cdkFocusRegionEnd：FocusTrap范围的终点</li> <li>cdkFocusInitial：区间出现时，一开始获取focus的item。</li></ul> <h4 id="focustrap指令属性介绍"><a href="#focustrap指令属性介绍" class="header-anchor">#</a> FocusTrap指令属性介绍</h4> <table><thead><tr><th style="text-align:left;">FocusTrap属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">autoCapture: boolean</td> <td style="text-align:left;">@Input(‘cdkTrapFocusAutoCapture’)</td> <td style="text-align:left;">初始化的时候元素是否自动获取焦点</td></tr> <tr><td style="text-align:left;">enabled: boolean</td> <td style="text-align:left;">@Input(‘cdkTrapFocus’)</td> <td style="text-align:left;">false Tab切换焦点的时候会跑到外面去，true Tab切换焦点的时候焦点不会跑到外面去</td></tr></tbody></table> <h4 id="focustrap指令使用"><a href="#focustrap指令使用" class="header-anchor">#</a> FocusTrap指令使用</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-accessibility'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;!-- FocusTrap的使用，- 控制焦点的范围,tab切换焦点的时候不会跳出这个区域 --&gt;
        &lt;div cdkTrapFocus style=&quot;border: solid 1px #ccc; padding: 10px&quot;&gt;
            &lt;!-- Tab and Shift + Tab will not leave this element. --&gt;
            &lt;input placeholder=&quot;Email&quot;&gt;
            &lt;input type=&quot;password&quot; placeholder=&quot;Password&quot; style=&quot;margin-left: 10px&quot;&gt;
            &lt;button type=&quot;submit&quot; style=&quot;margin-left: 10px&quot;&gt;Submit&lt;/button&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkAccessibilityComponent</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="cdkfocusregionstart-cdkfocusregionend-cdkfocusinitial的使用"><a href="#cdkfocusregionstart-cdkfocusregionend-cdkfocusinitial的使用" class="header-anchor">#</a> cdkFocusRegionStart cdkFocusRegionEnd cdkFocusInitial的使用</h4> <p>cdkFocusRegionStart和cdkFocusRegionEnd的使用应该很好理解。就是用来控制范围的。关键是cdkFocusInitial的使用，cdkFocusInitial必须要配合cdkTrapFocus指令的cdkTrapFocusAutoCapture=true使用。而且我试了下cdkFocusInitial一开始是没有效果，没都是隐藏显示的时候才有效果，才获取到焦点。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-accessibility'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div *ngIf=&quot;displayFocusTrap&quot; cdkTrapFocus cdkTrapFocusAutoCapture=&quot;true&quot;
             style=&quot;border: solid 1px #ccc; padding: 10px; margin-top: 10px&quot;&gt;
            &lt;input value=&quot;1&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;2&quot; cdkFocusRegionStart&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;3&quot; cdkFocusInitial&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;4&quot; cdkFocusRegionEnd&gt;
        &lt;/div&gt;
        &lt;button (click)=&quot;displayFocusTrap=!displayFocusTrap&quot;&gt;显示&lt;/button&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkAccessibilityComponent</span> <span class="token punctuation">{</span>
    displayFocusTrap <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="focusmonitor"><a href="#focusmonitor" class="header-anchor">#</a> FocusMonitor</h3> <p>FocusMonitor是cdk ally里面提供的一个Service。用于监控焦点。FocusMonitor里面常用方法如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">FocusMonitor</span> <span class="token keyword">implements</span> <span class="token class-name">OnDestroy</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 监听元素的焦点获取
     */</span>
    <span class="token function">monitor</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> checkChildren<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>FocusOrigin<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token function">monitor</span><span class="token punctuation">(</span>element<span class="token operator">:</span> ElementRef<span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span><span class="token punctuation">,</span> checkChildren<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span>FocusOrigin<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 停止监听元素的焦点获取
     */</span>
    <span class="token function">stopMonitoring</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token function">stopMonitoring</span><span class="token punctuation">(</span>element<span class="token operator">:</span> ElementRef<span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 设置元素获取焦点
     * @param element 元素
     * @param origin 设置的焦点是通过哪个来的 'touch' | 'mouse' | 'keyboard' | 'program' | null
     * @param options 用于配置focus行为的选项.
     */</span>
    <span class="token function">focusVia</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> origin<span class="token operator">:</span> FocusOrigin<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> FocusOptions<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token function">focusVia</span><span class="token punctuation">(</span>element<span class="token operator">:</span> ElementRef<span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span><span class="token punctuation">,</span> origin<span class="token operator">:</span> FocusOrigin<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> FocusOptions<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="focusmonitor的使用"><a href="#focusmonitor的使用" class="header-anchor">#</a> FocusMonitor的使用</h4> <p>一个简单的例子，咱们仅仅是在元素获取焦点的时候做一个简单的打印。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>AfterViewInit<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> OnDestroy<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>FocusMonitor<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-focus-monitor'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div cdkTrapFocus style=&quot;border: solid 1px #ccc; padding: 10px; margin-top: 10px&quot;&gt;
            &lt;input value=&quot;FocusMonitor item 1&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;FocusMonitor item 2&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;FocusMonitor item 3&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;FocusMonitor item 4&quot;&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkFocusMonitorComponent</span> <span class="token keyword">implements</span> <span class="token class-name">AfterViewInit</span><span class="token punctuation">,</span> OnDestroy <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> _elementRef<span class="token operator">:</span> ElementRef<span class="token punctuation">,</span>
                <span class="token keyword">private</span> _focusMonitor<span class="token operator">:</span> FocusMonitor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * 这里我们只是做了一个简单的打印
         */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_focusMonitor<span class="token punctuation">.</span><span class="token function">monitor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_elementRef<span class="token punctuation">.</span>nativeElement<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">mode</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'元素获取到焦点 focused 来源 '</span> <span class="token operator">+</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_focusMonitor<span class="token punctuation">.</span><span class="token function">stopMonitoring</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_elementRef<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="focustrapfactory"><a href="#focustrapfactory" class="header-anchor">#</a> FocusTrapFactory</h3> <p>FocusTrapFactory也是cdk ally里面提供的一个Service。他的功能就是用来给元素添加cdkFocusTrap指令。FocusTrapFactory常用函数就一个，如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">FocusTrapFactory</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 给指定的元素添加cdkFocusTrap指令，deferCaptureElements参数正好对应cdkFocusTrap指令
     * @Input('cdkTrapFocusAutoCapture')功能
     */</span>
    <span class="token function">create</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> deferCaptureElements<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">)</span><span class="token operator">:</span> FocusTrap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="focustrapfactory使用"><a href="#focustrapfactory使用" class="header-anchor">#</a> FocusTrapFactory使用</h4> <p>通过FocusTrapFactory的crete函数达到cdkFocusTrap指令的效果。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>AfterViewInit<span class="token punctuation">,</span> Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>FocusTrap<span class="token punctuation">,</span> FocusTrapFactory<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-focus-trap-factory'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;div style=&quot;border: solid 1px #ccc; padding: 10px; margin-top: 10px&quot;&gt;
            &lt;input value=&quot;FocusTrapFactory item 1&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;FocusTrapFactory item 2&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;FocusTrapFactory item 3&quot;&gt;
            &lt;input style=&quot;margin-left: 10px&quot; value=&quot;FocusTrapFactory item 4&quot;&gt;
        &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkFocusTrapFactoryComponent</span> <span class="token keyword">implements</span> <span class="token class-name">AfterViewInit</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _focusTrap<span class="token operator">:</span> FocusTrap<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> _elementRef<span class="token operator">:</span> ElementRef<span class="token punctuation">,</span>
                <span class="token keyword">private</span> _focusTrapFactory<span class="token operator">:</span> FocusTrapFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_focusTrap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_focusTrapFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_elementRef<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="interactivitychecker"><a href="#interactivitychecker" class="header-anchor">#</a> InteractivityChecker</h3> <p>InteractivityChecker是一个Service，用于检查元素的一些状态。常见方法如下。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">InteractivityChecker</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 元素是否 disabled.
     */</span>
    <span class="token function">isDisabled</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 元素是否visible
     *
     * This will capture states like `display: none` and `visibility: hidden`, but not things like
     * being clipped by an `overflow: hidden` parent or being outside the viewport.
     *
     * @returns Whether the element is visible.
     */</span>
    <span class="token function">isVisible</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 元素是否接受Tab按键，不如Tab按键切换焦点
     */</span>
    <span class="token function">isTabbable</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    <span class="token comment">/**
     * 元素是否可以获取焦点
     */</span>
    <span class="token function">isFocusable</span><span class="token punctuation">(</span>element<span class="token operator">:</span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="interactivitychecker使用"><a href="#interactivitychecker使用" class="header-anchor">#</a> InteractivityChecker使用</h4> <p>举一个非常简单的例子，打印出button的各种状态。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">,</span> ElementRef<span class="token punctuation">,</span> OnInit<span class="token punctuation">,</span> ViewChild<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>InteractivityChecker<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-interactivity-checker'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;button #interactivityCheckerButton&gt;InteractivityChecker测试&lt;/button&gt;
        &lt;p&gt;上面button是否disable: {{disable}}&lt;/p&gt;
        &lt;p&gt;上面button是否visible: {{visible}}&lt;/p&gt;
        &lt;p&gt;上面button是否可以tabable: {{tabable}}&lt;/p&gt;
        &lt;p&gt;上面button是否可以focusable: {{focusable}}&lt;/p&gt;
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkInteractivityCheckerComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    @<span class="token function">ViewChild</span><span class="token punctuation">(</span><span class="token string">'interactivityCheckerButton'</span><span class="token punctuation">)</span> button<span class="token operator">:</span> ElementRef<span class="token punctuation">;</span>
    disable<span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    visible<span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    tabable<span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    focusable<span class="token operator">:</span> boolean<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> _interactivityChecker<span class="token operator">:</span> InteractivityChecker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>disable <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_interactivityChecker<span class="token punctuation">.</span><span class="token function">isDisabled</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_interactivityChecker<span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tabable <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_interactivityChecker<span class="token punctuation">.</span><span class="token function">isTabbable</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>focusable <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_interactivityChecker<span class="token punctuation">.</span><span class="token function">isFocusable</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button<span class="token punctuation">.</span>nativeElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="liveannouncer"><a href="#liveannouncer" class="header-anchor">#</a> LiveAnnouncer</h3> <p>LiveAnnouncer也是一个Service。用于在屏幕上发布一个消息。把消息显示在屏幕上。关于这一部分的内容估计的去看下W3C关于WAI-ARIA的使用。我们就举一个简单的例子。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>LiveAnnouncer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@angular/cdk/a11y&quot;</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'app-cdk-live-announcer'</span><span class="token punctuation">,</span>
    template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CdkLiveAnnouncerComponent</span> <span class="token punctuation">{</span>
    index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * 会在屏幕上输出Hey Google，三秒之后又会换成Hey Google 2
     */</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> liveAnnouncer<span class="token operator">:</span> LiveAnnouncer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        liveAnnouncer<span class="token punctuation">.</span><span class="token function">announce</span><span class="token punctuation">(</span><span class="token string">&quot;Hey Google&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timerTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">timerTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>liveAnnouncer<span class="token punctuation">.</span><span class="token function">announce</span><span class="token punctuation">(</span><span class="token string">&quot;Hey Google &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;off&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="angular-cdk-stepper"><a href="#angular-cdk-stepper" class="header-anchor">#</a> @angular/cdk/stepper</h2> <p>cdk Stepper 让我们能够更好的处理类似于工作流的情况(任务分为多个步骤，上一步操作完成之后进入下一步的操作，比如咱们休假申请单要经过多个领导的审批的情况)。要使用Stepper 需provider CdkStepperModule的。<code>import {CdkStepperModule} from '@angular/cdk/stepper';</code></p> <p>cdk Stepper看起来复杂其实里面的东西不是很多。整个Stepper都是围绕一个组件CdkStep(cdk-step)和6个指令(CdkStepper、CdkStepLabel、CdkStepperNext、CdkStepperPrevious、CdkStepHeader)来展开的。咱们上面不是说了么，cdk Stepper一般用来处理多个步骤任务。这里每个任务的内容用CdkStep组件来表示，所以有多少个步骤就会 有多少个CdkStep组件。CdkStepper指令呢则是用来管理这些组件比如跳到下一步，上一步，完成等等(所以cdk Stepper使用的时候我们需要另外定义一个组件继承自CdkStepper指令，我们可以把他当做是工作流组件)。CdkStepperNext、CdkStepperPrevious两个指令正好对应上一步下一步，一般会添加在button上面包含在CdkStep组件里面，因为每个步骤都可能有上一步，下一步这样的。CdkStepLabel指令则是对每一个步骤的描述你也可以认为是每个步骤的标题。CdkStepHeader指令一般则是用来表示当前进行到哪一步了。一般也是会自定义一个组件继承CdkStepHeader实现。</p> <h3 id="cdkstep"><a href="#cdkstep" class="header-anchor">#</a> CdkStep</h3> <p>CdkStep其实是一个组件来着。表示每个步骤的内容。所以任务有多少步就会有多少个CdkStep。比如如下代码有两个步骤所以有两个CdkStep(cdk-step)：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>cdk stepper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>yx-stepper</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cdk-step</span> <span class="token attr-name">[stepControl]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>frmStep1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">#step1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cdkStep<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ng-template</span> <span class="token attr-name">cdkStepLabel</span><span class="token punctuation">&gt;</span></span>第一步<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ng-template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">#frmStep1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ngForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin</span><span class="token punctuation">:</span> 8px</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">cdkStepperNext</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>下一步<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cdk-step</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cdk-step</span> <span class="token attr-name">cdkStep</span> <span class="token attr-name">#step2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cdkStep<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ng-template</span> <span class="token attr-name">cdkStepLabel</span><span class="token punctuation">&gt;</span></span>第二步<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ng-template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">#frmStep2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ngForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>b<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>b<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">cdkStepperPrevious</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>上一步<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin</span><span class="token punctuation">:</span> 8px</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">cdkStepperNext</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>完成<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cdk-step</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>yx-stepper</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>每个CdkStep组件里面的内容对应每个步骤的内容。</p> <ul><li>Selector: cdk-step</li> <li>Exported as: cdkStep</li></ul> <h4 id="cdkstep组件属性"><a href="#cdkstep组件属性" class="header-anchor">#</a> CdkStep组件属性</h4> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">内容</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">ariaLabel: string</td> <td style="text-align:left;">@Input(‘aria-label’)</td> <td style="text-align:left;">添加aria-label属性</td></tr> <tr><td style="text-align:left;">ariaLabelledby: string</td> <td style="text-align:left;">@Input(‘aria-labelledby’)</td> <td style="text-align:left;">添加aria-labelledby属性</td></tr> <tr><td style="text-align:left;">completed: boolean</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前步骤是否标记为完成状态</td></tr> <tr><td style="text-align:left;">editable: boolean</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前步骤标记为完成之后，是否还可以回到该步骤</td></tr> <tr><td style="text-align:left;">errorMessage: string</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">错误信息</td></tr> <tr><td style="text-align:left;">hasError: boolean</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">是否有错误</td></tr> <tr><td style="text-align:left;">label: string</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前步骤对应的label,和cdkStepLabel指令的作用是一样的(可以简单的把他认为是步骤的标题)</td></tr> <tr><td style="text-align:left;">optional: boolean</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前步骤是否是可选的</td></tr> <tr><td style="text-align:left;">state: StepState</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前步骤的状态</td></tr> <tr><td style="text-align:left;">stepControl: AbstractControl</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">用于验证当前步骤的合法性</td></tr> <tr><td style="text-align:left;">content: TemplateRef</td> <td style="text-align:left;"></td> <td style="text-align:left;">当前步骤 试图元素内容</td></tr> <tr><td style="text-align:left;">interacted: false</td> <td style="text-align:left;"></td> <td style="text-align:left;">用户是否看到当前步骤内容</td></tr> <tr><td style="text-align:left;">stepLabel: CdkStepLabel</td> <td style="text-align:left;"></td> <td style="text-align:left;">当前步骤label内容</td></tr></tbody></table> <h4 id="cdkstep组件方法"><a href="#cdkstep组件方法" class="header-anchor">#</a> CdkStep组件方法</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> declare <span class="token keyword">class</span> <span class="token class-name">CdkStep</span> <span class="token keyword">implements</span> <span class="token class-name">OnChanges</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token comment">/** 选中当前步骤(select哪个步骤则选中那个步骤) */</span>
    <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 设置当前步骤到无效状态 */</span>
    <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>CdkStep组件里面大部分的方法都需要配合我们下面要讲的CdkStepper指令来使用</p></div> <h3 id="cdkstepper"><a href="#cdkstepper" class="header-anchor">#</a> CdkStepper</h3> <p>CdkStepper是一个指令，用来管理所有的步骤，即CdkStepper是用来管理CdkStep组件的。一般的做法是自定义一个组件继承CdkStepper指令。并且CdkStep组件是这个组件的子组件。比如如下的代码我们定义一个StepperComponent组件继承CdkStepper指令：</p> <ul><li>Selector: [cdkStepper]</li> <li>Exported as: cdkStepper</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
    AfterContentInit<span class="token punctuation">,</span>
    ChangeDetectionStrategy<span class="token punctuation">,</span>
    Component<span class="token punctuation">,</span>
    ContentChildren<span class="token punctuation">,</span>
    EventEmitter<span class="token punctuation">,</span>
    Output<span class="token punctuation">,</span>
    QueryList<span class="token punctuation">,</span>
    ViewEncapsulation
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>AnimationEvent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/animations'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CdkStep<span class="token punctuation">,</span> CdkStepper<span class="token punctuation">,</span> StepContentPositionState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/cdk/stepper'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Subject<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>distinctUntilChanged<span class="token punctuation">,</span> takeUntil<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/operators'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>yxStepperAnimations<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./stepper-animations'</span><span class="token punctuation">;</span>
@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span> <span class="token string">'yx-stepper'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./stepper.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./stepper.component.less'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>provide<span class="token operator">:</span> CdkStepper<span class="token punctuation">,</span> useExisting<span class="token operator">:</span> StepperComponent<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    animations<span class="token operator">:</span> <span class="token punctuation">[</span>yxStepperAnimations<span class="token punctuation">.</span>horizontalStepTransition<span class="token punctuation">]</span><span class="token punctuation">,</span>
    encapsulation<span class="token operator">:</span> ViewEncapsulation<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
    changeDetection<span class="token operator">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">StepperComponent</span> <span class="token keyword">extends</span> <span class="token class-name">CdkStepper</span> <span class="token keyword">implements</span> <span class="token class-name">AfterContentInit</span> <span class="token punctuation">{</span>
    <span class="token comment">/** Steps that the stepper holds. */</span>
    @<span class="token function">ContentChildren</span><span class="token punctuation">(</span>CdkStep<span class="token punctuation">)</span> _steps<span class="token operator">:</span> QueryList<span class="token operator">&lt;</span>CdkStep<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token comment">/** Event emitted when the current step is done transitioning in. */</span>
    @<span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> readonly animationDone<span class="token operator">:</span> EventEmitter<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _animationDone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token operator">&lt;</span>AnimationEvent<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ngAfterContentInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Mark the component for change detection whenever the content children query changes</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_steps<span class="token punctuation">.</span>changes<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">takeUntil</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_destroyed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_stateChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>_animationDone<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
            <span class="token comment">// This needs a `distinctUntilChanged` in order to avoid emitting the same event twice due</span>
            <span class="token comment">// to a bug in animations where the `.done` callback gets invoked twice on some browsers.</span>
            <span class="token comment">// See https://github.com/angular/angular/issues/24084</span>
            <span class="token function">distinctUntilChanged</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>fromState <span class="token operator">===</span> y<span class="token punctuation">.</span>fromState <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>toState <span class="token operator">===</span> y<span class="token punctuation">.</span>toState<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">takeUntil</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_destroyed<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>toState <span class="token keyword">as</span> StepContentPositionState<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'current'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>animationDone<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h4 id="cdkstepper属性"><a href="#cdkstepper属性" class="header-anchor">#</a> CdkStepper属性</h4> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">解释</th></tr></thead> <tbody><tr><td style="text-align:left;">linear: boolean</td> <td style="text-align:left;">@Input()	任务流是否是线性的，</td> <td style="text-align:left;">前一个任务完成才能进行下一个任务</td></tr> <tr><td style="text-align:left;">selected: CdkStep</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前选中的任务</td></tr> <tr><td style="text-align:left;">selectedIndex: number</td> <td style="text-align:left;">@Input()</td> <td style="text-align:left;">当前选中任务的index</td></tr> <tr><td style="text-align:left;">selectionChange: EventEmitter</td> <td style="text-align:left;">@Output()</td> <td style="text-align:left;">选中任务改变时候的回调函数</td></tr></tbody></table> <h4 id="cdkstepper方法"><a href="#cdkstepper方法" class="header-anchor">#</a> CdkStepper方法</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">CdkStepper</span> <span class="token keyword">implements</span> <span class="token class-name">AfterViewInit</span><span class="token punctuation">,</span> OnDestroy <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token comment">/** 切换到下一个任务 */</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 切换到上一个任务 */</span>
    <span class="token function">previous</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token comment">/** 重置所有的任务 */</span>
    <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="cdksteplabel"><a href="#cdksteplabel" class="header-anchor">#</a> CdkStepLabel</h3> <p>指令，每个步骤需要显示的label内容，比如如下代码第一步部分就是某个任务的label。</p> <ul><li>Selector: [cdkStepLabel]</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cdk-step</span> <span class="token attr-name">[stepControl]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>frmStep1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">#step1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>cdkStep<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ng-template</span> <span class="token attr-name">cdkStepLabel</span><span class="token punctuation">&gt;</span></span>第一步<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ng-template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">#frmStep1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ngForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>a<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin</span><span class="token punctuation">:</span> 8px</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">cdkStepperNext</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>下一步<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cdk-step</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="cdksteppernext"><a href="#cdksteppernext" class="header-anchor">#</a> CdkStepperNext</h3> <p>添加在button上的指令，跳到下一个任务。</p> <ul><li>Selector: button[cdkStepperNext]</li></ul> <h3 id="cdkstepperprevious"><a href="#cdkstepperprevious" class="header-anchor">#</a> CdkStepperPrevious</h3> <p>添加在button上的指令，跳到上一个任务。</p> <ul><li>Selector: button[cdkStepperPrevious]</li></ul> <h3 id="cdkstepheader"><a href="#cdkstepheader" class="header-anchor">#</a> CdkStepHeader</h3> <p>指令，每个任务的头部信息，任务指示器。</p> <p>关于cdk参考示例代码，有兴趣的大家可以看看例子这里的<a href="https://github.com/tuacy/angular-cdk-study" target="_blank" rel="noopener noreferrer">例子<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,其中cdk stepper部分内容在workflow-stepper文件下面。实现效果图如下：</p> <p><img src="/vuebloger/img/post/20190105231823718.gif" alt=""></p> <h2 id="相关策略"><a href="#相关策略" class="header-anchor">#</a> 相关策略</h2> <ul><li>定位策略
PositionStrategy</li> <li>滚动策略
ScrollStrategy</li> <li>块滚动策略
BlockScrollStrategy</li> <li>空的滚动策略
NoopScrollStrategy</li> <li>关闭滚动策略
CloseScrollStrategy</li> <li>关闭滚动策略配置
CloseScrollStrategyConfig</li> <li>滚动策略配置项
ScrollStrategyOptions</li></ul> <h2 id="资料"><a href="#资料" class="header-anchor">#</a> 资料</h2> <ul><li><a href="https://www.npmjs.com/package/@angular/cdk" target="_blank" rel="noopener noreferrer">cdk npm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li> <li><a href="https://material.angular.io/cdk/categories" target="_blank" rel="noopener noreferrer">cdk文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/vuebloger/assets/js/app.9ef6ba52.js" defer></script><script src="/vuebloger/assets/js/7.c457106d.js" defer></script><script src="/vuebloger/assets/js/1.c991d8a0.js" defer></script><script src="/vuebloger/assets/js/42.f930fbcb.js" defer></script><script src="/vuebloger/assets/js/31.e713824e.js" defer></script>
  </body>
</html>
