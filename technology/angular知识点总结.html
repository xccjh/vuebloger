<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>angular知识点总结 | 邹先生博客记录</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/vuebloger/img/logo.jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="">
    <link rel="preload" href="/vuebloger/assets/css/0.styles.765be3c8.css" as="style"><link rel="preload" href="/vuebloger/assets/js/app.7c1f8ffb.js" as="script"><link rel="preload" href="/vuebloger/assets/js/7.57d3d60e.js" as="script"><link rel="preload" href="/vuebloger/assets/js/1.45114b1b.js" as="script"><link rel="preload" href="/vuebloger/assets/js/35.41383072.js" as="script"><link rel="preload" href="/vuebloger/assets/js/29.0b036396.js" as="script"><link rel="prefetch" href="/vuebloger/assets/js/10.2fc7b3fc.js"><link rel="prefetch" href="/vuebloger/assets/js/100.be5d8ddb.js"><link rel="prefetch" href="/vuebloger/assets/js/101.f691d7b0.js"><link rel="prefetch" href="/vuebloger/assets/js/102.9ae9b1da.js"><link rel="prefetch" href="/vuebloger/assets/js/103.9ff70ffa.js"><link rel="prefetch" href="/vuebloger/assets/js/104.655ed71c.js"><link rel="prefetch" href="/vuebloger/assets/js/105.99215c25.js"><link rel="prefetch" href="/vuebloger/assets/js/11.e29a9a25.js"><link rel="prefetch" href="/vuebloger/assets/js/12.831b2cd3.js"><link rel="prefetch" href="/vuebloger/assets/js/13.930f2726.js"><link rel="prefetch" href="/vuebloger/assets/js/14.40008030.js"><link rel="prefetch" href="/vuebloger/assets/js/15.accc0efc.js"><link rel="prefetch" href="/vuebloger/assets/js/16.f1c6b366.js"><link rel="prefetch" href="/vuebloger/assets/js/17.b6d307fb.js"><link rel="prefetch" href="/vuebloger/assets/js/18.57456fc5.js"><link rel="prefetch" href="/vuebloger/assets/js/19.6a7856cd.js"><link rel="prefetch" href="/vuebloger/assets/js/20.e6033fd0.js"><link rel="prefetch" href="/vuebloger/assets/js/21.6de1dc73.js"><link rel="prefetch" href="/vuebloger/assets/js/22.42ec85ca.js"><link rel="prefetch" href="/vuebloger/assets/js/23.9e1ef2c4.js"><link rel="prefetch" href="/vuebloger/assets/js/24.a0182879.js"><link rel="prefetch" href="/vuebloger/assets/js/25.32930347.js"><link rel="prefetch" href="/vuebloger/assets/js/26.c2f721ac.js"><link rel="prefetch" href="/vuebloger/assets/js/27.8029ac75.js"><link rel="prefetch" href="/vuebloger/assets/js/28.a92e6703.js"><link rel="prefetch" href="/vuebloger/assets/js/30.f2b5ccec.js"><link rel="prefetch" href="/vuebloger/assets/js/31.ba466e37.js"><link rel="prefetch" href="/vuebloger/assets/js/32.7ed3fecc.js"><link rel="prefetch" href="/vuebloger/assets/js/33.454ca94c.js"><link rel="prefetch" href="/vuebloger/assets/js/34.403d12e1.js"><link rel="prefetch" href="/vuebloger/assets/js/36.e729e2e9.js"><link rel="prefetch" href="/vuebloger/assets/js/37.42d66089.js"><link rel="prefetch" href="/vuebloger/assets/js/38.2a8c34e8.js"><link rel="prefetch" href="/vuebloger/assets/js/39.6c95fd09.js"><link rel="prefetch" href="/vuebloger/assets/js/4.a8731740.js"><link rel="prefetch" href="/vuebloger/assets/js/40.c50f956f.js"><link rel="prefetch" href="/vuebloger/assets/js/41.c2add38d.js"><link rel="prefetch" href="/vuebloger/assets/js/42.d81983ad.js"><link rel="prefetch" href="/vuebloger/assets/js/43.79aee40a.js"><link rel="prefetch" href="/vuebloger/assets/js/44.29d928d5.js"><link rel="prefetch" href="/vuebloger/assets/js/45.e87645b4.js"><link rel="prefetch" href="/vuebloger/assets/js/46.f9cca836.js"><link rel="prefetch" href="/vuebloger/assets/js/47.5ea01831.js"><link rel="prefetch" href="/vuebloger/assets/js/48.c6e9e7d4.js"><link rel="prefetch" href="/vuebloger/assets/js/49.032b9545.js"><link rel="prefetch" href="/vuebloger/assets/js/5.cb43f664.js"><link rel="prefetch" href="/vuebloger/assets/js/50.47db4a97.js"><link rel="prefetch" href="/vuebloger/assets/js/51.9676c607.js"><link rel="prefetch" href="/vuebloger/assets/js/52.00f67b90.js"><link rel="prefetch" href="/vuebloger/assets/js/53.3811be6e.js"><link rel="prefetch" href="/vuebloger/assets/js/54.0d087cc6.js"><link rel="prefetch" href="/vuebloger/assets/js/55.0fc2cb72.js"><link rel="prefetch" href="/vuebloger/assets/js/56.98d875ce.js"><link rel="prefetch" href="/vuebloger/assets/js/57.ac4f8aad.js"><link rel="prefetch" href="/vuebloger/assets/js/58.950b262c.js"><link rel="prefetch" href="/vuebloger/assets/js/59.7e7978fd.js"><link rel="prefetch" href="/vuebloger/assets/js/6.93649df6.js"><link rel="prefetch" href="/vuebloger/assets/js/60.49b61685.js"><link rel="prefetch" href="/vuebloger/assets/js/61.4149a0ad.js"><link rel="prefetch" href="/vuebloger/assets/js/62.496605bb.js"><link rel="prefetch" href="/vuebloger/assets/js/63.662294f9.js"><link rel="prefetch" href="/vuebloger/assets/js/64.9d340b4f.js"><link rel="prefetch" href="/vuebloger/assets/js/65.e385fbb7.js"><link rel="prefetch" href="/vuebloger/assets/js/66.71f0b6e3.js"><link rel="prefetch" href="/vuebloger/assets/js/67.22254a3c.js"><link rel="prefetch" href="/vuebloger/assets/js/68.97fc078f.js"><link rel="prefetch" href="/vuebloger/assets/js/69.8e030acb.js"><link rel="prefetch" href="/vuebloger/assets/js/70.f335c715.js"><link rel="prefetch" href="/vuebloger/assets/js/71.213b66aa.js"><link rel="prefetch" href="/vuebloger/assets/js/72.b6c7f099.js"><link rel="prefetch" href="/vuebloger/assets/js/73.c78bac38.js"><link rel="prefetch" href="/vuebloger/assets/js/74.184e8892.js"><link rel="prefetch" href="/vuebloger/assets/js/75.0ff910c5.js"><link rel="prefetch" href="/vuebloger/assets/js/76.f41eedad.js"><link rel="prefetch" href="/vuebloger/assets/js/77.a5709232.js"><link rel="prefetch" href="/vuebloger/assets/js/78.18aaea82.js"><link rel="prefetch" href="/vuebloger/assets/js/79.a4526315.js"><link rel="prefetch" href="/vuebloger/assets/js/8.66b2430f.js"><link rel="prefetch" href="/vuebloger/assets/js/80.a85516a8.js"><link rel="prefetch" href="/vuebloger/assets/js/81.4072d5c7.js"><link rel="prefetch" href="/vuebloger/assets/js/82.4f28f77f.js"><link rel="prefetch" href="/vuebloger/assets/js/83.e5b03090.js"><link rel="prefetch" href="/vuebloger/assets/js/84.a1de9087.js"><link rel="prefetch" href="/vuebloger/assets/js/85.e14e1a11.js"><link rel="prefetch" href="/vuebloger/assets/js/86.93ece64a.js"><link rel="prefetch" href="/vuebloger/assets/js/87.381fefa7.js"><link rel="prefetch" href="/vuebloger/assets/js/88.44903610.js"><link rel="prefetch" href="/vuebloger/assets/js/89.862ac620.js"><link rel="prefetch" href="/vuebloger/assets/js/9.6529d756.js"><link rel="prefetch" href="/vuebloger/assets/js/90.a8524129.js"><link rel="prefetch" href="/vuebloger/assets/js/91.f628fa6e.js"><link rel="prefetch" href="/vuebloger/assets/js/92.152f9331.js"><link rel="prefetch" href="/vuebloger/assets/js/93.f4ae107a.js"><link rel="prefetch" href="/vuebloger/assets/js/94.fce11bc1.js"><link rel="prefetch" href="/vuebloger/assets/js/95.544c03db.js"><link rel="prefetch" href="/vuebloger/assets/js/96.3207eae3.js"><link rel="prefetch" href="/vuebloger/assets/js/97.f5ca3334.js"><link rel="prefetch" href="/vuebloger/assets/js/98.0faa032a.js"><link rel="prefetch" href="/vuebloger/assets/js/99.274cbecc.js"><link rel="prefetch" href="/vuebloger/assets/js/vendors~docsearch.93a338c9.js">
    <link rel="stylesheet" href="/vuebloger/assets/css/0.styles.765be3c8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuebloger/" class="home-link router-link-active"><img src="/vuebloger/img/logo.jpeg" alt="邹先生博客记录" class="logo"> <span class="site-name can-hide">邹先生博客记录</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <div style="margin-left:20px;margin-right:20px;">
    音乐
    <div role="switch" class="el-switch"><input type="checkbox" name="" true-value="true" class="el-switch__input"><!----><span class="el-switch__core" style="width:40px;"></span><!----></div> <audio><source src="/vuebloger/mp3/065b_520b_0409_111c898908eab454414c3c326fe77c36.mp3" type="audio/mpeg"></audio></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>angular知识点总结</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#angular简介" class="sidebar-link">angular简介</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#开始项目" class="sidebar-link">开始项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#运行创建的项目" class="sidebar-link">运行创建的项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#ngmodule" class="sidebar-link">ngModule</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#组件" class="sidebar-link">组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#元数据-metadata" class="sidebar-link">元数据 Metadata</a></li></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#数据绑定" class="sidebar-link">数据绑定</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#组件间通讯" class="sidebar-link">组件间通讯</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#一、嵌套组件间通讯" class="sidebar-link">一、嵌套组件间通讯</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_1-父组件向子组件传递数据" class="sidebar-link">1.父组件向子组件传递数据</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_2-子组件向父组件传递数据" class="sidebar-link">2.子组件向父组件传递数据</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_3-父组件调用子组件属性-方法" class="sidebar-link">3.父组件调用子组件属性/方法</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_4-ng-content内容投射" class="sidebar-link">4.ng-content内容投射</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#二、非嵌套组件组件通讯" class="sidebar-link">二、非嵌套组件组件通讯</a></li></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#路由" class="sidebar-link">路由</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#url传参" class="sidebar-link">URL传参</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#路由配置传参" class="sidebar-link">路由配置传参</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#查询参数传参" class="sidebar-link">查询参数传参</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#routerlink写法" class="sidebar-link">routerLink写法</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#关于子路由" class="sidebar-link">关于子路由</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#url中没有-号" class="sidebar-link">URL中没有#号</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#js路由导航" class="sidebar-link">js路由导航</a></li></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#指令" class="sidebar-link">指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#属性型指令" class="sidebar-link">属性型指令</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#结构型指令" class="sidebar-link">结构型指令</a></li></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#事件" class="sidebar-link">事件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#管道" class="sidebar-link">管道</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#服务与代理" class="sidebar-link">服务与代理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#依赖注入、控制反转" class="sidebar-link">依赖注入、控制反转</a></li></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#foreach循环" class="sidebar-link">forEach循环</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#表单验证" class="sidebar-link">表单验证</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#rxjs操作符" class="sidebar-link">rxjs操作符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#rxjs初试" class="sidebar-link">RxJS初试</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#rxjs常见操作符" class="sidebar-link">RxJS常见操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#一、常见创建类操作符" class="sidebar-link">一、常见创建类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#二、observable的性质" class="sidebar-link">二、Observable的性质</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#三、常见操作符" class="sidebar-link">三、常见操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_1-转换操作符" class="sidebar-link">1.转换操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_2-工作操作符" class="sidebar-link">2.工作操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_3-变换类操作符" class="sidebar-link">3.变换类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_4-数学统计类操作符" class="sidebar-link">4.数学统计类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_5-过滤类操作符" class="sidebar-link">5.过滤类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_6-时间类操作符" class="sidebar-link">6.时间类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_7-过滤类操作符" class="sidebar-link">7.过滤类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#_9-合并类操作符" class="sidebar-link">9.合并类操作符</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#四、应用实例" class="sidebar-link">四、应用实例</a></li></ul></li><li><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#angular使用redux" class="sidebar-link">angular使用redux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#简单内存版" class="sidebar-link">简单内存版</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#时光旅行调试器" class="sidebar-link">时光旅行调试器</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/angular%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93.html#带http后台版本" class="sidebar-link">带HTTP后台版本</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content__default"><h2 id="angular简介"><a href="#angular简介" class="header-anchor">#</a> angular简介</h2> <p>2009年谷歌发布Angular1，2016年9月Angular2正式版发布，Angular3由于在开发过程中出现问题（Router模块）被放弃，直接奔向4，2017年3月Angular4正式版发布，之后还有5、6、7，改动都不是很大，2019年5月28日，Angular8正式发布。截至2020年4月1日，angular最新版本angular11,ngrx11。其实这些版本中只有1.x是最特别的，因为1.x与2以及之后的版本完全不一样。</p> <p>anglular主要包含的知识点</p> <ul><li>Modules 模块</li> <li>Components 组件</li> <li>Templates 模板</li> <li>Metadata 元数据</li> <li>Data binding 数据绑定
组件间通讯</li> <li>Directives 指令</li> <li>Services 服务</li> <li>Pipes 管道: 使用模板中的管道来改变展示的值，从而改善用户体验。比如 currency这个管道表达式：</li> <li>Dependency injection 依赖注入</li> <li>Animations 动画: 不需要深入了解动画技术或者CSS，使用 Angular 动画库给组件添加动画效果。</li> <li>Change detection 变化检测: 变化检测文档将会涵盖 Angular 如何决定组件属性值是否已改变，何时更新视图，如何使用zones拦截异步活动，以及运行变化检测策略的。</li> <li>Events 事件: 事件文档将涵盖通过订阅和发布事件的机制，如何使用组件和服务来唤起事件。</li> <li>Forms 表单: 使用 基于HTML的验证和脏检查机制，支持复杂的数据输入情形。</li> <li>HTTP: 通过 HTTP 客户端与服务端通讯以获取数据、保存数据以及来唤起 服务端的响应。</li> <li>Lifecycle hooks 生命周期钩子: 利用组件的生命周期的关键时刻，从创建到销毁，应用生命周期钩子接口。</li> <li>Router 路由: 在客户端应用中，从一个页面导航到另一个页面，从不离开浏览器。</li> <li>Testing 测试: 使用 Angular Testing Platform，当应用的各个部分与 Angular 框架交互时，进行单元测试。</li></ul> <h2 id="开始项目"><a href="#开始项目" class="header-anchor">#</a> 开始项目</h2> <p>安装node.js
安装Typescript</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install -g typescript
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>安装Angular-cli</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install -g @angular/cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>创建新项目</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ng new 项目的名字
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/vuebloger/img/post/20190608150210900.png" alt=""></p> <h2 id="运行创建的项目"><a href="#运行创建的项目" class="header-anchor">#</a> 运行创建的项目</h2> <p>ng serve。其实运行npm start一样能启动项目，npm start是调的ng serve.</p> <p><img src="/vuebloger/img/post/20190608151402992.png" alt=""></p> <p>通过Angular-cli生成的项目，在编码风格上与自己的习惯不一致时，可以通过修改tslint.json文件中的配置</p> <p><img src="/vuebloger/img/post/20190608152542290.png" alt=""></p> <p>Angular项目目录结构介绍</p> <p><img src="/vuebloger/img/post/20190608153038777.png" alt=""></p> <h2 id="ngmodule"><a href="#ngmodule" class="header-anchor">#</a> ngModule</h2> <div class="custom-block tip"><p class="custom-block-title">温馨提示</p> <p>每个 Angular 应用都至少有一个 NgModule 类，也就是根模块，它习惯上命名为 AppModule，并位于一个名叫 app.module.ts 的文件中。引导这个根模块就可以启动你的应用</p></div> <p><img src="/vuebloger/img/post/20190608184127910.png" alt=""></p> <p>@NgModule 是一个装饰器函数，它有一个元数据（metadata）对象。这个对象的属性（properties）用于修饰这个模块。主要属性有以下这5个：</p> <ol><li>declarations: 从属于这个模块的视图类（ view classes）。Angular 有3种视图类：组件（components）, 指令（directives） 以及管道（pipes）</li> <li>exports: declarations 的子集，在其他模块的组件模板中可见以及可用的视图类（即暴露给其他模块用的视图类）。</li> <li>imports: 在这个模块的组件模板中需要使用到的类所在的其它模块（即依赖的其他模块）。</li> <li>providers: 服务（service）的创建者，这个模块将这些服务添加到整个全局服务集合中。这些服务在整个应用中可用。</li> <li>bootstrap: 应用的主视图，称作根组件（root component）， 存储着应用其他的视图。只有根模块（root modul）需要设置这个属性。</li></ol> <blockquote><p>BrowserModule</p></blockquote> <p>导出库：@angular/platform-browser</p> <p>作用：提供在浏览中运行的一些资源（指令等其他）</p> <p>使用：在 根module中imports（app.module.ts）</p> <blockquote><p>platformBrowserDynamic</p></blockquote> <p>作用：从一个指定的NgModule中使用根组件引导应用</p> <p>导出库：@angular/platform-browser-dynamic</p> <p>使用：在引导应用启动的文件中（main.ts）</p> <p>根模块示例,注意根模块不需要导出任何东西，因为其他组件不需要导入这个根模块。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> NgModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>
@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span>      <span class="token punctuation">[</span> BrowserModule <span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span>    <span class="token punctuation">[</span> Logger <span class="token punctuation">]</span><span class="token punctuation">,</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span> AppComponent <span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span>      <span class="token punctuation">[</span> AppComponent <span class="token punctuation">]</span><span class="token punctuation">,</span>
  bootstrap<span class="token operator">:</span>    <span class="token punctuation">[</span> AppComponent <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>通过引导根模块来启动一个应用程序。在 main.ts 文件中像这样引导 AppModule：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//.src/main.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> platformBrowserDynamic <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser-dynamic'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app/app.module'</span><span class="token punctuation">;</span>
<span class="token function">platformBrowserDynamic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bootstrapModule</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>Angular模块（NgModules） vs. JavaScript 模块 vs Angular 库（Angular libraries）</p></blockquote> <p>Angular 以 一系列的JavaScript 模块的形式推出市场。你可以把他们当做库模块。每一个 Angular 库的名字都带有 @angular 前缀。通过 npm 包管理工具安装这些库，通过 JavaScript 的 import 声明语句来导入他们中的部分内容。比如，从 @angular/core 库模块中导入 Angular 的 Component 装饰器：<code>import { Component } from '@angular/core';</code>也可以使用 JavaScript 的 import 声明语句 来从 Angular 库模块中导入Angular模块（NgModules）<code>import { BrowserModule } from '@angular/platform-browser';</code></p> <p>在之前的 根模块示例中，应用的模块需要使用 BrowserModule 里的素材。为了访问到这些素材，需要把 BrowserModule 添加到 @NgModule 的元数据中,<code>imports: [ BrowserModule ]</code>这样，同时使用了 Angular和 JavaScript 的模块系统。</p> <h2 id="组件"><a href="#组件" class="header-anchor">#</a> 组件</h2> <p>通过<code>ng g component 组件名称</code>生成组件模板</p> <p>@Component 装饰器会指出紧随其后的那个类是组件类，并指定元数据。</p> <p><img src="/vuebloger/img/post/20190608181622896.jpg" alt=""></p> <h3 id="元数据-metadata"><a href="#元数据-metadata" class="header-anchor">#</a> 元数据 Metadata</h3> <p>在 TypeScript 中，我们通过 装饰器（decorator）来添加元数据。 以下代码是组件 HeroListComponent 的一些元数据：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span>    <span class="token string">'hero-list'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./hero-list.component.html'</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span>  <span class="token punctuation">[</span> HeroService <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HeroListComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    <span class="token comment">/* . . . */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>元数据告诉 Angular 如何处理一个类。在 TypeScript 中，我们通过 装饰器（decorator）来添加元数据。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token operator">:</span>    <span class="token string">'hero-list'</span><span class="token punctuation">,</span>
    templateUrl<span class="token operator">:</span> <span class="token string">'./hero-list.component.html'</span><span class="token punctuation">,</span>
    providers<span class="token operator">:</span>  <span class="token punctuation">[</span> HeroService <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HeroListComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    <span class="token comment">/* . . . */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>装饰器 @Component 把紧挨着它的类指定为一个组件类。装饰器 @Component 必须接收一个配置对象作为参数，它包含 Angular 创建并展示这个组件及其视图所需要的信息。</p> <p>以下是一些最有用的 @Component 的配置选项：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>selector: CSS 选择器。告诉 Angular 创建这个组件的实例并将这个实例插入到 CSS 选择器（&lt;hero-list&gt;标签） 所在的父级 HTML 上。如果一个 app 的 HTML 包含 标签， Angular 会将组件 HeroListComponent 视图的实例插入到这个标签之间。

templateUlr： 这个组件的 HTML 模板所在的相对位置。

providers: 组件所需要的服务的依赖注入提供商数组。它告知 Angular 这个组件的构造函数需要 HeroService 服务，以便获取一个 heroes 的列表来展示。

@Component 装饰器里的元数据 告知 Angular 从哪里去获取我们为这个组件指定的构建单元。

@Injectable 、@Input 和 @Output 是几个比较常用的装饰器。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>我们必须在代码中添加元数据，这样 Angular 才知道该做什么。</p> <h2 id="数据绑定"><a href="#数据绑定" class="header-anchor">#</a> 数据绑定</h2> <p><img src="/vuebloger/img/post/20171125150925157.png" alt=""></p> <p>Angular 有4种数据绑定的方式。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1）插值表达式（interpolation）：插值表达式 {{ hero.name }} 在 &lt;li&gt;元素之间展示组件的 hero.name 属性值。

2）属性绑定（property binding）：属性绑定 [hero] 将父组件 HeroListComponent 的 selectedHero 的值传递给向子组件 的 hero 属性。

3）事件绑定（event binding）： 当用户点击一个 hero 的名字是，(click) 事件绑定调用了组件的 selectHero 方法。

4) 双向绑定是第四种重要的绑定方法。它使用 [(ngModel)] 指令，在一个表达式中同时绑定属性和事件。

&lt;input [(ngModel)]=&quot;hero.name&quot;&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>在双向绑定中，数据的属性值像属性绑定一样，从组件流向 input 输入框。用户输入值改变，数据从 input　输入框流回到组件，将最后的值重置为组件里的属性的值，正如事件绑定一样。</p> <p>每次 JavaScript 事件循环，Angular 都会处理所有的数据绑定，从应用组件的根部到所有的子组件。</p> <h2 id="组件间通讯"><a href="#组件间通讯" class="header-anchor">#</a> 组件间通讯</h2> <h3 id="一、嵌套组件间通讯"><a href="#一、嵌套组件间通讯" class="header-anchor">#</a> 一、嵌套组件间通讯</h3> <h3 id="_1-父组件向子组件传递数据"><a href="#_1-父组件向子组件传递数据" class="header-anchor">#</a> 1.父组件向子组件传递数据</h3> <p>步骤1：在子组件选择器标签上进行属性绑定，所绑定的值为父组件的某个属性，也就是你要传递给子组件的值</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> &lt;out #child [requestData]=&quot;sendToChild&quot; (sendToParent)=&quot;getOutput($event)&quot;&gt;&lt;/out&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的代码片段中<code>[requestData]=&quot;sendToChild&quot;</code>就是进行进行的步骤1，requestData是子组件out的接收变量名，sendToChild是父组件中的一个属性，它的值如果发生变化，子组件所接收到的值也会立即变化。</p> <p>步骤2：在子组件的.ts文件中使用@Input()属性装饰器进行接收</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Input()
requestData:string;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>至此，只要父组件中sendToChild的值发生变化，子组件requestData的值也就会马上变化。</p> <h3 id="_2-子组件向父组件传递数据"><a href="#_2-子组件向父组件传递数据" class="header-anchor">#</a> 2.子组件向父组件传递数据</h3> <p>步骤1：先定义属性装饰器@Output()</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Output()
sendToParent:EventEmitter&lt;string&gt;=new EventEmitter();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>关于EventEmitter类用来发射对象或属性给父组件的。要注意的是，这里的EventEmitter类是@angular/core里引入的，不能是其他模块里的，比如events里也有EventEmitter类。
步骤2：主动触发发射(当然也可以是代码逻辑发射)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;input type=&quot;text&quot; placeholder=&quot;往父组件中传入的值&quot; [(ngModel)]=&quot;toParent&quot;&gt;
&lt;button class=&quot;btn btn-primary&quot; (click)=&quot;sendToPar()&quot;&gt;确定&lt;/button&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>toParent:string;
sendToPar(){
    this.sendToParent.emit(this.toParent);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>通过emit方法将要发射的值发射出去。</p> <p>上面是子组件进行了发射的相关步骤，下面是父组件的步骤</p> <p>步骤3：要接收谁的值就去它的选择器上进行监听</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;out #child [requestData]=&quot;sendToChild&quot; (sendToParent)=&quot;getOutput($event)&quot;&gt;&lt;/out&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>(sendToParent)=&quot;getOutput($event)&quot;所绑定的事件sendToParent必须是子组件中的EventEmitter实例。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>requestData: string;
getOutput(event: string) {
    this.requestData = event;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_3-父组件调用子组件属性-方法"><a href="#_3-父组件调用子组件属性-方法" class="header-anchor">#</a> 3.父组件调用子组件属性/方法</h3> <p>这种方式是通过@ViewChild来实现的，就像是new了一个子组件的实例一样。</p> <p>步骤1：给子组件定义模板变量</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  &lt;out #child [requestData]=&quot;sendToChild&quot; (sendToParent)=&quot;getOutput($event)&quot;&gt;&lt;/out&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>#child</code>就是模板变量，在当前HTML页面中都可以使用，在<code>.ts</code>文件中我的理解就像<code>document.getElementById()</code></p> <p>步骤2：使用@ViewChild()属性装饰器注入到父组件中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@ViewChild(&quot;child&quot;)
childRecive: OutputComponent;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>经过@ViewChild()装饰的属性childRecive将会成为OutputComponent的实例。这里的OutputComponent是子组件out的类，如果使用模板变量的标签是普通HTML标签，则类型为：ElementRef。经过这个两个步骤，父组件就可以调用子组件中的方法和属性了。</p> <p>关于模板变量的的另一种使用，官网上还有一种是父子组件通过本地变量互动，其实就是利用模板变量在当前HTML中任何地方都可以使用的特性。</p> <h3 id="_4-ng-content内容投射"><a href="#_4-ng-content内容投射" class="header-anchor">#</a> 4.ng-content内容投射</h3> <p>步骤1：在子组件选择器标签中写HTML代码片段</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>out</span> <span class="token attr-name">#child</span> <span class="token attr-name">[requestData]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>sendToChild<span class="token punctuation">&quot;</span></span> <span class="token attr-name">(sendToParent)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>getOutput($event)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--
      选择器之间是可以写HTML代码片段的，这些片段将会显示在这个组件（outcomponent）的模板中，
      前提之一是这个组件的模板中有调用了ng-content指令，一般的关系是从父组件到子组件，这里
      还可以进行插值绑定获取其他的数据的绑定等，所绑定的值是父组件的值
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这是头：这个是在父组件中的写的代码显示到了子组件中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>这个是在父组件中的写的代码显示到了子组件中，这是父组件中的属性：
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{context}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这是脚：这个是在父组件中的写的代码显示到了子组件中<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>out</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>步骤2：在子组件的HTML文件中使用ng-content标记投射点</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token string">&quot;border:1px solid darkslateblue;&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 标记投影点，从父组件投影部分<span class="token constant">HTML</span>代码片段过来在这个位置显示 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ng<span class="token operator">-</span>content select<span class="token operator">=</span><span class="token string">&quot;.header&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>content<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ng<span class="token operator">-</span>content<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>content<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ng<span class="token operator">-</span>content select<span class="token operator">=</span><span class="token string">&quot;.footer&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ng<span class="token operator">-</span>content<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>select属性支持css选择器（”#id”,”.class”等等），结果如下：</p> <p><img src="/vuebloger/img/post/20190619200147984.png" alt=""></p> <h3 id="二、非嵌套组件组件通讯"><a href="#二、非嵌套组件组件通讯" class="header-anchor">#</a> 二、非嵌套组件组件通讯</h3> <p>对于非嵌套组件组件通讯，通过service形象点说就是桥，或者容器，一方将数据放入这个容器，另一方需要的时候进行读取，实现如下：</p> <p>步骤1：创建一个service，命令：ng g service 服务的名称</p> <p>步骤2：创建好service之后，编写接收函数和读取函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> message<span class="token operator">:</span>string<span class="token punctuation">;</span>
 <span class="token function">sentMessage</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span>string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span>message<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>步骤3：在需要的地方注入服务就可以使用了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">private</span> messageService<span class="token operator">:</span>MessageService</span>
<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//要发送消息的组件调用服务</span>
<span class="token function">sent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>messageService<span class="token punctuation">.</span><span class="token function">sentMessage</span><span class="token punctuation">(</span><span class="token string">&quot;发送的消息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//要获取消息的组件中调用服务</span>
message<span class="token operator">:</span>string<span class="token punctuation">;</span>
<span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>messageService<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>注入了服务就可以使用服务里的属性和方法了</p> <h2 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h2> <table><thead><tr><th style="text-align:center;">路由器部件</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td style="text-align:center;">Router（路由器）</td> <td style="text-align:center;">为激活的 URL 显示应用组件。管理从一个组件到另一个组件的导航</td></tr> <tr><td style="text-align:center;">RouterModule</td> <td style="text-align:center;">一个独立的 NgModule，用于提供所需的服务提供商，以及用来在应用视图之间进行导航的指令。</td></tr> <tr><td style="text-align:center;">Routes（路由数组）</td> <td style="text-align:center;">定义了一个路由数组，每一个都会把一个 URL 路径映射到一个组件。</td></tr> <tr><td style="text-align:center;">Route（路由）</td> <td style="text-align:center;">定义路由器该如何根据 URL 模式（pattern）来导航到组件。大多数路由都由路径和组件类构成。</td></tr> <tr><td style="text-align:center;">RouterOutlet（路由出口）</td> <td style="text-align:center;">该指令（）用来标记出路由器该在哪里显示视图。</td></tr> <tr><td style="text-align:center;">RouterLink（路由链接）</td> <td style="text-align:center;">这个指令把可点击的 HTML 元素绑定到某个路由。点击带有 routerLink 指令（绑定到字符串或链接参数数组）的元素时就会触发一次导航。</td></tr> <tr><td style="text-align:center;">RouterLinkActive（活动路由链接）</td> <td style="text-align:center;">当 HTML 元素上或元素内的routerLink变为激活或非激活状态时，该指令为这个 HTML 元素添加或移除 CSS 类。</td></tr> <tr><td style="text-align:center;">ActivatedRoute（激活的路由）</td> <td style="text-align:center;">为每个路由组件提供提供的一个服务，它包含特定于路由的信息，比如路由参数、静态数据、解析数据、全局查询参数和全局碎片（fragment）。</td></tr> <tr><td style="text-align:center;">RouterState（路由器状态）</td> <td style="text-align:center;">路由器的当前状态包含了一棵由程序中激活的路由构成的树。它包含一些用于遍历路由树的快捷方法。</td></tr> <tr><td style="text-align:center;">Link parameters array(链接参数数组)</td> <td style="text-align:center;">这个数组会被路由器解释成一个路由操作指南。你可以把一个RouterLink绑定到该数组，或者把它作为参数传给Router.navigate方法。</td></tr> <tr><td style="text-align:center;">Routing component(路由组件)</td> <td style="text-align:center;">一个带有RouterOutlet的 Angular 组件，它根据路由器的导航来显示相应的视图。</td></tr></tbody></table> <p>下图中涉及了路由的大部分知识，路由配置、传参方式、路由守卫等，这里只是配置，相对应的其他地方也要有相应的配置。</p> <p>路由配置图：</p> <p><img src="/vuebloger/img/post/20190609213716139.png" alt=""></p> <blockquote><p>关于路由传参，有三种方式</p></blockquote> <h3 id="url传参"><a href="#url传参" class="header-anchor">#</a> URL传参</h3> <p>1、进行路由配置见上图。</p> <p>2、配置好之后在routerLink上配置、传参，如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">routerLink</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./router-child2/{{id}}/{{name}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>路径传值<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3、在对应的组件中接收参数。</p> <p><img src="/vuebloger/img/post/20190609221913384.png" alt=""></p> <p>4、最终结果：</p> <p>点击传值后路径上将携带参数值http://localhost:4200/router/router-child2/123/张三</p> <p><img src="/vuebloger/img/post/20190609223011930.png" alt=""></p> <h3 id="路由配置传参"><a href="#路由配置传参" class="header-anchor">#</a> 路由配置传参</h3> <p>1、在路由配置中添加data属性和值就可以，见路由配置图。</p> <p>2、配置routerLink</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">routerLink</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./router-child3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>配置传值<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、在对应的组件接收参数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">pram</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>pram<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="4"><li>接收结果：</li></ol> <p>20190609224303738.jpg</p> <h3 id="查询参数传参"><a href="#查询参数传参" class="header-anchor">#</a> 查询参数传参</h3> <p>查询参数传参不需要配置路由</p> <ol><li>配置routerLink和queryParams</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">routerLink</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./router-child<span class="token punctuation">&quot;</span></span> <span class="token attr-name">[queryParams]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>{id:id}<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>查询参数传值<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>在对应组件接收参数</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span>queryParams<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token operator">=</span>params<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="3"><li>最终结果：</li></ol> <p>通过查询参数传值时，URL会携带参数值：http://localhost:4200/router/router-child?id=123456</p> <p><img src="/vuebloger/img/post/20190609225424319.png" alt=""></p> <p>关于路由参数传参的三种方式介绍结束。在这之中要注意的地方有：</p> <h3 id="routerlink写法"><a href="#routerlink写法" class="header-anchor">#</a> routerLink写法</h3> <p>一种是写在a标签里的，一种是非a标签里的</p> <p>a标签中可以使用这种方式：[routerLink]=&quot;['./router-child',id,name]&quot;</p> <p>非a标签中不能有中括号或者什么其他的符号，否则报错或者匹配失败：易出现的问题有：</p> <ol><li><code>[routerLink]=&quot;[./router-child]&quot;</code>该方式直接导致报错，routerLink不需要加中括号</li> <li><code>routerLink=&quot;[./router-child,id]&quot;</code>该方式导致路径不对，找不到匹配路径，routerLink的值不需要加中括号，添加中括号时，中括号会转码加到路径中导致匹配失败</li></ol> <h3 id="关于子路由"><a href="#关于子路由" class="header-anchor">#</a> 关于子路由</h3> <p>添加子路由时，routerLink的值需要在斜杠/的前面加.不加.时将直接到根路由寻找，如果匹配到相同的路径则显示相应的组件，匹配不到则匹配**路径 。</p> <h3 id="url中没有-号"><a href="#url中没有-号" class="header-anchor">#</a> URL中没有#号</h3> <p>对于URL中没有#号，这是因为路由器通过两种 LocationStrategy 提供商来支持不同的URL风格</p> <p>一种是：PathLocationStrategy - 默认的策略，支持“HTML 5 pushState”风格。</p> <p>另一种是：HashLocationStrategy - 支持“hash URL”风格。</p> <p>RouterModule.forRoot() 函数把 LocationStrategy 设置成了 PathLocationStrategy，使其成为了默认策略。</p> <h3 id="js路由导航"><a href="#js路由导航" class="header-anchor">#</a> js路由导航</h3> <p>路由导航除了在配置routerLink，还可以通过跳转的方式来进行，见以下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">(click)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>navigateTO()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>navigate跳转<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">navigateTO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;router/router-child3&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token string">&quot;xxxx&quot;</span><span class="token punctuation">,</span>name<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>路由配置里加路由守卫属性，然后编写相关守卫类，返回布尔类型，交给提供商providers，根据true和false决定是否允许进入和离开路由</p> <h2 id="指令"><a href="#指令" class="header-anchor">#</a> 指令</h2> <p>指令分为属性型指令和结构型指令。angular的内置指令有以下这些：</p> <p>ngIf ===== if判断，为真则显示该部分，为假则不显示
ngFor ==== for循环，循环输出或显示
ngSwitch == switch语句，符合条件则显示
ngClass === 设置css类
ngStyle ==== 设置样式</p> <p>对于Angular，通过命令生成的相关组件、指令、管道等，都会自动在根组件注册相关类，但如果是自己手动写相关的装饰器和类等，则需要手动去根组件注册这个类。</p> <h3 id="属性型指令"><a href="#属性型指令" class="header-anchor">#</a> 属性型指令</h3> <p>属性型指令用于改变一个 DOM 元素的外观或行为。</p> <p>步骤1：执行命令ng g directive 指令名称，生成的文件中可见@Directive()装饰器</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@<span class="token function">Directive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">'[appHighlightAndResetSize]'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>步骤2：注入宿主 DOM 元素的引用</p> <p>使用命令创建指令后生成的文件除了基本的@Directive()装饰器和类这些东西，空荡荡的宛如被掏空，此时要在构造函数中注入宿主 DOM 元素的引用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter">el<span class="token operator">:</span>ElementRef</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在注入宿主 DOM 元素的引用之后，如果不需要参数以及行为，则可以直接在构造函数的方法体中写相应的操作逻辑代码，下面的两个步骤也就不需要了。</p> <p>步骤3：定义输入属性(可选，如果需要传入参数则需要此步骤，反之不要)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token string">&quot;appHighlightAndResetSize&quot;</span><span class="token punctuation">)</span>
 colorAndSize<span class="token operator">:</span>any<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>步骤4：定义行为函数(可选，如果有行为事件则需要此步骤，反之不要)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> @<span class="token function">HostListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseenter&quot;</span><span class="token punctuation">)</span>
  <span class="token function">onMouseEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorAndSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span>nativeElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorAndSize<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span>nativeElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>colorAndSize<span class="token punctuation">.</span>size<span class="token operator">+</span><span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  @<span class="token function">HostListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseleave&quot;</span><span class="token punctuation">)</span>
  <span class="token function">onMouseLeave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span>nativeElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>el<span class="token punctuation">.</span>nativeElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这个@HostListener()装饰器是用来监听dom事件的，第一个参数是要监听的事件，第二个参数可选，是当该事件发生时传给处理方法的一组参数。</p> <p>结果演示如下,鼠标进入前：</p> <p><img src="/vuebloger/img/post/20190621204433980.jpg" alt=""></p> <p>鼠标进入后：</p> <p><img src="/vuebloger/img/post/20190621204543294.jpg" alt=""></p> <h3 id="结构型指令"><a href="#结构型指令" class="header-anchor">#</a> 结构型指令</h3> <p>于自定义结构型指令，我不知道是怎样的需求才会需要这样，通常情况下ngIf、ngFor、ngSwitch就够用了，但是对于学习来说，知道如何去自定义还是有必要的，由于不知道怎样的需求才会需要自定义结构型指令，因此这里直接拿官网的例子来了。</p> <p>步骤1：执行命令ng g directive 指令名称，生成的文件中可见@Directive()装饰器。当然也可以手动导入相应的装饰器和相关的类，并最后注册到根组件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>@<span class="token function">Directive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">'[appUnless]'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>步骤2：构造函数中注入模板类和视图容器类</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">private</span> templateRef<span class="token operator">:</span>TemplateRef<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token keyword">private</span> viewContainerRef<span class="token operator">:</span>ViewContainerRef</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>步骤3：导入@Input()属性装饰器并编写逻辑代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">private</span> hasView<span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">set</span> <span class="token function">appUnless</span><span class="token punctuation">(</span><span class="token parameter">condition<span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>condition <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef<span class="token punctuation">.</span><span class="token function">createEmbeddedView</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>templateRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hasView <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>condition <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hasView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>viewContainerRef<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hasView <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>使用结果：</p> <p><img src="/vuebloger/img/post/20190621204849667.jpg" alt=""></p> <p>结构型指令相对来说比较难，而且一般来说没必要自定义结构型指令，自定义结构型指令两个重要的类TemplateRef和ViewContainerRef，TemplateRef可以取得<code>&lt;ng-template&gt;</code>的内容，ViewContainerRef可以访问视图容器，通过这两个类就可以完成对页面DOM结构的更改</p> <h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <p>常见事件有：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>ngClick           <span class="token comment">//点击事件</span>
ngBlur          <span class="token comment">//失焦事件</span>
ngFocus         <span class="token comment">//获焦事件</span>
ngKeyup         <span class="token comment">//按键抬起事件</span>
ngMouseenter    <span class="token comment">//鼠标进入事件</span>
ngMouseleave     <span class="token comment">//鼠标离开事件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>angualr的事件过滤ngKeyup有一个事件过滤就是keyup.enter这个就是只在按了回车键之后才调用函数</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">#box</span> <span class="token attr-name">(keyup.enter)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onEnter(box.value)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="管道"><a href="#管道" class="header-anchor">#</a> 管道</h2> <p>对于管道其实也是一个常用的功能，就是将数据格式化或过滤展示到界面，通常的需求就是，从数据库读取过来的数据有时候格式不是日常生活中所见到的格式，比如日期；还有一些比如性别，存入数据库时候可能用0和1表示男女，但读出来的不可能将0和1直接展示给用户，这就需要将读出来的数据进行处理。Angualr就提供了这种功能，通过管道将数据格式化展示，使用方法就是在数据的后面添加管道操作符|然后写上对应管道，比如格式化日期：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token number">2017</span><span class="token operator">-</span><span class="token number">20</span><span class="token operator">-</span><span class="token number">10</span> <span class="token operator">|</span> date<span class="token operator">:</span><span class="token string">'yyyy-MM-dd'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>date就是日期管道，<code>yyyy-MM-dd</code>就是要格式化成样子，格式可以自己去定义。比较常用的内置管道有：</p> <p>date =========格式化日期
upperCase ====转大写
lowerCase ====转小写
json =========格式化json，不好用
通常情况下内置的管道不符合我们个人开发的需要，很多时候需要自定义，这里演示一个性别的管道</p> <p>步骤1：指令命令ng g pipe 管道名称
通过命令生成的文件中，初始代码为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Pipe({
  name: 'gender'
})
export class GenderPipe implements PipeTransform {
  transform(value: any, args?: any): any {
    return null;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>@Pipe()装饰器标记相邻的这个类是一个管道，管道类实现了 PipeTransform 接口的 transform 方法，该方法接受一个输入值和一些可选参数，并返回转换后的值。</p> <p>步骤2：在transform方法中编写处理逻辑</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> if(value==&quot;1&quot;){
      return &quot;男&quot;;
 }
 else if(value==&quot;0&quot;){
      return &quot;女&quot;;
 }
 else{
      return &quot;人妖&quot;;
 }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>步骤3：
如果数据源为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>person = [
    {name: &quot;张三&quot;,sex: &quot;1&quot;},
    {name: &quot;小明&quot;,sex: &quot;3&quot;},
    {name: &quot;小红&quot;,sex: &quot;0&quot;}
]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>使用：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;li *ngFor=&quot;let item of person&quot; &gt;{{item.sex | gender}}&lt;/li&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果过展示为：</p> <p><img src="/vuebloger/img/post/20190621205431272.jpg" alt=""></p> <p>关于管道需要注意的地方就是纯管道与非纯管道的区别：</p> <p>只有发生纯变才会调用该管道，这类管道称为纯管道，其余的管道成为非纯管道。 纯变指的是对基本数据类型（String、Number、Boolean）输入值的变更或者对对象引用（Array、Function、Object）的更改。 只要数据发生改变，均会触发非纯管道，但不一定会触发纯管道，需要考察数据变化的情形是否为纯变化。
这里换句话说就是像数组、对象等数据的改变，只有当引用地址的改变才会调用管道，如果只是数组、对象中的某一个值改变是不会调用管道的</p> <h2 id="服务与代理"><a href="#服务与代理" class="header-anchor">#</a> 服务与代理</h2> <h3 id="依赖注入、控制反转"><a href="#依赖注入、控制反转" class="header-anchor">#</a> 依赖注入、控制反转</h3> <p>在Angular中使用ng g service 服务名称命令之后生成的初始代码为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Injectable({
  providedIn: 'root'
})
export class HttpService {

  constructor() { }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>@Injectable()装饰器是每个 Angular 服务定义中的基本要素，它把与之相邻的类标记为可供注入的服务，在@Injectable()中有一个providedIn的元数据选项，它的值为root，表明这个类在顶层提供服务，这么定义之后就不需要将它添加到根模块的提供者中。这个元数据选项的值不一定非得为root，可以根据自己的需要修改，如果指定这个服务提供给哪个具体的类，那么需要将这个服务类注册到根模块的提供者providers中。</p> <p>这里演示一个简单的请求后端数据的服务，要了解更过参考这里的代理到后端服务器部分。
步骤1：必须先在根模块中导入HttpClientModule模块，否则在其它地方无法正确引包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>imports: [
    BrowserModule,
    // 导入HttpClientModule需要在BrowserModule模块的后面
    HttpClientModule,
],
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>步骤2：把 HttpClient 注入到应用类中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Injectable({
  providedIn: 'root'
})
export class HttpService {

  constructor(
    private httpService:HttpClient
  ) { }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这一步之后还不能获得服务器数据，因为没有配置代理，会产生跨域的问题，因此要使用HttpClient的相关API请求数据，需要先配置好代理</p> <p>步骤3：配置代理</p> <p>在项目的 src/ 目录下创建一个 proxy.conf.json 文件，和 package.json 放在同一目录下</p> <p>往这个新的代理配置文件中添加如下内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  &quot;/api&quot;: {
    &quot;target&quot;: &quot;http://localhost:3000&quot;,
    &quot;secure&quot;: false
  }
}

angular.json 中为 serve 目标添加 proxyConfig 选项：
&quot;architect&quot;: {
  &quot;serve&quot;: {
    &quot;builder&quot;: &quot;@angular-devkit/build-angular:dev-server&quot;,
    &quot;options&quot;: {
      &quot;browserTarget&quot;: &quot;AngularTest:build&quot;,

      &quot;proxyConfig&quot;: &quot;src/proxy.conf.json&quot;

    },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>也可以在package.json的命令后面直接以参数的形式配置</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;scripts&quot;: {
    &quot;ng&quot;: &quot;ng&quot;,

    &quot;start&quot;: &quot;ng serve --proxy-config proxy.config.json --port 4300&quot;,

    &quot;build&quot;: &quot;ng build&quot;,
    &quot;test&quot;: &quot;ng test&quot;,
    &quot;lint&quot;: &quot;ng lint&quot;,
    &quot;e2e&quot;: &quot;ng e2e&quot;
  },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>经过以上配置之后就可以使用HttpClient相关的API了，比如get请求</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> getServe():Observable&lt;any&gt;{
    return this.httpService.get(&quot;api/&quot;);
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>HttpClient的很多API返回的都是Observable流。搭一个node服务器对请求进行了响应，返回了一个测试数据</p> <p><img src="/vuebloger/img/post/20190621210200251.jpg" alt=""></p> <h2 id="foreach循环"><a href="#foreach循环" class="header-anchor">#</a> forEach循环</h2> <p>angularjs的forEach循环中会遇到一个问题：循环过程中如何跳出该循环？在JavaScript的for循环中，我们常常会用break或者用return结束循环，但是，在angular.forEach中，break和return根本不起作用，那么如何解决该问题呢？可以定义一个临时变量carrying ，首先给它一个执行的值true，当不满足条件时，给它赋值false，这样，虽然不能真正跳出angular.foreach循环，但是不会执行该循环中的事件，这样，同样也能提高循环效率：demo如下：</p> <p><img src="/vuebloger/img/post/20170511153407595.png" alt=""></p> <h2 id="表单验证"><a href="#表单验证" class="header-anchor">#</a> 表单验证</h2> <ol><li>有效性：</li></ol> <p>只要满足验证条件即为ng-valid，否则ng-invalid</p> <ol start="2"><li>是否被访问过：</li></ol> <p>当鼠标focus该input(未移出时未ug-untouched),移出之后马上变为ng-touched(不管数据有无变化)</p> <p>当改变它Model层值时，也会变为ng-touched。</p> <ol start="3"><li>控件值有无发生变化：</li></ol> <p>当鼠标focus在该input上，并且输入时，马上由ng-pristine 变为 ng-dirty（实时变化）</p> <p>但是改变它Model层值时，ng-pristine并不会改变，这一点与 &quot;是否被访问有所区别&quot;</p> <p>当用户更改数据后，为了让form组件保持为pristine，用户应该在点击按钮后，调用(#myForm=&quot;ngForm&quot;)myForm.reset().</p> <img src="/vuebloger/img/post/1064201-20170218001804441-2045692257.png" width="400" height="230"> <h2 id="rxjs操作符"><a href="#rxjs操作符" class="header-anchor">#</a> rxjs操作符</h2> <p>Reative Extension，源自于微软，火于NetFlix</p> <h3 id="rxjs初试"><a href="#rxjs初试" class="header-anchor">#</a> RxJS初试</h3> <p>在javascript中的试炼</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const height = document.getElementById('height');
const height$ = Rx.Observable.fromEvent(height, 'keyup');//$是约定俗称的命名方式,因为通过Rx.Observable已经将其转换成了流形式,其中含义是:将keyup事件转换成了Observable观察者
//既然是观察者,则可以订阅
height$.subscribe(val =&gt; console.log(val));//当输入的时候会输出事件的对象,获得值则使用val.target.value
// 输入是1,console打印的就是1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>RxJs的威力在于合并和转换流,实例如下</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>length<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>area<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> length <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> width <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> area <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'area'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> length$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> width$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//combineLatest表示如果监听的两个值有一个改变则会重新计算一遍</span>
<span class="token keyword">const</span> area$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">combineLatest</span><span class="token punctuation">(</span>length$<span class="token punctuation">,</span> width$<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span>w</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> l<span class="token operator">*</span>w<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用于将两个流合并成一个数据流</span>
area$<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> area<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>事件流:理解Rx的关键是要把任何变化想象成事件流</p> <h3 id="rxjs常见操作符"><a href="#rxjs常见操作符" class="header-anchor">#</a> RxJS常见操作符</h3> <h3 id="一、常见创建类操作符"><a href="#一、常见创建类操作符" class="header-anchor">#</a> 一、常见创建类操作符</h3> <ul><li>from:可以把数组、Promise、以及Iterable转化为Observable</li> <li>fromEvent:可以把事件转化为Observable</li> <li>of:接受一系列的数据，并把它们emit出去
如可以使用object$ = Rx.Observable.of({id:1,value:20})转化对象，使用的时候应该是object.value或object.value或object.value或object.id的方式</li></ul> <h3 id="二、observable的性质"><a href="#二、observable的性质" class="header-anchor">#</a> 二、Observable的性质</h3> <p>Observable有三种状态（即subscribe的三个参数）：next、error、complete</p> <ul><li>next是正常执行时的内容，subscribe的第一个参数</li> <li>error是当执行时出错，或监听了throw类型Observable时的执行内容，subscribe的第二个参数</li> <li>complete是Observable执行结束时的内容，subscribe的第三个参数</li></ul> <p>特殊的Observable：永不结束、Never、Empty（结束但不发射）、Throw</p> <p>Never类型Observable表示不会发生也永远不会结束，会在执行过程中导致，也可直接通过Rx.Observable.error('xxx')的方式声明，结果不会执行next、error、complete中任何一个阶段</p> <p>Empty类型Observable不会发射元素会直接结束，会在执行过程中导致，也可以通过Rx.Observable.empty()的方式声明，结果不会执行next、error，会执行complete阶段</p> <p>Throw类型Observable直接进入error状态，会在执行过程中抛出异常导致，也可以直接通过Rx.Observable.throw('xxx')的方式声明，结果只会执行error阶段</p> <h3 id="三、常见操作符"><a href="#三、常见操作符" class="header-anchor">#</a> 三、常见操作符</h3> <h3 id="_1-转换操作符"><a href="#_1-转换操作符" class="header-anchor">#</a> 1.转换操作符</h3> <blockquote><p>map</p></blockquote> <p>是mapTo、pluck操作符的根本</p> <p>举例将上述pluck操作符取target的value值转换成使用map操作符</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> width$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">ev</span><span class="token operator">=&gt;</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在angular中灵活使用Observable如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义一个发起网络请求获取Observable的方法</span>
<span class="token function">getQuote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>Observable<span class="token operator">&lt;</span>Quote<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
    		<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Quote<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 将请求返回的内容转换成json并转换成对应定义的Quote对象</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>mapTo</p></blockquote> <p>比如点击按钮事件或其他事件，我们不需要关注其值内容，只需要知道发生了即可，可以使用mapTo定义成一个固定值</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> width$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mapTo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//此时执行keyup事件，width$的值即为1</span>
<span class="token comment">//等同于如下</span>
<span class="token keyword">const</span> width$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//此时执行keyup事件，width$的值即为1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>pluck</p></blockquote> <h3 id="_2-工作操作符"><a href="#_2-工作操作符" class="header-anchor">#</a> 2.工作操作符</h3> <p>do操作符用于在流处理期间对数据进行操作，实例如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">do</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'val is :'</span><span class="token operator">+</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-变换类操作符"><a href="#_3-变换类操作符" class="header-anchor">#</a> 3.变换类操作符</h3> <p><code>scan(()=&gt;{})</code>接受一个函数，参数1是上次处理后的结果，参数2是新值内容。实例代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> val<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//表示是偶数才放行</span>
<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//表示结果累加操作</span>
<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果</span>
<span class="token comment">// 0[0+0]</span>
<span class="token comment">// 2[上次结果0+新值2]</span>
<span class="token comment">// 6[上次结果2+新值4]</span>
<span class="token comment">// 12[上次结果6+新值6]</span>
<span class="token comment">//complete执行内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_4-数学统计类操作符"><a href="#_4-数学统计类操作符" class="header-anchor">#</a> 4.数学统计类操作符</h3> <p>reduce是将流计算结果做统一的最后处理并发射，实例代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> val<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//表示是偶数才放行</span>
<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> x<span class="token operator">+</span>y<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果</span>
<span class="token comment">// 12[只发射最终值]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_5-过滤类操作符"><a href="#_5-过滤类操作符" class="header-anchor">#</a> 5.过滤类操作符</h3> <ol><li><p>take(num)表示取流中前num个</p></li> <li><p>filter(()=&gt;{})表示对流处理的放行判断，如果满足条件则放行，不满足条件则不放行</p></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> val<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//表示是偶数才放行</span>
<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//订阅后会输出0 2 4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="3"><li><p>first()表示取流第一个，相当于take(1)</p></li> <li><p>last()表示取流最后一个</p></li> <li><p>skip(num)表示跳过前num个</p></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> val<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//表示是偶数才放行</span>
<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//订阅后会输出4 6 8 ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_6-时间类操作符"><a href="#_6-时间类操作符" class="header-anchor">#</a> 6.时间类操作符</h3> <p>Interval实例代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> interval$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
interval$<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>
    <span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token comment">//next状态</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token comment">// error状态</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am complete'</span><span class="token punctuation">)</span> <span class="token comment">// complete状态</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果:interval()是做循环用的,每次发射出来的是索引，故生成的是0/1/2/3/4....，又由于take表示取前多少个，故take(3)表示取前3个</span>
<span class="token comment">// 0</span>
<span class="token comment">// 1</span>
<span class="token comment">// 2</span>
<span class="token comment">// &quot;I am complete&quot; // complete状态执行的内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Timer实例代码</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> timer$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//表示100毫秒之后启动，之后以200毫秒的频率一直发送</span>
<span class="token comment">// 故timer比Interval多出起始延迟时间的设置</span>
timer$<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//输出结果</span>
<span class="token comment">// 0 --运行后100毫秒之后输出</span>
<span class="token comment">// 1 --输出0后200毫秒之后输出</span>
<span class="token comment">// 2 --输出1后200毫秒之后输出</span>
<span class="token comment">// 3 --...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_7-过滤类操作符"><a href="#_7-过滤类操作符" class="header-anchor">#</a> 7.过滤类操作符</h3> <p>debounce、debouceTime、distinct、distinctUtilChanged</p> <p>debounce：比debounceTime灵活，debounceTime只能设定固定的毫秒间隔，而debounce可以通过接受的function设定毫秒间隔</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> length$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span><span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">debounce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//可以自行修改function返回内容从而决定滤掉的内容</span>
<span class="token comment">//上述代码含义是：过滤掉300毫秒以内keyup事件监听内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>debouceTime(num)：时间滤波器，表示只关注大于等于num毫秒间隔的事件内容</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> length$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span><span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">debounceTime</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//上述代码含义是：过滤掉300毫秒以内keyup事件监听内容</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/vuebloger/img/post/20190602185826234.png" alt=""></p> <p>distinct：整个序列中，过滤一样的，保留不一样的(要求序列中没有重复的元素)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> length$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span><span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//过滤掉整个流中重复的元素</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>distinctUtilChanged：只跟前一个元素比，过滤一样的，保留不一样的</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const length$ = Rx.Observable.fromEvent(length,'keyup').pluck('target','value').distinctUtilChanged();//过滤掉流中前一个重复的元素
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/vuebloger/img/post/20190602185839813.png" alt=""></p> <h3 id="_9-合并类操作符"><a href="#_9-合并类操作符" class="header-anchor">#</a> 9.合并类操作符</h3> <p>merge、concat、startWith、combineLatest、withLatestFrom、zip</p> <ol><li><p>merge：在整个序列中按照流运行状态进行合并</p></li> <li><p>concat：在整个序列中将流前后拼接（如拼接的第一个流是无尽流，则永远只会输出第一个流内容，因为第二个流永远不会发生，第一个流没有执行完）</p></li> <li><p>startWith：设定流发射的初始值</p></li></ol> <p><img src="/vuebloger/img/post/20190602185848388.png" alt=""></p> <ol start="4"><li><p>通过combineLatest可以对两个流进行对应的处理操作，实例请参照开头计算面积</p></li> <li><p>zip有对齐的感觉，将两个流对应位置的元素进行处理操作，慢的流决定最终zip生成流的速度</p></li> <li><p>withLatestFrom当基准流改变时才会进行流处理，使用方式是基准流.withLatestFrom(其他流)，如下</p></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> merged$ <span class="token operator">=</span> length$<span class="token punctuation">.</span><span class="token function">withLatestFrom</span><span class="token punctuation">(</span>width$<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/vuebloger/img/post/20190602185857966.png" alt=""></p> <p>区别：zip有对齐的特性，withLatestFrom是以源事件流为基准，combineLatest是无论任何一个流发生改变时都会处理</p> <h3 id="四、应用实例"><a href="#四、应用实例" class="header-anchor">#</a> 四、应用实例</h3> <p>自行给rxjs中Observable添加debug方法</p> <p>通过Observable的原型中定义debug方法返回Observable对象</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Observable<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/Observable'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>environment<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../environment/environment'</span>
<span class="token comment">// typescript用于解决自行添加对象属性的报错问题</span>
declare module <span class="token string">'rxjs/Observable'</span> <span class="token punctuation">{</span>
    <span class="token keyword">interface</span> <span class="token class-name">Observable</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">debug</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 给Observable添加debug方法</span>
<span class="token class-name">Observable</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">debug</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span>string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>environment<span class="token punctuation">.</span>production<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span>next<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>environment<span class="token punctuation">.</span>production<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'ERROR&gt;&gt;'</span><span class="token punctuation">,</span>message<span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>environment<span class="token punctuation">.</span>production<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Completed -'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//使用时直接在声明Observable期间添加即可以查看对应Observable对象内容,如</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">'Test:'</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Quote<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//在subscribe监听后的会输出对应的log</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="angular使用redux"><a href="#angular使用redux" class="header-anchor">#</a> angular使用redux</h2> <p>第一种状态管理：我们在组件中管理。在组件中可以声明一个数组，这个数组作为todo的内存存储。每次操作比如新增（addTodo）或切换状态（toggleTodo）首先调用服务中的方法，然后手动操作数组来更新状态。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
  desc<span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  todos <span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//在组件中建立一个内存TodoList数组</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'todoService'</span><span class="token punctuation">)</span> <span class="token keyword">private</span> service<span class="token punctuation">,</span>
    <span class="token keyword">private</span> route<span class="token operator">:</span> ActivatedRoute<span class="token punctuation">,</span>
    <span class="token keyword">private</span> router<span class="token operator">:</span> Router<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">params<span class="token operator">:</span> Params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> filter <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token string">'filter'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">filterTodos</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service
      <span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>desc<span class="token punctuation">)</span> <span class="token comment">//通过服务新增数据到服务器数据库</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//更新todos的状态</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用了可改变的数组操作方式</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">toggleTodo</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token operator">:</span> Todo</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service
      <span class="token punctuation">.</span><span class="token function">toggleTodo</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token comment">//通过服务更新数据到服务器数据库</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//更新todos的状态</span>
        <span class="token keyword">const</span> i <span class="token operator">=</span> todos<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        todos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>completed <span class="token operator">=</span> todo<span class="token punctuation">.</span>completed<span class="token punctuation">;</span> <span class="token comment">//使用了可改变的数组操作方式</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>第二种方式，我们在服务中做类似的事情。在服务中定义一个内存存储（dataStore），然后同样是在更新服务器数据后手动更新内存存储。这个版本当中我们使用了RxJS，但大体逻辑是差不多的。当然使用Rx的好处比较明显，组件只需访问todos属性方法即可，组件内的逻辑会比较简单。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoService</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> api_url <span class="token operator">=</span> <span class="token string">'http://localhost:3000/todos'</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> userId<span class="token operator">:</span> string<span class="token punctuation">;</span>
  <span class="token keyword">private</span> _todos<span class="token operator">:</span> BehaviorSubject<span class="token punctuation">;</span>
  <span class="token keyword">private</span> dataStore<span class="token operator">:</span> <span class="token punctuation">{</span>  <span class="token comment">// 我们自己实现的内存数据存储</span>
    todos<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> http<span class="token operator">:</span> Http<span class="token punctuation">,</span> @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'auth'</span><span class="token punctuation">)</span> <span class="token keyword">private</span> authService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>authService<span class="token punctuation">.</span><span class="token function">getAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">auth</span> <span class="token operator">=&gt;</span> auth<span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">auth</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> auth<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dataStore <span class="token operator">=</span> <span class="token punctuation">{</span> todos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_todos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BehaviorSubject</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">get</span> <span class="token function">todos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_todos<span class="token punctuation">.</span><span class="token function">asObservable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// POST /todos</span>
  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">desc<span class="token operator">:</span>string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> todoToAdd <span class="token operator">=</span> <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token constant">UUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      desc<span class="token operator">:</span> desc<span class="token punctuation">,</span>
      completed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      userId<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userId
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>http
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>todoToAdd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Todo<span class="token punctuation">)</span> <span class="token comment">//通过服务新增数据到服务器数据库</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//更新内存存储todos的状态</span>
        <span class="token comment">//使用了不可改变的数组操作方式</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">.</span>todos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">.</span>todos<span class="token punctuation">,</span> todo<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//推送给订阅者新的内存存储数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_todos<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">)</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">toggleTodo</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token operator">:</span> Todo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>todo<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> updatedTodo <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> todo<span class="token punctuation">,</span> <span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>http
      <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//通过服务更新数据到服务器数据库</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//更新内存存储todos的状态</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">.</span>todos <span class="token operator">=</span> <span class="token punctuation">[</span>
          <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>
          updatedTodo<span class="token punctuation">,</span>
          <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//使用了不可改变的数组操作方式</span>
        <span class="token comment">//推送给订阅者新的内存存储数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_todos<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataStore<span class="token punctuation">)</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><p>当然还有很多方式，比如服务中维护一部分，组件中维护一部分；再比如说有的同学可能使用localStorage做存储，每次读来写去等等。Angular 1.x永久的改变了JQuery类型的web开发，使得我们可以像写手机客户端App一样来鞋前端代码。Redux也一样改变了状态管理的写法，Redux其实不仅仅是一个类库，更是一种设计模式。而且在Angular2 中由于有RxJS，你会发现我们甚至比在React中使用时更方便更强大。</p> <p>ngrx是一套利用RxJS的类库，其中的 @ngrx/store (https://github.com/ngrx/store) 就是基于Redux规范制定的Angular2框架。</p> <h3 id="简单内存版"><a href="#简单内存版" class="header-anchor">#</a> 简单内存版</h3> <p>当然第一步是安装 npm install @ngrx/core @ngrx/store --save。然后需要在你想要使用的Module里面引入store，我推荐在根模块 AppModule或CoreModule（把只在应用中加载一次的全局性东东单独放到一个Module中然后在AppModule引入） 引入这个包，因为Store是整个应用的状态树。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import { ModuleWithProviders, NgModule, Optional, SkipSelf } from '@angular/core';
import { AuthService } from './auth.service';
import { UserService } from './user.service';
import { AuthGuardService } from './auth-guard.service';

import { HttpModule, JsonpModule } from '@angular/http';
import { StoreModule } from '@ngrx/store';
import { todoReducer, todoFilterReducer } from '../reducers/todo.reducer';
import { authReducer } from '../reducers/auth.reducer';

@NgModule({
  imports:[
    HttpModule
    StoreModule.provideStore({
      todos: todoReducer,
      todoFilter: todoFilterReducer
    })
  ],
  providers: [
    AuthService,
    UserService,
    AuthGuardService
    ]
})
export class CoreModule {
  constructor (@Optional() @SkipSelf() parentModule: CoreModule) {
    if (parentModule) {
      throw new Error(
        'CoreModule is already loaded. Import it in the AppModule only');
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>我们看到StoreModule提供了一个provideStore方法，在这个方法中我们声明了一个 { todos: todoReducer, todoFilter: todoFilterReducer }对象，这个就是Store。</p> <p>那么可以看到我们定义了两个Reducer：todoReducer和todoFilterReducer。在看代码之前，我们来思考一下这个流程，所谓Reducer其实就是接收两个参数：之前的状态和要采取的动作，然后返回新的状态。可能动作更好想一些，先看看有什么动作吧：</p> <ul><li>新增一个Todo</li> <li>删除一个Todo</li> <li>更改Todo的完成状态</li> <li>全部反转Todo的完成状态</li> <li>清除已完成的Todo</li> <li>筛选全部Todo</li> <li>筛选未完成的Todo</li> <li>筛选已完成的Todo</li></ul> <p>后面的三个都属于筛选，并未改动数据本身，也不用提交后台服务，只需要对内存数据做简单筛选即可。前面几个都需要不光改变内存数据也需要改变服务器数据。</p> <p>这里我们先尝试着写一下前面五个动作对应的Reducer，按前面定义的就叫todoReducer写个骨架：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">todoReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token punctuation">,</span> payload<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>第一个参数是state，就像我们在组件或服务中自己维护了一个内存数组一样，我们的Todo状态其实也是一个数组，我们还赋了一个空数组的初始值（避免出现undefined错误）。</p> <p>第二个参数是一个有type和payload两个属性的对象，其实就是Action。也就是说我们其实可以不用定义Action，直接给出构造的对象形式即可。内部的话其实reducer就是一个大的switch语句，根据不同的Action类型决定返回什么样的状态。默认状态下我们直接将之前状态返回即可。Reducer就是这么单纯的一个函数。</p> <p>现在我们来考虑其中一个动作，增加一个Todo，我们需要发送一个Action，这个Action的type是 ’ADD_TODO’ ，payload就是新增加的这个Todo。</p> <p>逻辑其实就是列表数组增加一个元素，用数组的push方法直接做是不是就行了呢？不行，因为Redux的约定是必须返回一个新状态，而不是更新原来的状态。而push方法其实是更新原来的数组，而我们需要返回一个新的数组。感谢ES7的Object Spread操作符，它可以让我们非常方便的返回一个新的数组。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>export const todoReducer = (state = [], {type, payload}) =&gt; {
  switch (type) {
    case 'ADD_TODO':
      return [
          ...state,
          action.payload
          ];
    default:
      return state;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>现在我们已经有了一个可以处理 ADD_TODO 类型的Reducer。注意服务器数据处理的逻辑是服务（Service）的职责，Reducer不负责那部分。后面我们会处理服务器的数据更新的。</p> <p>在TodoComponent中去引入Store并且在适当的时候dispatch ‘ADD_TODO’这个Action就OK了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoComponent</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  todos <span class="token operator">:</span> Observable<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> store$<span class="token operator">:</span> Store</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>todos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">desc<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> todoToAdd <span class="token operator">=</span> <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
      desc<span class="token operator">:</span> desc<span class="token punctuation">,</span>
      completed<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token string">'ADD_TODO'</span><span class="token punctuation">,</span> todoToAdd<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>利用Angular提供的依赖性注入（DI），我们可以非常方便的在构造函数中注入Store。由于Angular2以后对于RxJS的内建支持以及 @ngrx/store 本身也是基于RxJS来构造的，我们完全不用Redux的注册订阅者等行为，访问todos这个状态，只需要写成 this.store$.select('todos')就可以了。这个store后面有个 $ 符号是表示这是一个流（Stream，只是写法上的惯例），也就是Observable。然后在addTodo方法中把action发送出去就完事了，当然这个方法是在按Enter键时触发的。</p> <p>Angular2中对于Observable类型的变量提供了一个Async Pipe，就是 todos | async ，我们连在OnDestroy中取消订阅都不用做了。</p> <p>下面我们把reducer的其他部分补全吧。除了处理todoReducer中其他的swtich分支，我们为其添加了强类型，既然是在Angular2中使用TypeScript开发，我们还是希望享受强类型带来的各种便利之处。另外总是对于Action的Type定义了一系列常量。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import { Reducer, Action } from '@ngrx/store';
import { Todo } from '../domain/entities';
import {
  ADD_TODO,
  REMOVE_TODO,
  TOGGLE_TODO,
  TOGGLE_ALL,
  CLEAR_COMPLETED,
  FETCH_FROM_API,
  VisibilityFilters
} from '../actions/todo.action';

export const todoReducer = (state: Todo[] =[], action: Action) =&gt; {
  switch (action.type) {
    case ADD_TODO:
      return [
          ...state,
          action.payload
          ];
    case REMOVE_TODO:
      return state.filter(todo =&gt; todo.id !== action.payload.id);
    case TOGGLE_TODO:
      return state.map(todo =&gt; {
        if(todo.id !== action.payload.id){
          return todo;
        }
        return Object.assign({}, todo, {completed: !todo.completed});
      });
    case TOGGLE_ALL:
      return state.map(todo =&gt; {
        return Object.assign({}, todo, {completed: !todo.completed});
      });
    case CLEAR_COMPLETED:
      return state.filter(todo =&gt; !todo.completed);
    case FETCH_FROM_API:
      return [
        ...action.payload
      ];
    default:
      return state;
  }
}

export const todoFilterReducer = (state = (todo: Todo) =&gt; todo, action: Action) =&gt; {
  switch (action.type) {
    case VisibilityFilters.SHOW_ALL:
      return todo =&gt; todo;
    case VisibilityFilters.SHOW_ACTIVE:
      return todo =&gt; !todo.completed;
    case VisibilityFilters.SHOW_COMPLETED:
      return todo =&gt; todo.completed;
    default:
      return state;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>上面的todoReducer看起来倒还是很正常，这个todoFilterReducer却形迹十分可疑，它的state看上去是个函数。是的，你的判断是对的，的确是函数。</p> <p>为什么我们要这么设计呢？原因是这几个过滤器，其实只是对内存数组进行筛选操作，那么就可以通过 arr.filter(callback[, thisArg]) 来进行筛选。数组的filter方法的含义是对于数组中每一个元素通过callback的测试，然后返回值组成一个新数组。所以这个Reducer中我们的状态其实是不同条件的测试函数，就是那个callback。</p> <p>好，我们一起把这个没有后台API的版本先完成了吧，要完成的其他部分都很简单，比如toggle、remove什么的，因为只是调用store的dispatch方法把Action发送出去即可。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoComponent</span> <span class="token punctuation">{</span>

  todos <span class="token operator">:</span> Observable<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">private</span> service<span class="token operator">:</span> TodoService<span class="token punctuation">,</span>
    <span class="token keyword">private</span> route<span class="token operator">:</span> ActivatedRoute<span class="token punctuation">,</span>
    <span class="token keyword">private</span> store$<span class="token operator">:</span> Store</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> fetchData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">startWith</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> filterData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todoFilter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>todos <span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">combineLatest</span><span class="token punctuation">(</span>
        fetchData$<span class="token punctuation">,</span>
        filterData$<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token parameter">todos<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> filter<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token function">ngInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'filter'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> filter <span class="token operator">=</span> value <span class="token keyword">as</span> string<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> filter<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">desc<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> todoToAdd <span class="token operator">=</span> <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token constant">UUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      desc<span class="token operator">:</span> desc<span class="token punctuation">,</span>
      completed<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token constant">ADD_TODO</span><span class="token punctuation">,</span>
      payload<span class="token operator">:</span> todoToAdd
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">toggleTodo</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token operator">:</span> Todo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> updatedTodo <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> todo<span class="token punctuation">,</span> <span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token constant">TOGGLE_TODO</span><span class="token punctuation">,</span>
      payload<span class="token operator">:</span> updatedTodo
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">removeTodo</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token operator">:</span> Todo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token constant">REMOVE_TODO</span><span class="token punctuation">,</span>
      payload<span class="token operator">:</span> todo
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">toggleAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token constant">TOGGLE_ALL</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">clearCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token constant">CLEAR_COMPLETED</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>我们一起看看过滤器部分怎么处理我们实现的，我们知道目前有两个和todo有关的Reducer：todoReducer和todoFilterReducer。这两个应该是配合来影响状态的，我们不可以在没有任何一方的情况下独立返回正常的状态。怎么理解呢？打个比方吧，我们添加了几个Todo之后，这些Todo肯定满足某个过滤器的条件测试，而不可能存在一个Todo在任何一个过滤器中都不满足其条件。</p> <p>那么如何配合处理这两个状态流呢（在@ngrx/store中，它们都是流）？重新描述一下对这两个流的要求，为方便起见，我们叫todos流和filter流。我们想要这样的一个合并流，这个合并流的数据来自于todos流和filter流。而且合并流的每个数据都来自于一对最新的todos流数据和filter流数据，当然存在一种情况：一个流产生了新数据，但另一个没有。这种情况下，我们会使用新产生的这个数据和另一个流中之前最新的那个配对产生合并流的数据。</p> <p>这在Rx世界太简单了，combineLatest操作符干的就是这样一件事。于是我们看到下面这段代码：我们合并了todos流和filter流，而且在以它们各自的最新数据为参数的一个函数产生了新的合并流的数据 todos.filter(filter)。稍微解释一下，todos流中的数据就是todo数组，我们在todoReducer中就是这样定义的，而filter流中的数据是一个函数，那么我们其实就是使用从todos流中的最新数组，调用todos.filter方法然后把filter流中的最新的函数当成todos.filter的参数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fetchData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startWith</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> filterData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todoFilter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>todos <span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">combineLatest</span><span class="token punctuation">(</span>
  fetchData$<span class="token punctuation">,</span>
  filterData$<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">todos<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> filter<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>还有一处需要解释并且优化的代码位于ngInit中的那段，我们把它分拆出来列在下面。我们在Todo里面实现过滤器时使用的是Angular2的路由参数，也就是 todo/:filter 这种形式（我们定义在 todo-routing.module.ts 中了 ），比如如果过滤器是 ALL，那么这个表现形式就是 todo/ALL。下面代码中的 this.route.params.pluck('filter') 就是取得这个filter路由参数的值。然后我们dispatch了要进行过滤的action。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">ngInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'filter'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> filter <span class="token operator">=</span> value <span class="token keyword">as</span> string<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> filter<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>虽说现在的形式已经可以正常工作了，但总觉得这个路由参数的获取单独放在这里有点别扭，因为逻辑上这个路由参数流和filter流是有先后顺序的，而且后者依赖前者，但这种逻辑关系没有体现出来。</p> <p>嗯，来优化一下，Rx的一个优点就是可以把一系列操作串（chain）起来。从时间序列上看这个路由参数的获取是先发生的，然后获取到这个参数filter流才会有作用，那么我们优化的点就在于怎么样把这个路由参数流和filter流串起来。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> filterData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'filter'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">do</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filter <span class="token operator">=</span> value <span class="token keyword">as</span> string<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> filter<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todoFilter'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上面的代码把原来独立的两个流串了起来，逻辑关系有两层：</p> <p>首先时间顺序要保证，也就是说路由参数的先有数据后 this.store$.select('todoFilter') 才可以工作。 do 相当于在语句中间临时subscribe一下，我们在此时发送了Action。</p> <p>再有我们并不关心路由参数流的数据，我们只是关心它什么时候有数据，所以我们在 flatMap 语句中把参数写成了 _。</p> <p>到这里，我们的内存版redux化的Angular Todo应用就搞定了。</p> <h3 id="时光旅行调试器"><a href="#时光旅行调试器" class="header-anchor">#</a> 时光旅行调试器</h3> <p>Redux TimeMachine Debugger</p> <p>介绍HTTP后台版本之前，我们要隆重推出大名鼎鼎的Redux时光旅行调试器。首先需要下载Redux DevTools for Chrome，在Chrome商店中搜索 Redux DevTools即可。</p> <p><img src="/vuebloger/img/post/image_1b4oekl1o18829t616cv1jd7u3jm.png" alt=""></p> <p>安装好插件之后，我们需要在为 @ngrx/store 安装一个dev-tools的npm包： npm install @ngrx/store-devtools --save</p> <p>然后在AppModule或CoreModule的Module元数据中加上 StoreDevtoolsModule.instrumentOnlyWithExtension()</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> StoreDevtoolsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store-devtools'</span><span class="token punctuation">;</span>
@<span class="token function">NgModule</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token operator">...</span>
    StoreModule<span class="token punctuation">.</span><span class="token function">provideStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      todos<span class="token operator">:</span> todoReducer<span class="token punctuation">,</span>
      todoFilter<span class="token operator">:</span> todoFilterReducer
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    StoreDevtoolsModule<span class="token punctuation">.</span><span class="token function">instrumentOnlyWithExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>这样就配置好了，让我们先看看它长什么样吧，打开浏览器进入todo应用。对了，别忘打开chrome的开发者工具，你应该可以看到Redux那个Tab，切换过去就好</p> <p><img src="/vuebloger/img/post/image_1b4oqcl7d1uvh13l93isum8tf213.png" alt=""></p> <h3 id="带http后台版本"><a href="#带http后台版本" class="header-anchor">#</a> 带HTTP后台版本</h3> <p>我们用json-server可以快速建立一套REST的Web API。json-server只需要我们提供一个json数据样本就可以完成Web API了，我们的样本json是这样的：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;todos&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;6e628423-be05-204f-f075-527cc1bb10d8&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;have lunch&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;completed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;40ab7081-cab9-5900-4048-f4ea905afd2f&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;take a break&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;completed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;6ae06293-23d4-c0ca-ee5b-880365dbd48b&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;having fun&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;completed&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e54f5e86-a781-acd5-1d16-8b878c7cba5d&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;desc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;have a test&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;completed&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>现在我们再来梳理一下如果使用后台版本的逻辑，我们的现在的数据源其实是来自于服务器API的，每次更改Todo后也都要提交到服务器。这个联动关系比较强，也就是说必须要服务器返回成功数据后才能进行内存状态的改变。这种情况下我们似乎应该把某些dispatch的动作放到service中。拿addTodo举个例子，我们post到服务器一个新增todo的请求后在发送了dispatch ADD_TODO的消息，这时内存状态就会根据这个进行状态的迁转。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Http<span class="token punctuation">,</span> Headers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/http'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">UUID</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angular2-uuid'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/Observable'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Todo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../domain/entities'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">ADD_TODO</span><span class="token punctuation">,</span>
  <span class="token constant">TOGGLE_TODO</span><span class="token punctuation">,</span>
  <span class="token constant">REMOVE_TODO</span><span class="token punctuation">,</span>
  <span class="token constant">TOGGLE_ALL</span><span class="token punctuation">,</span>
  <span class="token constant">CLEAR_COMPLETED</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../actions/todo.action'</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoService</span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> api_url <span class="token operator">=</span> <span class="token string">'http://localhost:3000/todos'</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> userId<span class="token operator">:</span> string<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">private</span> http<span class="token operator">:</span> Http<span class="token punctuation">,</span>
    @<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token string">'auth'</span><span class="token punctuation">)</span> <span class="token keyword">private</span> authService<span class="token punctuation">,</span>
    <span class="token keyword">private</span> store$<span class="token operator">:</span> Store
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>authService<span class="token punctuation">.</span><span class="token function">getAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">auth</span> <span class="token operator">=&gt;</span> auth<span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">auth</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userId <span class="token operator">=</span> auth<span class="token punctuation">.</span>user<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// POST /todos</span>
  <span class="token function">addTodo</span><span class="token punctuation">(</span>desc<span class="token operator">:</span>string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> todoToAdd <span class="token operator">=</span> <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token constant">UUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      desc<span class="token operator">:</span> desc<span class="token punctuation">,</span>
      completed<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>http
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>todoToAdd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Todo<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token constant">ADD_TODO</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> todo<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// PATCH /todos/:id</span>
  <span class="token function">toggleTodo</span><span class="token punctuation">(</span>todo<span class="token operator">:</span> Todo<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>todo<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> updatedTodo <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> todo<span class="token punctuation">,</span> <span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>http
      <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">mapTo</span><span class="token punctuation">(</span>updatedTodo<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token constant">TOGGLE_TODO</span><span class="token punctuation">,</span>
          payload<span class="token operator">:</span> updatedTodo
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// DELETE /todos/:id</span>
  <span class="token function">removeTodo</span><span class="token punctuation">(</span>todo<span class="token operator">:</span> Todo<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>todo<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>http
      <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">mapTo</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> todo<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token constant">REMOVE_TODO</span><span class="token punctuation">,</span>
          payload<span class="token operator">:</span> todo
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// GET /todos</span>
  <span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?userId=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>userId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">toggleAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">todos</span> <span class="token operator">=&gt;</span> Observable<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>todos<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>todo<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> updatedTodo <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> todo<span class="token punctuation">,</span> <span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http
          <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token constant">TOGGLE_ALL</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">clearCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">todos</span> <span class="token operator">=&gt;</span> Observable<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> t<span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">todo</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>api_url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>todo<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>http
          <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>headers<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token constant">CLEAR_COMPLETED</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br></div></div><p>增删改这些操作应该都没有问题了，但此时存在一个新问题：内存状态如何可以通过服务器得到初始值呢？原来的内存版本中，我们初始化就是一个空数组，但现在不一样了，你可能会有上次已经创建好的todo需要在一开始显示出来。</p> <p>如何改变那个初始值呢？但如果换个角度想，现在引入了服务器之后，我们从服务器取数据完全可以定义一个新的Action，比如叫 FETCH_FROM_API 吧。我们现在只需要从服务器取得新数据后发送这个Action，应用状态就会根据取得的最新服务器数据刷新了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ActivatedRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TodoService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./todo.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Todo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../domain/entities'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">UUID</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'angular2-uuid'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@ngrx/store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">FETCH_FROM_API</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../actions/todo.action'</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rxjs/Observable'</span><span class="token punctuation">;</span>

@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  templateUrl<span class="token operator">:</span> <span class="token string">'./todo.component.html'</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./todo.component.css'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoComponent</span> <span class="token punctuation">{</span>

  todos <span class="token operator">:</span> Observable<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">private</span> service<span class="token operator">:</span> TodoService<span class="token punctuation">,</span>
    <span class="token keyword">private</span> route<span class="token operator">:</span> ActivatedRoute<span class="token punctuation">,</span>
    <span class="token keyword">private</span> store$<span class="token operator">:</span> Store</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> fetchData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">todos</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token constant">FETCH_FROM_API</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> todos<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">startWith</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> filterData$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'filter'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">do</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> filter <span class="token operator">=</span> value <span class="token keyword">as</span> string<span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> filter<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store$<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'todoFilter'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>todos <span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">combineLatest</span><span class="token punctuation">(</span>
        fetchData$<span class="token punctuation">,</span>
        filterData$<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token parameter">todos<span class="token operator">:</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> filter<span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

  <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token parameter">desc<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">addTodo</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">toggleTodo</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token operator">:</span> Todo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">toggleTodo</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">removeTodo</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token operator">:</span> Todo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">removeTodo</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">toggleAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">toggleAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">clearCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">clearCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>现在服务器版本算是可以工作了，打开浏览器试一试吧。现在我们的代码非常清晰：组件中不处理事务逻辑，只负责调用服务的方法。服务中只负责提交数据到服务器和发送动作。所有的应用状态都是通过Redux处理的。</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">4/2/2021, 5:19:50 PM</span></div></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/vuebloger/assets/js/app.7c1f8ffb.js" defer></script><script src="/vuebloger/assets/js/7.57d3d60e.js" defer></script><script src="/vuebloger/assets/js/1.45114b1b.js" defer></script><script src="/vuebloger/assets/js/35.41383072.js" defer></script><script src="/vuebloger/assets/js/29.0b036396.js" defer></script>
  </body>
</html>
