<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端二进制 | 邹先生博客记录</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/vuebloger/img/logo.jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="">
    
    <link rel="preload" href="/vuebloger/assets/css/0.styles.8192970a.css" as="style"><link rel="preload" href="/vuebloger/assets/js/app.5081c8a7.js" as="script"><link rel="preload" href="/vuebloger/assets/js/5.82db9be2.js" as="script"><link rel="preload" href="/vuebloger/assets/js/1.b1b3586e.js" as="script"><link rel="preload" href="/vuebloger/assets/js/61.38e0dcbe.js" as="script"><link rel="preload" href="/vuebloger/assets/js/49.4796a25a.js" as="script"><link rel="prefetch" href="/vuebloger/assets/js/10.9366c20a.js"><link rel="prefetch" href="/vuebloger/assets/js/100.f9c81c91.js"><link rel="prefetch" href="/vuebloger/assets/js/101.7126df67.js"><link rel="prefetch" href="/vuebloger/assets/js/102.7b0b5c91.js"><link rel="prefetch" href="/vuebloger/assets/js/103.3a347b66.js"><link rel="prefetch" href="/vuebloger/assets/js/104.41ae4a00.js"><link rel="prefetch" href="/vuebloger/assets/js/105.71694be9.js"><link rel="prefetch" href="/vuebloger/assets/js/106.50c1d88f.js"><link rel="prefetch" href="/vuebloger/assets/js/107.9d8f25c4.js"><link rel="prefetch" href="/vuebloger/assets/js/108.8328d523.js"><link rel="prefetch" href="/vuebloger/assets/js/109.7fa70b17.js"><link rel="prefetch" href="/vuebloger/assets/js/11.628619fa.js"><link rel="prefetch" href="/vuebloger/assets/js/110.13d20afe.js"><link rel="prefetch" href="/vuebloger/assets/js/111.6e97ed73.js"><link rel="prefetch" href="/vuebloger/assets/js/112.59c3943b.js"><link rel="prefetch" href="/vuebloger/assets/js/113.3ce978ee.js"><link rel="prefetch" href="/vuebloger/assets/js/114.a88867f5.js"><link rel="prefetch" href="/vuebloger/assets/js/115.b1c3d0fb.js"><link rel="prefetch" href="/vuebloger/assets/js/116.262c2d28.js"><link rel="prefetch" href="/vuebloger/assets/js/117.29fe34be.js"><link rel="prefetch" href="/vuebloger/assets/js/118.fbcbe333.js"><link rel="prefetch" href="/vuebloger/assets/js/119.6d63cf4a.js"><link rel="prefetch" href="/vuebloger/assets/js/12.3ca2d200.js"><link rel="prefetch" href="/vuebloger/assets/js/120.62f5e332.js"><link rel="prefetch" href="/vuebloger/assets/js/121.69d80e4a.js"><link rel="prefetch" href="/vuebloger/assets/js/122.312fb76c.js"><link rel="prefetch" href="/vuebloger/assets/js/123.871f0c47.js"><link rel="prefetch" href="/vuebloger/assets/js/124.96c37bca.js"><link rel="prefetch" href="/vuebloger/assets/js/125.70cc34a1.js"><link rel="prefetch" href="/vuebloger/assets/js/126.93ce61e5.js"><link rel="prefetch" href="/vuebloger/assets/js/127.40e8b5ed.js"><link rel="prefetch" href="/vuebloger/assets/js/128.480bf51d.js"><link rel="prefetch" href="/vuebloger/assets/js/129.fc900c25.js"><link rel="prefetch" href="/vuebloger/assets/js/13.9cf5f312.js"><link rel="prefetch" href="/vuebloger/assets/js/130.f723b918.js"><link rel="prefetch" href="/vuebloger/assets/js/131.318d3c17.js"><link rel="prefetch" href="/vuebloger/assets/js/132.2a27084d.js"><link rel="prefetch" href="/vuebloger/assets/js/133.7bb8bb62.js"><link rel="prefetch" href="/vuebloger/assets/js/134.35eabd46.js"><link rel="prefetch" href="/vuebloger/assets/js/135.806f814d.js"><link rel="prefetch" href="/vuebloger/assets/js/136.08ea1c36.js"><link rel="prefetch" href="/vuebloger/assets/js/137.17b4c62c.js"><link rel="prefetch" href="/vuebloger/assets/js/138.79668cff.js"><link rel="prefetch" href="/vuebloger/assets/js/139.517ccb49.js"><link rel="prefetch" href="/vuebloger/assets/js/14.c45907da.js"><link rel="prefetch" href="/vuebloger/assets/js/15.19528e37.js"><link rel="prefetch" href="/vuebloger/assets/js/16.0a4c588b.js"><link rel="prefetch" href="/vuebloger/assets/js/17.1be50227.js"><link rel="prefetch" href="/vuebloger/assets/js/18.370e2967.js"><link rel="prefetch" href="/vuebloger/assets/js/19.02d85096.js"><link rel="prefetch" href="/vuebloger/assets/js/20.5cf90bce.js"><link rel="prefetch" href="/vuebloger/assets/js/21.6b044372.js"><link rel="prefetch" href="/vuebloger/assets/js/22.594fb529.js"><link rel="prefetch" href="/vuebloger/assets/js/23.bea9c4b4.js"><link rel="prefetch" href="/vuebloger/assets/js/24.140dfb31.js"><link rel="prefetch" href="/vuebloger/assets/js/25.5647ff51.js"><link rel="prefetch" href="/vuebloger/assets/js/26.6ca3f4e4.js"><link rel="prefetch" href="/vuebloger/assets/js/27.2201416c.js"><link rel="prefetch" href="/vuebloger/assets/js/28.27f3cdb1.js"><link rel="prefetch" href="/vuebloger/assets/js/29.481d2c32.js"><link rel="prefetch" href="/vuebloger/assets/js/30.f1dd8cb0.js"><link rel="prefetch" href="/vuebloger/assets/js/31.4d5197c0.js"><link rel="prefetch" href="/vuebloger/assets/js/32.af3888ef.js"><link rel="prefetch" href="/vuebloger/assets/js/33.14b06c21.js"><link rel="prefetch" href="/vuebloger/assets/js/34.c37dac5a.js"><link rel="prefetch" href="/vuebloger/assets/js/35.d4eeaa4f.js"><link rel="prefetch" href="/vuebloger/assets/js/36.3b296408.js"><link rel="prefetch" href="/vuebloger/assets/js/37.cf8d763b.js"><link rel="prefetch" href="/vuebloger/assets/js/38.59307071.js"><link rel="prefetch" href="/vuebloger/assets/js/39.2c925a12.js"><link rel="prefetch" href="/vuebloger/assets/js/4.4e73fd8a.js"><link rel="prefetch" href="/vuebloger/assets/js/40.5b35f86a.js"><link rel="prefetch" href="/vuebloger/assets/js/41.026e68a8.js"><link rel="prefetch" href="/vuebloger/assets/js/42.9a5d8b4e.js"><link rel="prefetch" href="/vuebloger/assets/js/43.f8c37bf0.js"><link rel="prefetch" href="/vuebloger/assets/js/44.3017b8c4.js"><link rel="prefetch" href="/vuebloger/assets/js/45.7111f181.js"><link rel="prefetch" href="/vuebloger/assets/js/46.70e270ba.js"><link rel="prefetch" href="/vuebloger/assets/js/47.0f412ac5.js"><link rel="prefetch" href="/vuebloger/assets/js/48.d73b3120.js"><link rel="prefetch" href="/vuebloger/assets/js/50.736a75cd.js"><link rel="prefetch" href="/vuebloger/assets/js/51.517ccbd3.js"><link rel="prefetch" href="/vuebloger/assets/js/52.2b3257f0.js"><link rel="prefetch" href="/vuebloger/assets/js/53.14ab24e7.js"><link rel="prefetch" href="/vuebloger/assets/js/54.fc85b6d7.js"><link rel="prefetch" href="/vuebloger/assets/js/55.5cbbffe6.js"><link rel="prefetch" href="/vuebloger/assets/js/56.5258665c.js"><link rel="prefetch" href="/vuebloger/assets/js/57.e657137f.js"><link rel="prefetch" href="/vuebloger/assets/js/58.1d7b0d12.js"><link rel="prefetch" href="/vuebloger/assets/js/59.dd762477.js"><link rel="prefetch" href="/vuebloger/assets/js/6.05f243c5.js"><link rel="prefetch" href="/vuebloger/assets/js/60.081fb113.js"><link rel="prefetch" href="/vuebloger/assets/js/62.4b93c805.js"><link rel="prefetch" href="/vuebloger/assets/js/63.689f3eb7.js"><link rel="prefetch" href="/vuebloger/assets/js/64.66e2f1ab.js"><link rel="prefetch" href="/vuebloger/assets/js/65.8d34bb31.js"><link rel="prefetch" href="/vuebloger/assets/js/66.caaa2dc7.js"><link rel="prefetch" href="/vuebloger/assets/js/67.9ae451ce.js"><link rel="prefetch" href="/vuebloger/assets/js/68.0aed1128.js"><link rel="prefetch" href="/vuebloger/assets/js/69.f53b43c9.js"><link rel="prefetch" href="/vuebloger/assets/js/7.1c4cfcbe.js"><link rel="prefetch" href="/vuebloger/assets/js/70.c1baf8c2.js"><link rel="prefetch" href="/vuebloger/assets/js/71.1b3eaf50.js"><link rel="prefetch" href="/vuebloger/assets/js/72.b116f839.js"><link rel="prefetch" href="/vuebloger/assets/js/73.6c9b7e1c.js"><link rel="prefetch" href="/vuebloger/assets/js/74.faf0f9fe.js"><link rel="prefetch" href="/vuebloger/assets/js/75.983e260a.js"><link rel="prefetch" href="/vuebloger/assets/js/76.4d91a5a9.js"><link rel="prefetch" href="/vuebloger/assets/js/77.67043e2d.js"><link rel="prefetch" href="/vuebloger/assets/js/78.0728b42c.js"><link rel="prefetch" href="/vuebloger/assets/js/79.16aa8f38.js"><link rel="prefetch" href="/vuebloger/assets/js/8.f3194aa0.js"><link rel="prefetch" href="/vuebloger/assets/js/80.ffc006cb.js"><link rel="prefetch" href="/vuebloger/assets/js/81.77b43dba.js"><link rel="prefetch" href="/vuebloger/assets/js/82.7ba99b81.js"><link rel="prefetch" href="/vuebloger/assets/js/83.cd768895.js"><link rel="prefetch" href="/vuebloger/assets/js/84.5fcd40f6.js"><link rel="prefetch" href="/vuebloger/assets/js/85.8f64e858.js"><link rel="prefetch" href="/vuebloger/assets/js/86.7daa8941.js"><link rel="prefetch" href="/vuebloger/assets/js/87.911a1a18.js"><link rel="prefetch" href="/vuebloger/assets/js/88.c36cd2bd.js"><link rel="prefetch" href="/vuebloger/assets/js/89.5fb01645.js"><link rel="prefetch" href="/vuebloger/assets/js/9.f25900b9.js"><link rel="prefetch" href="/vuebloger/assets/js/90.be92f7c5.js"><link rel="prefetch" href="/vuebloger/assets/js/91.8b9ede61.js"><link rel="prefetch" href="/vuebloger/assets/js/92.2f30f92f.js"><link rel="prefetch" href="/vuebloger/assets/js/93.9c55c667.js"><link rel="prefetch" href="/vuebloger/assets/js/94.b8d136a2.js"><link rel="prefetch" href="/vuebloger/assets/js/95.a6eb9f9d.js"><link rel="prefetch" href="/vuebloger/assets/js/96.d3eb99ed.js"><link rel="prefetch" href="/vuebloger/assets/js/97.6ea440ee.js"><link rel="prefetch" href="/vuebloger/assets/js/98.25f0d5d6.js"><link rel="prefetch" href="/vuebloger/assets/js/99.170c9927.js"><link rel="prefetch" href="/vuebloger/assets/js/vendors~docsearch.439e457f.js">
    <link rel="stylesheet" href="/vuebloger/assets/css/0.styles.8192970a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuebloger/" class="home-link router-link-active"><img src="/vuebloger/img/logo.jpeg" alt="邹先生博客记录" class="logo"> <span class="site-name can-hide">邹先生博客记录</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/workplace/" class="nav-link">职场</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <div style="margin-left:20px;margin-right:20px;">
    音乐
    <div role="switch" class="el-switch"><input type="checkbox" name="" true-value="true" class="el-switch__input"><!----><span class="el-switch__core" style="width:40px;"></span><!----></div> <audio><source src="/vuebloger/mp3/065b_520b_0409_111c898908eab454414c3c326fe77c36.mp3" type="audio/mpeg"></audio></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/workplace/" class="nav-link">职场</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>前端二进制</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#本地图片预览" class="sidebar-link">本地图片预览</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#filereader" class="sidebar-link">FileReader</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#base64" class="sidebar-link">Base64</a></li></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#下载图片" class="sidebar-link">下载图片</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#fetch" class="sidebar-link">fetch</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#object-url" class="sidebar-link">Object URL</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#blob" class="sidebar-link">Blob</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#arraybuffer" class="sidebar-link">ArrayBuffer</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#unit8array" class="sidebar-link">Unit8Array</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#arraybuffer-vs-typedarray" class="sidebar-link">ArrayBuffer vs TypedArray</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#blob-vs-arraybuffer" class="sidebar-link">Blob vs ArrayBuffer</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#dataview" class="sidebar-link">DataView</a></li></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#图片灰度化" class="sidebar-link">图片灰度化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#getimagedata" class="sidebar-link">getImageData</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#putimagedata" class="sidebar-link">putImageData</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#灰度化处理" class="sidebar-link">灰度化处理</a></li></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#图片压缩" class="sidebar-link">图片压缩</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#图片上传" class="sidebar-link">图片上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#大文件分片上传" class="sidebar-link">大文件分片上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#查看二进制数据" class="sidebar-link">查看二进制数据</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#区分图片类型" class="sidebar-link">区分图片类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E5%89%8D%E7%AB%AF%E4%BA%8C%E8%BF%9B%E5%88%B6.html#获取图片尺寸" class="sidebar-link">获取图片尺寸</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content__default" data-v-31e0b8ae data-v-31e0b8ae><p data-v-31e0b8ae>我们来看有关二进制、Blob、Blob URL、Base64、Data URL、ArrayBuffer、TypedArray、DataView 和图片压缩相关的知识点如下：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/640.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>他们之间存在以下转换关系图</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6401.webp" alt="" data-v-31e0b8ae></p> <h2 id="本地图片预览" data-v-31e0b8ae><a href="#本地图片预览" class="header-anchor" data-v-31e0b8ae>#</a> 本地图片预览</h2> <h3 id="filereader" data-v-31e0b8ae><a href="#filereader" class="header-anchor" data-v-31e0b8ae>#</a> FileReader</h3> <p data-v-31e0b8ae>file转base64实现本地图片预览</p> <div class="language-html line-numbers-mode" data-v-31e0b8ae><pre class="language-html" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token doctype" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;!</span><span class="token doctype-tag" data-v-31e0b8ae>DOCTYPE</span> <span class="token name" data-v-31e0b8ae>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>head</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>meta</span> <span class="token attr-name" data-v-31e0b8ae>charset</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>UTF-8<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>meta</span> <span class="token attr-name" data-v-31e0b8ae>name</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>viewport<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>content</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>title</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>图片本地预览示例<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>title</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>head</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>body</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>阿宝哥：图片本地预览示例<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>input</span> <span class="token attr-name" data-v-31e0b8ae>type</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>file<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>accept</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>image/*<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>onchange</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value javascript language-javascript" data-v-31e0b8ae><span class="token function" data-v-31e0b8ae>loadFile</span><span class="token punctuation" data-v-31e0b8ae>(</span>event<span class="token punctuation" data-v-31e0b8ae>)</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>img</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>previewContainer<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>

    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token script" data-v-31e0b8ae><span class="token language-javascript" data-v-31e0b8ae>
      <span class="token keyword" data-v-31e0b8ae>const</span> <span class="token function-variable function" data-v-31e0b8ae>loadFile</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>event</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> reader <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>FileReader</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        reader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function-variable function" data-v-31e0b8ae>onload</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
          <span class="token keyword" data-v-31e0b8ae>const</span> output <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#previewContainer&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
          output<span class="token punctuation" data-v-31e0b8ae>.</span>src <span class="token operator" data-v-31e0b8ae>=</span> reader<span class="token punctuation" data-v-31e0b8ae>.</span>result<span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        reader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>readAsDataURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>event<span class="token punctuation" data-v-31e0b8ae>.</span>target<span class="token punctuation" data-v-31e0b8ae>.</span>files<span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
      <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    </span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>body</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>17</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>18</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>19</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>20</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>21</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>22</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>23</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>24</span><br data-v-31e0b8ae></div></div><div class="custom-block tip" data-v-31e0b8ae><p class="custom-block-title" data-v-31e0b8ae>温馨提示</p> <p data-v-31e0b8ae>其实对于 FileReader 对象来说，除了支持把 File/Blob 对象转换为 Data URL 之外，它还提供了 readAsArrayBuffer() 和 readAsText() 方法，用于把 File/Blob 对象转换为其它的数据格式。</p></div> <p data-v-31e0b8ae>Data URL，它由四个部分组成：前缀（data:）、指示数据类型的 MIME 类型、如果非文本则为可选的 base64 标记、数据本身：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>data<span class="token operator" data-v-31e0b8ae>:</span>image<span class="token operator" data-v-31e0b8ae>/</span>png<span class="token punctuation" data-v-31e0b8ae>;</span>base64<span class="token punctuation" data-v-31e0b8ae>,</span>iVBORw0KGgoAAAANSUhEUgAAAhAAAAIwCAYAAADXrFK<span class="token operator" data-v-31e0b8ae>...</span>


data<span class="token operator" data-v-31e0b8ae>:</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token operator" data-v-31e0b8ae>&lt;</span>mediatype<span class="token operator" data-v-31e0b8ae>&gt;</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token punctuation" data-v-31e0b8ae>;</span>base64<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>,</span><span class="token operator" data-v-31e0b8ae>&lt;</span>data<span class="token operator" data-v-31e0b8ae>&gt;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>mediatype 是个 MIME 类型的字符串，比如 &quot;image/png&quot; 表示 PNG 图像文件。如果被省略，则默认值为 text/plain;charset=US-ASCII。如果数据是文本类型，你可以直接将文本嵌入（根据文档类型，使用合适的实体字符或转义字符）。如果是二进制数据，你可以将数据进行 base64 编码之后再进行嵌入。</p> <p data-v-31e0b8ae>在 Data URL 中，数据是很重要的一部分，它使用 base64 编码的字符串来表示。因此要掌握  Data URL，我们还得了解一下 Base64。</p> <h3 id="base64" data-v-31e0b8ae><a href="#base64" class="header-anchor" data-v-31e0b8ae>#</a> Base64</h3> <p data-v-31e0b8ae>「Base64」 是一种基于 64 个可打印字符来表示二进制数据的表示方法。由于 「2⁶ = 64」 ，所以每 6 个比特为一个单元，对应某个可打印字符。3 个字节有 24 个比特，对应于 4 个 base64 单元，即 3 个字节可由 4 个可打印字符来表示。相应的转换过程如下图所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6402.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>「Base64 常用于在处理文本数据的场合，表示、传输、存储一些二进制数据，包括 MIME 的电子邮件及 XML 的一些复杂数据。」 在 MIME 格式的电子邮件中，base64 可以用来将二进制的字节序列数据编码成 ASCII 字符序列构成的文本。使用时，在传输编码方式中指定 base64。使用的字符包括大小写拉丁字母各 26 个、数字 10 个、加号 + 和斜杠 /，共 64 个字符，等号 = 用来作为后缀用途。</p> <p data-v-31e0b8ae>Base64 相应的索引表如下：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6403.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>了解完上述的知识，我们以编码 Man 为例，来直观的感受一下编码过程。Man 由 M、a 和 n 这 3 个字符组成，它们对应的 ASCII 码为 77、97 和 110。</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6404.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>接着我们以每 6 个比特为一个单元，进行 base64 编码操作，具体如下图所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6405.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>由图可知，Man （3 字节）编码的结果为 TWFu（4 字节），很明显经过 base64 编码后体积会增加 1/3。Man 这个字符串的长度刚好是 3，我们可以用 4 个 base64 单元来表示。但如果待编码的字符串长度不是 3 的整数倍时，应该如何处理呢？</p> <p data-v-31e0b8ae>「如果要编码的字节数不能被 3 整除，最后会多出 1 个或 2 个字节，那么可以使用下面的方法进行处理：先使用 0 字节值在末尾补足，使其能够被 3 整除，然后再进行 base64 的编码。」</p> <p data-v-31e0b8ae>以编码字符 A 为例，其所占的字节数为 1，不能被 3 整除，需要补 2 个字节，具体如下图所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6406.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>由上图可知，字符 A 经过 base64 编码后的结果是 QQ==，该结果后面的两个 = 代表补足的字节数。而最后个 1 个 base64 字节块有 4 位是 0 值。</p> <p data-v-31e0b8ae>接着我们来看另一个示例，假设需编码的字符串为 BC，其所占字节数为 2，不能被 3 整除，需要补 1 个字节，具体如下图所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6407.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>由上图可知，字符串 BC 经过 base64 编码后的结果是 QkM=，该结果后面的 1 个 = 代表补足的字节数。而最后个 1 个 base64 字节块有 2 位是 0 值。</p> <p data-v-31e0b8ae>在 JavaScript 中，有两个函数被分别用来处理解码和编码 base64 字符串：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>btoa()：该函数能够基于二进制数据 “字符串” 创建一个 base64 编码的 ASCII 字符串。</li> <li data-v-31e0b8ae>atob()：该函数能够解码通过 base64 编码的字符串数据。</li></ul> <p data-v-31e0b8ae>对于 atob 和 btoa 这两个方法来说，其中的 a 代表 ASCII，而 b 代表 Blob，即二进制。因此 atob 表示 ASCII 到二进制，对应的是解码操作。而 btoa 表示二进制到 ASCII，对应的是编码操作。在了解方法中 a 和 b 分别代表的意义之后，在以后的工作中，我们就不会用错了。</p> <p data-v-31e0b8ae>需要注意的是 base64 只是一种数据编码方式，目的是为了保障数据的安全传输。但标准的 base64 编码无需额外的信息，即可以进行解码，是完全可逆的。因此在涉及传输私密数据时，并不能直接使用 base64 编码，而是要使用专门的对称或非对称加密算法。</p> <h2 id="下载图片" data-v-31e0b8ae><a href="#下载图片" class="header-anchor" data-v-31e0b8ae>#</a> 下载图片</h2> <p data-v-31e0b8ae>在一些场景中，我们会通过 Canvas 进行图片编辑或使用 jsPDF、sheetjs 等一些第三方库进行文档处理，当文件文件处理完成后，我们需要把文件下载并保存到本地。 可以使用FileSaver.js 来实现文件保存功能</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> <span class="token function-variable function" data-v-31e0b8ae>download</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>fileName<span class="token punctuation" data-v-31e0b8ae>,</span> blob</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> link <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>createElement</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;a&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  link<span class="token punctuation" data-v-31e0b8ae>.</span>href <span class="token operator" data-v-31e0b8ae>=</span> <span class="token constant" data-v-31e0b8ae>URL</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>createObjectURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>blob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  link<span class="token punctuation" data-v-31e0b8ae>.</span>download <span class="token operator" data-v-31e0b8ae>=</span> fileName<span class="token punctuation" data-v-31e0b8ae>;</span>
  link<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>click</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  link<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>remove</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token constant" data-v-31e0b8ae>URL</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>revokeObjectURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>link<span class="token punctuation" data-v-31e0b8ae>.</span>href<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token keyword" data-v-31e0b8ae>const</span> downloadBtn <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#downloadBtn&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
downloadBtn<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>addEventListener</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;click&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>event</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> fileName <span class="token operator" data-v-31e0b8ae>=</span> <span class="token string" data-v-31e0b8ae>&quot;blob.txt&quot;</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> myBlob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token string" data-v-31e0b8ae>&quot;一文彻底掌握 Blob Web API&quot;</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token punctuation" data-v-31e0b8ae>{</span> type<span class="token operator" data-v-31e0b8ae>:</span> <span class="token string" data-v-31e0b8ae>&quot;text/plain&quot;</span> <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token function" data-v-31e0b8ae>download</span><span class="token punctuation" data-v-31e0b8ae>(</span>fileName<span class="token punctuation" data-v-31e0b8ae>,</span> myBlob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae></div></div><h3 id="fetch" data-v-31e0b8ae><a href="#fetch" class="header-anchor" data-v-31e0b8ae>#</a> fetch</h3> <p data-v-31e0b8ae>使用 fetch API 从 Github 上获取的头像，具体代码如下所示：</p> <div class="language-html line-numbers-mode" data-v-31e0b8ae><pre class="language-html" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token doctype" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;!</span><span class="token doctype-tag" data-v-31e0b8ae>DOCTYPE</span> <span class="token name" data-v-31e0b8ae>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>head</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>meta</span> <span class="token attr-name" data-v-31e0b8ae>charset</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>UTF-8<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>meta</span> <span class="token attr-name" data-v-31e0b8ae>name</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>viewport<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>content</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>title</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>获取远程图片预览示例<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>title</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>head</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>body</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>阿宝哥：获取远程图片预览示例<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>img</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>previewContainer<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>width</span><span class="token punctuation" data-v-31e0b8ae>:</span> 50%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>

    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token script" data-v-31e0b8ae><span class="token language-javascript" data-v-31e0b8ae>
      <span class="token keyword" data-v-31e0b8ae>const</span> image <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#previewContainer&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
      <span class="token function" data-v-31e0b8ae>fetch</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;https://avatars3.githubusercontent.com/u/4220799&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span>
        <span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>response</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> response<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span>
        <span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>blob</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
          <span class="token keyword" data-v-31e0b8ae>const</span> objectURL <span class="token operator" data-v-31e0b8ae>=</span> <span class="token constant" data-v-31e0b8ae>URL</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>createObjectURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>blob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
          image<span class="token punctuation" data-v-31e0b8ae>.</span>src <span class="token operator" data-v-31e0b8ae>=</span> objectURL<span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    </span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>body</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>17</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>18</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>19</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>20</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>21</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>22</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>特殊字符串，我们称之为 「Object URL」，相比前面介绍的 Data URL，它简洁很多。接下来我们来认识一下 Object URL 这种协议。</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>blob<span class="token operator" data-v-31e0b8ae>:</span><span class="token keyword" data-v-31e0b8ae>null</span><span class="token operator" data-v-31e0b8ae>/</span>ab24c171<span class="token operator" data-v-31e0b8ae>-</span><span class="token number" data-v-31e0b8ae>1</span>c5f<span class="token operator" data-v-31e0b8ae>-</span><span class="token number" data-v-31e0b8ae>4</span>de1<span class="token operator" data-v-31e0b8ae>-</span>a44e<span class="token operator" data-v-31e0b8ae>-</span><span class="token number" data-v-31e0b8ae>568</span>bc1f77d7b
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><h3 id="object-url" data-v-31e0b8ae><a href="#object-url" class="header-anchor" data-v-31e0b8ae>#</a> Object URL</h3> <p data-v-31e0b8ae>Object URL 是一种伪协议，也被称为 Blob URL。它允许 Blob 或 File 对象用作图像，下载二进制数据链接等的 URL 源。在浏览器中，我们使用 URL.createObjectURL 方法来创建 Blob URL，该方法接收一个 Blob 对象，并为其创建一个唯一的 URL，其形式为 <code data-v-31e0b8ae>blob:&lt;origin&gt;/&lt;uuid&gt;</code>，对应的示例如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>blob<span class="token operator" data-v-31e0b8ae>:</span>https<span class="token operator" data-v-31e0b8ae>:</span><span class="token operator" data-v-31e0b8ae>/</span><span class="token operator" data-v-31e0b8ae>/</span>example<span class="token punctuation" data-v-31e0b8ae>.</span>org<span class="token operator" data-v-31e0b8ae>/</span><span class="token number" data-v-31e0b8ae>40</span>a5fb5a<span class="token operator" data-v-31e0b8ae>-</span>d56d<span class="token operator" data-v-31e0b8ae>-</span><span class="token number" data-v-31e0b8ae>4</span>a33<span class="token operator" data-v-31e0b8ae>-</span>b4e2<span class="token operator" data-v-31e0b8ae>-</span><span class="token number" data-v-31e0b8ae>0</span>acf6a8e5f641
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>浏览器内部为每个通过 URL.createObjectURL 生成的 URL 存储了一个 「URL → Blob」 映射。因此，此类 URL 较短，但可以访问 Blob。生成的 URL 仅在当前文档打开的状态下才有效。但如果你访问的 Blob URL 不再存在，则会从浏览器中收到 404 错误。</p> <p data-v-31e0b8ae>上述的 Blob URL 看似很不错，但实际上它也有副作用。虽然存储了 URL → Blob 的映射，但 Blob 本身仍驻留在内存中，浏览器无法释放它。映射在文档卸载时自动清除，因此 Blob 对象随后被释放。但是，如果应用程序寿命很长，那不会很快发生。因此，如果我们创建一个 Blob URL，即使不再需要该 Blob，它也会存在内存中。</p> <p data-v-31e0b8ae>针对这个问题，我们可以调用 URL.revokeObjectURL(url) 方法，从内部映射中删除引用，从而允许删除 Blob（如果没有其他引用），并释放内存。</p> <h3 id="blob" data-v-31e0b8ae><a href="#blob" class="header-anchor" data-v-31e0b8ae>#</a> Blob</h3> <p data-v-31e0b8ae>lob（Binary Large Object）表示二进制类型的大对象。在数据库管理系统中，将二进制数据存储为一个单一个体的集合。Blob 通常是影像、声音或多媒体文件。「在 JavaScript 中 Blob 类型的对象表示不可变的类似文件对象的原始数据。」 为了更直观的感受 Blob 对象，我们先来使用 Blob 构造函数，创建一个 myBlob 对象，具体如下图所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6408.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>如你所见，myBlob 对象含有两个属性：size 和 type。其中 size 属性用于表示数据的大小（以字节为单位），type 是 MIME 类型的字符串。Blob 表示的不一定是 JavaScript 原生格式的数据。比如 File 接口基于 Blob，继承了 blob 的功能并将其扩展使其支持用户系统上的文件。</p> <p data-v-31e0b8ae>Blob 由一个可选的字符串 type（通常是 MIME 类型）和 blobParts 组成：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/6409.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>Blob 构造函数的语法为：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>var</span> aBlob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span>blobParts<span class="token punctuation" data-v-31e0b8ae>,</span> options<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>相关的参数说明如下：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>blobParts：它是一个由 ArrayBuffer，ArrayBufferView，Blob，DOMString 等对象构成的数组。DOMStrings 会被编码为 UTF-8。</li> <li data-v-31e0b8ae>options：一个可选的对象，包含以下两个属性：</li> <li data-v-31e0b8ae>type —— 默认值为 &quot;&quot;，它代表了将会被放入到 blob 中的数组内容的 MIME 类型。</li> <li data-v-31e0b8ae>endings —— 默认值为 &quot;transparent&quot;，用于指定包含行结束符 \n 的字符串如何被写入。它是以下两个值中的一个：&quot;native&quot;，代表行结束符会被更改为适合宿主操作系统文件系统的换行符，或者 &quot;transparent&quot;，代表会保持 blob 中保存的结束符不变。</li></ul> <ol data-v-31e0b8ae><li data-v-31e0b8ae>从字符串创建 Blob</li></ol> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>let</span> myBlobParts <span class="token operator" data-v-31e0b8ae>=</span> <span class="token punctuation" data-v-31e0b8ae>[</span><span class="token string" data-v-31e0b8ae>'&lt;html&gt;&lt;h2&gt;Hello Semlinker&lt;/h2&gt;&lt;/html&gt;'</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// an array consisting of a single DOMString</span>
<span class="token keyword" data-v-31e0b8ae>let</span> myBlob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span>myBlobParts<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token punctuation" data-v-31e0b8ae>{</span>type <span class="token operator" data-v-31e0b8ae>:</span> <span class="token string" data-v-31e0b8ae>'text/html'</span><span class="token punctuation" data-v-31e0b8ae>,</span> endings<span class="token operator" data-v-31e0b8ae>:</span> <span class="token string" data-v-31e0b8ae>&quot;transparent&quot;</span><span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// the blob</span>

console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>myBlob<span class="token punctuation" data-v-31e0b8ae>.</span>size <span class="token operator" data-v-31e0b8ae>+</span> <span class="token string" data-v-31e0b8ae>&quot; bytes size&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token comment" data-v-31e0b8ae>// Output: 37 bytes size</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>myBlob<span class="token punctuation" data-v-31e0b8ae>.</span>type <span class="token operator" data-v-31e0b8ae>+</span> <span class="token string" data-v-31e0b8ae>&quot; is the type&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token comment" data-v-31e0b8ae>// Output: text/html is the type    </span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae></div></div><ol start="2" data-v-31e0b8ae><li data-v-31e0b8ae>从类型化数组和字符串创建 Blob</li></ol> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>let</span> hello <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>72</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>101</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>108</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>108</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>111</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 二进制格式的 &quot;hello&quot;</span>
<span class="token keyword" data-v-31e0b8ae>let</span> blob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span>hello<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token string" data-v-31e0b8ae>' '</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token string" data-v-31e0b8ae>'semlinker'</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token punctuation" data-v-31e0b8ae>{</span>type<span class="token operator" data-v-31e0b8ae>:</span> <span class="token string" data-v-31e0b8ae>'text/plain'</span><span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>Blob 类的属性和方法：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64010.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>Blob 对象包含两个属性：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>size（只读）：表示 Blob 对象中所包含数据的大小（以字节为单位）。</li> <li data-v-31e0b8ae>type（只读）：一个字符串，表明该 Blob 对象所包含数据的 MIME 类型。如果类型未知，则该值为空字符串。</li></ul> <p data-v-31e0b8ae>Blob 方法:</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>slice([start[, end[, contentType]]])：返回一个新的 Blob 对象，包含了源 Blob 对象中指定范围内的数据。</li> <li data-v-31e0b8ae>stream()：返回一个能读取 blob 内容的 ReadableStream。</li> <li data-v-31e0b8ae>text()：返回一个 Promise 对象且包含 blob 所有内容的 UTF-8 格式的 USVString。</li> <li data-v-31e0b8ae>arrayBuffer()：返回一个 Promise 对象且包含 blob 所有内容的二进制格式的 ArrayBuffer。</li></ul> <p data-v-31e0b8ae>这里我们需要注意的是，「Blob 对象是不可改变的」。我们不能直接在一个 Blob 中更改数据，但是我们可以对一个 Blob 进行分割，从其中创建新的 Blob 对象，将它们混合到一个新的 Blob 中。这种行为类似于 JavaScript 字符串：我们无法更改字符串中的字符，但可以创建新的更正后的字符串。</p> <p data-v-31e0b8ae>对于 fetch API 的 Response 对象来说，该对象除了提供 blob() 方法之外，还提供了 json()、 text() 、formData() 和 arrayBuffer() 等方法，用于把响应转换为不同的数据格式。</p> <p data-v-31e0b8ae>在前后端分离的项目中，大家用得比较多的应该就是 json() 方法，而其它方法可能用得相对比较少。对于前面的示例，我们把响应对象转换为 ArrayBuffer 对象，同样可以正常显示从网络下载的图像，具体的代码如下所示：</p> <div class="language-html line-numbers-mode" data-v-31e0b8ae><pre class="language-html" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>获取远程图片预览示例<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>img</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>previewContainer<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>width</span><span class="token punctuation" data-v-31e0b8ae>:</span> 50%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>

<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token script" data-v-31e0b8ae><span class="token language-javascript" data-v-31e0b8ae>
   <span class="token keyword" data-v-31e0b8ae>const</span> image <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#previewContainer&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
   <span class="token function" data-v-31e0b8ae>fetch</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;https://avatars3.githubusercontent.com/u/4220799&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span>
     <span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>response</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> response<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>arrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span>
     <span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>buffer</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> blob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span>buffer<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> objectURL <span class="token operator" data-v-31e0b8ae>=</span> <span class="token constant" data-v-31e0b8ae>URL</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>createObjectURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>blob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        image<span class="token punctuation" data-v-31e0b8ae>.</span>src <span class="token operator" data-v-31e0b8ae>=</span> objectURL<span class="token punctuation" data-v-31e0b8ae>;</span>
   <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>在以上代码中，我们先把响应对象转换为 ArrayBuffer 对象，然后通过调用 Blob 构造函数，把 ArrayBuffer 对象转换为 Blob 对象，再利用 createObjectURL() 方法创建 Object URL，最终实现图片预览。</p> <h3 id="arraybuffer" data-v-31e0b8ae><a href="#arraybuffer" class="header-anchor" data-v-31e0b8ae>#</a> ArrayBuffer</h3> <p data-v-31e0b8ae>ArrayBuffer 对象用来表示「通用的、固定长度的」原始二进制数据缓冲区。「ArrayBuffer 不能直接操作，而是要通过类型数组对象 或 DataView 对象来操作」，它们会将缓冲区中的数据表示为特定的格式，并通过这些格式来读写缓冲区的内容。</p> <div class="custom-block tip" data-v-31e0b8ae><p class="custom-block-title" data-v-31e0b8ae>温馨提示</p> <p data-v-31e0b8ae>ArrayBuffer 简单说是一片内存，但是你不能直接用它。这就好比你在 C 里面，malloc 一片内存出来，你也会把它转换成 unsigned_int32 或者 int16 这些你需要的实际类型的数组/指针来用。</p> <p data-v-31e0b8ae>这就是 JS 里的 TypedArray 的作用，那些 Uint32Array 也好，Int16Array 也好，都是给 ArrayBuffer 提供了一个 “View”，MDN 上的原话叫做 “Multiple views on the same data”，对它们进行下标读写，最终都会反应到它所建立在的 ArrayBuffer 之上。</p></div> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>ArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span>length<span class="token punctuation" data-v-31e0b8ae>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>构造函数：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>参数：length 表示要创建的 ArrayBuffer 的大小，单位为字节。</li> <li data-v-31e0b8ae>返回值：一个指定大小的 ArrayBuffer 对象，其内容被初始化为 0。</li> <li data-v-31e0b8ae>异常：如果 length 大于 Number.MAX_SAFE_INTEGER（&gt;= 2 ** 53）或为负数，则抛出一个  RangeError  异常。</li></ul> <p data-v-31e0b8ae>下面的例子创建了一个 8 字节的缓冲区，并使用一个 Int32Array 来引用它：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>let</span> buffer <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>ArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>8</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>let</span> view   <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Int32Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>从 ECMAScript 2015 开始，ArrayBuffer 对象需要用 new 运算符创建。如果调用构造函数时没有使用 new，将会抛出 TypeError  异常。比如执行该语句 let ab = ArrayBuffer(10) 将会抛出以下异常：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token constant" data-v-31e0b8ae>VM109</span><span class="token operator" data-v-31e0b8ae>:</span><span class="token number" data-v-31e0b8ae>1</span> Uncaught TypeError<span class="token operator" data-v-31e0b8ae>:</span> Constructor ArrayBuffer requires <span class="token string" data-v-31e0b8ae>'new'</span>
    at <span class="token function" data-v-31e0b8ae>ArrayBuffer</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token operator" data-v-31e0b8ae>&lt;</span>anonymous<span class="token operator" data-v-31e0b8ae>&gt;</span><span class="token punctuation" data-v-31e0b8ae>)</span>
    at <span class="token operator" data-v-31e0b8ae>&lt;</span>anonymous<span class="token operator" data-v-31e0b8ae>&gt;</span><span class="token operator" data-v-31e0b8ae>:</span><span class="token number" data-v-31e0b8ae>1</span><span class="token operator" data-v-31e0b8ae>:</span><span class="token number" data-v-31e0b8ae>10</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>对于一些常用的 Web API，如 FileReader API 和 Fetch API 底层也是支持 ArrayBuffer，这里我们以  FileReader API 为例，看一下如何把 File 对象读取为 ArrayBuffer 对象：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> reader <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>FileReader</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

reader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function-variable function" data-v-31e0b8ae>onload</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>function</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>e</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>let</span> arrayBuffer <span class="token operator" data-v-31e0b8ae>=</span> reader<span class="token punctuation" data-v-31e0b8ae>.</span>result<span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>

reader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>readAsArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span>file<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae></div></div><h3 id="unit8array" data-v-31e0b8ae><a href="#unit8array" class="header-anchor" data-v-31e0b8ae>#</a> Unit8Array</h3> <p data-v-31e0b8ae>Uint8Array 数组类型表示一个 8 位无符号整型数组，创建时内容被初始化为 0。创建完后，可以以「对象的方式或使用数组下标索引的方式」引用数组中的元素。
语法:</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// ES2017 最新语法</span>
<span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>length<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 创建初始化为0的，包含length个元素的无符号整型数组</span>
<span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>typedArray<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>object<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer <span class="token punctuation" data-v-31e0b8ae>[</span><span class="token punctuation" data-v-31e0b8ae>,</span> byteOffset <span class="token punctuation" data-v-31e0b8ae>[</span><span class="token punctuation" data-v-31e0b8ae>,</span> length<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>示例:</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token comment" data-v-31e0b8ae>// new Uint8Array(length); </span>
<span class="token keyword" data-v-31e0b8ae>var</span> uint8 <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>2</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
uint8<span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>42</span><span class="token punctuation" data-v-31e0b8ae>;</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>uint8<span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 42</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>uint8<span class="token punctuation" data-v-31e0b8ae>.</span>length<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 2</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>uint8<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token constant" data-v-31e0b8ae>BYTES_PER_ELEMENT</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 1</span>

<span class="token comment" data-v-31e0b8ae>// new TypedArray(object); </span>
<span class="token keyword" data-v-31e0b8ae>var</span> arr <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>21</span><span class="token punctuation" data-v-31e0b8ae>,</span><span class="token number" data-v-31e0b8ae>31</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>arr<span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 31</span>

<span class="token comment" data-v-31e0b8ae>// new Uint8Array(typedArray);</span>
<span class="token keyword" data-v-31e0b8ae>var</span> x <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>21</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>31</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>var</span> y <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>x<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>y<span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 21</span>

<span class="token comment" data-v-31e0b8ae>// new Uint8Array(buffer [, byteOffset [, length]]);</span>
<span class="token keyword" data-v-31e0b8ae>var</span> buffer <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>ArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>8</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>var</span> z <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>4</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>17</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>18</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>19</span><br data-v-31e0b8ae></div></div><h3 id="arraybuffer-vs-typedarray" data-v-31e0b8ae><a href="#arraybuffer-vs-typedarray" class="header-anchor" data-v-31e0b8ae>#</a> ArrayBuffer vs TypedArray</h3> <p data-v-31e0b8ae>ArrayBuffer 本身只是一行 0 和 1 串。ArrayBuffer 不知道该数组中第一个元素和第二个元素之间的分隔位置。</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64011.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>为了提供上下文，实际上要将其分解为多个盒子，我们需要将其包装在所谓的视图中。可以使用类型数组添加这些数据视图，并且你可以使用许多不同类型的类型数组。</p> <p data-v-31e0b8ae>例如，你可以有一个 Int8 类型的数组，它将把这个数组分成 8-bit 的字节数组。</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64012.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>或者你也可以有一个无符号 Int16 数组，它会把数组分成 16-bit 的字节数组，并且把它当作无符号整数来处理。</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64013.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>你甚至可以在同一基本缓冲区上拥有多个视图。对于相同的操作，不同的视图会给出不同的结果。</p> <p data-v-31e0b8ae>例如，如果我们从这个 ArrayBuffer 的 Int8 视图中获取 0 &amp; 1 元素的值（-19 &amp; 100），它将给我们与 Uint16 视图中元素 0 （25837）不同的值，即使它们包含完全相同的位。</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64014.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>这样，ArrayBuffer 基本上就像原始内存一样。它模拟了使用 C 之类的语言进行的直接内存访问。「你可能想知道为什么我们不让程序直接访问内存，而是添加了这种抽象层，因为直接访问内存将导致一些安全漏洞」。</p> <p data-v-31e0b8ae>目前，我们已经了解 Blob 与 ArrayBuffer，那么它们之前有什么区别呢？</p> <h3 id="blob-vs-arraybuffer" data-v-31e0b8ae><a href="#blob-vs-arraybuffer" class="header-anchor" data-v-31e0b8ae>#</a> Blob vs ArrayBuffer</h3> <p data-v-31e0b8ae>「ArrayBuffer」 对象用于表示通用的，固定长度的原始二进制数据缓冲区。你不能直接操纵 ArrayBuffer 的内容，而是需要创建一个类型化数组对象或 DataView 对象，该对象以特定格式表示缓冲区，并使用该对象读取和写入缓冲区的内容。</p> <p data-v-31e0b8ae>「Blob」 类型的对象表示不可变的类似文件对象的原始数据。Blob 表示的不一定是 JavaScript 原生格式的数据。File 接口基于 Blob，继承了Blob 功能并将其扩展为支持用户系统上的文件。</p> <p data-v-31e0b8ae>Blob 与 ArrayBuffer 的区别：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>除非你需要使用 ArrayBuffer 提供的写入/编辑的能力，否则 Blob 格式可能是最好的。</li> <li data-v-31e0b8ae>Blob 对象是不可变的，而 ArrayBuffer 是可以通过 TypedArrays 或 DataView 来操作。</li> <li data-v-31e0b8ae>ArrayBuffer 是存在内存中的，可以直接操作。而 Blob 可以位于磁盘、高速缓存内存和其他不可用的位置。</li> <li data-v-31e0b8ae>虽然 Blob 可以直接作为参数传递给其他函数，比如 window.URL.createObjectURL()。但是，你可能仍需要 FileReader 之类的 File API 才能与 Blob 一起使用。</li> <li data-v-31e0b8ae>Blob 与 ArrayBuffer 对象之间是可以相互转化的：
<ul data-v-31e0b8ae><li data-v-31e0b8ae>使用 FileReader 的 readAsArrayBuffer() 方法，可以把 Blob 对象转换为 ArrayBuffer 对象；</li> <li data-v-31e0b8ae>使用 Blob 构造函数，如 new Blob([new Uint8Array(data]);，可以把 ArrayBuffer 对象转换为 Blob 对象。</li></ul></li></ul> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token comment" data-v-31e0b8ae>// Blob 转换为 ArrayBuffer</span>
<span class="token keyword" data-v-31e0b8ae>var</span> blob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token string" data-v-31e0b8ae>&quot;\x01\x02\x03\x04&quot;</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>,</span>
    fileReader <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>FileReader</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>,</span>
    array<span class="token punctuation" data-v-31e0b8ae>;</span>

fileReader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function-variable function" data-v-31e0b8ae>onload</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>function</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  array <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>this</span><span class="token punctuation" data-v-31e0b8ae>.</span>result<span class="token punctuation" data-v-31e0b8ae>;</span>
  console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;Array contains&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> array<span class="token punctuation" data-v-31e0b8ae>.</span>byteLength<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token string" data-v-31e0b8ae>&quot;bytes.&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>

fileReader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>readAsArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span>blob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>


<span class="token comment" data-v-31e0b8ae>// ArrayBuffer 转 Blob</span>
<span class="token keyword" data-v-31e0b8ae>var</span> array <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0x01</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x02</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x03</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x04</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>var</span> blob <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span>array<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae></div></div><h3 id="dataview" data-v-31e0b8ae><a href="#dataview" class="header-anchor" data-v-31e0b8ae>#</a> DataView</h3> <p data-v-31e0b8ae>DataView 视图是一个可以从二进制 ArrayBuffer 对象中读写多种数值类型的底层接口，使用它时，不用考虑不同平台的字节序问题。</p> <div class="custom-block tip" data-v-31e0b8ae><p class="custom-block-title" data-v-31e0b8ae>温馨提示</p> <p data-v-31e0b8ae>字节顺序，又称端序或尾序（英语：Endianness），在计算机科学领域中，指存储器中或在数字通信链路中，组成多字节的字的字节的排列顺序。</p> <p data-v-31e0b8ae>字节的排列方式有两个通用规则。例如，一个多位的整数，按照存储地址从低到高排序的字节中，如果该整数的最低有效字节（类似于最低有效位）在最高有效字节的前面，则称小端序；反之则称大端序。在网络应用中，字节序是一个必须被考虑的因素，因为不同机器类型可能采用不同标准的字节序，所以均按照网络标准转化。</p> <p data-v-31e0b8ae>例如假设上述变量 x 类型为int，位于地址 0x100 处，它的值为 0x01234567，地址范围为 0x100~0x103字节，其内部排列顺序依赖于机器的类型。大端法从首位开始将是：0x100: 01, 0x101: 23,..。而小端法将是：0x100: 67, 0x101: 45,..。</p></div> <p data-v-31e0b8ae>DataView 构造函数:</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>DataView</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer <span class="token punctuation" data-v-31e0b8ae>[</span><span class="token punctuation" data-v-31e0b8ae>,</span> byteOffset <span class="token punctuation" data-v-31e0b8ae>[</span><span class="token punctuation" data-v-31e0b8ae>,</span> byteLength<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><ul data-v-31e0b8ae><li data-v-31e0b8ae>buffer：一个已经存在的 ArrayBuffer 或 SharedArrayBuffer 对象，DataView 对象的数据源。</li> <li data-v-31e0b8ae>byteOffset（可选）：此 DataView 对象的第一个字节在 buffer 中的字节偏移。如果未指定，则默认从第一个字节开始。</li> <li data-v-31e0b8ae>byteLength：此 DataView 对象的字节长度。如果未指定，这个视图的长度将匹配 buffer 的长度。</li></ul> <p data-v-31e0b8ae>DataView 返回值:</p> <p data-v-31e0b8ae>使用 new 调用 DataView 构造函数后，会返回一个表示指定数据缓存区的新 DataView 对象。你可以把返回的对象想象成一个二进制字节缓存区 array buffer 的 “解释器” —— 它知道如何在读取或写入时正确地转换字节码。这意味着它能在二进制层面处理整数与浮点转化、字节顺序等其他有关的细节问题。</p> <p data-v-31e0b8ae>DataView 使用示例:</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> buffer <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>ArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>16</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token comment" data-v-31e0b8ae>// Create a couple of views</span>
<span class="token keyword" data-v-31e0b8ae>const</span> view1 <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>DataView</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>const</span> view2 <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>DataView</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>12</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>4</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>//from byte 12 for the next 4 bytes</span>
view1<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>setInt8</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>12</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>42</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// put 42 in slot 12</span>

console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>view2<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>getInt8</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// expected output: 42</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>DataView 属性:</p> <p data-v-31e0b8ae>所有 DataView 实例都继承自 DataView.prototype，并且允许向 DataView 对象中添加额外属性。</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>DataView.prototype.buffer（只读）：指向创建 DataView 时设定的 ArrayBuffer 对象；</li> <li data-v-31e0b8ae>DataView.prototype.byteLength（只读）：表示 ArrayBuffer 或 SharedArrayBuffer 对象的字节长度；</li> <li data-v-31e0b8ae>DataView.prototype.byteOffset（只读）：表示从 ArrayBuffer 读取时的偏移字节长度。</li></ul> <p data-v-31e0b8ae>DataView 方法:</p> <p data-v-31e0b8ae>DataView 对象提供了 getInt8()、getUint8()、setInt8() 和 setUint8() 等方法来操作数据。具体每个方法的使用，我们就不详细介绍。这里我们来看个简单的例子：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> buffer <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>ArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>16</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>const</span> view <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>DataView</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

view<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>setInt8</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>68</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
view<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>getInt8</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 68</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>最后ArrayBuffer、TypedArray 和 DataView之间的关系：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64015.webp" alt="" data-v-31e0b8ae></p> <h2 id="图片灰度化" data-v-31e0b8ae><a href="#图片灰度化" class="header-anchor" data-v-31e0b8ae>#</a> 图片灰度化</h2> <h3 id="getimagedata" data-v-31e0b8ae><a href="#getimagedata" class="header-anchor" data-v-31e0b8ae>#</a> getImageData</h3> <p data-v-31e0b8ae>可以利用 CanvasRenderingContext2D 提供的 getImageData 来获取图片像素数据，其中 getImageData() 返回一个 ImageData 对象，用来描述 canvas 区域隐含的像素数据，这个区域通过矩形表示，起始点为（sx, sy）、宽为 sw、高为 sh。其中 getImageData 方法的语法如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>ctx<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>getImageData</span><span class="token punctuation" data-v-31e0b8ae>(</span>sx<span class="token punctuation" data-v-31e0b8ae>,</span> sy<span class="token punctuation" data-v-31e0b8ae>,</span> sw<span class="token punctuation" data-v-31e0b8ae>,</span> sh<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>相应的参数说明如下：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>sx：将要被提取的图像数据矩形区域的左上角 x 坐标。</li> <li data-v-31e0b8ae>sy：将要被提取的图像数据矩形区域的左上角 y 坐标。</li> <li data-v-31e0b8ae>sw：将要被提取的图像数据矩形区域的宽度。</li> <li data-v-31e0b8ae>sh：将要被提取的图像数据矩形区域的高度。</li></ul> <p data-v-31e0b8ae>getImageData() 方法内部是如何处理的呢？下面我们来简单介绍一下大致流程，这里我们以一张 2px * 2px 的图片为例，下图是放大展示的效果：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64017.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>同样，我们先使用 「Synalyze It! Pro」 十六进制编辑器打开上面的 「2px * 2px」 的图片：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64018.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>PNG 图片的像素数据是保存在 「IDAT」 块中，除了 「IDAT」 块之外，还包含其他的数据块，完整的数据块如下所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/64020.webp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>在解析像素数据之前，我们先了解像素数据是如何编码的。每行像素都会先经过过滤函数处理，每行像素的过滤函数可以不同。然后所有行的像素数据会经过 「deflate」 压缩算法压缩。这里使用 pako 这个库进行解码操作：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>
<span class="token keyword" data-v-31e0b8ae>const</span> compressed <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>120</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>156</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>99</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>16</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>96</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>216</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>228</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>193</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>try</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> result <span class="token operator" data-v-31e0b8ae>=</span> pako<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>inflate</span><span class="token punctuation" data-v-31e0b8ae>(</span>compressed<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>dir</span><span class="token punctuation" data-v-31e0b8ae>(</span>result<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span> <span class="token keyword" data-v-31e0b8ae>catch</span> <span class="token punctuation" data-v-31e0b8ae>(</span>err<span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>err<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>在以上代码中，通过调用 pako.inflate() 方法执行解压操作，最终的解压后的像素数据如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>Uint8Array <span class="token punctuation" data-v-31e0b8ae>[</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>16</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>176</span> <span class="token punctuation" data-v-31e0b8ae>]</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>获取解压的像素数据之后，还要解码扫描线，然后根据色板中的索引，来还原出图片的像素信息。深入了解可以阅读 《一步一步解码 PNG 图片》 这篇文章。</p> <h3 id="putimagedata" data-v-31e0b8ae><a href="#putimagedata" class="header-anchor" data-v-31e0b8ae>#</a> putImageData</h3> <p data-v-31e0b8ae>在获取到图片的像素数据之后，我们就可以对获取的像素数据进行处理，比如进行灰度化或反色处理。当完成处理后，若要在页面上显示处理效果，则我们需要利用 CanvasRenderingContext2D 提供的另一个 API —— putImageData。</p> <p data-v-31e0b8ae>该 API 是 Canvas 2D API 将数据从已有的 ImageData 对象绘制到位图的方法。如果提供了一个绘制过的矩形，则只绘制该矩形的像素。此方法不受画布转换矩阵的影响。putImageData 方法的语法如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>void</span> ctx<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>putImageData</span><span class="token punctuation" data-v-31e0b8ae>(</span>imagedata<span class="token punctuation" data-v-31e0b8ae>,</span> dx<span class="token punctuation" data-v-31e0b8ae>,</span> dy<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>void</span> ctx<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>putImageData</span><span class="token punctuation" data-v-31e0b8ae>(</span>imagedata<span class="token punctuation" data-v-31e0b8ae>,</span> dx<span class="token punctuation" data-v-31e0b8ae>,</span> dy<span class="token punctuation" data-v-31e0b8ae>,</span> dirtyX<span class="token punctuation" data-v-31e0b8ae>,</span> dirtyY<span class="token punctuation" data-v-31e0b8ae>,</span> dirtyWidth<span class="token punctuation" data-v-31e0b8ae>,</span> dirtyHeight<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>相应的参数说明如下：</p> <ul data-v-31e0b8ae><li data-v-31e0b8ae>imageData：ImageData ，包含像素值的数组对象。</li> <li data-v-31e0b8ae>dx：源图像数据在目标画布中的位置偏移量（x 轴方向的偏移量）。</li> <li data-v-31e0b8ae>dy：源图像数据在目标画布中的位置偏移量（y 轴方向的偏移量）。</li> <li data-v-31e0b8ae>dirtyX（可选）：在源图像数据中，矩形区域左上角的位置。默认是整个图像数据的左上角（x 坐标）。</li> <li data-v-31e0b8ae>dirtyY（可选）：在源图像数据中，矩形区域左上角的位置。默认是整个图像数据的左上角（y 坐标）。</li> <li data-v-31e0b8ae>dirtyWidth（可选）：在源图像数据中，矩形区域的宽度。默认是图像数据的宽度。</li> <li data-v-31e0b8ae>dirtyHeight（可选）：在源图像数据中，矩形区域的高度。默认是图像数据的高度。</li></ul> <h3 id="灰度化处理" data-v-31e0b8ae><a href="#灰度化处理" class="header-anchor" data-v-31e0b8ae>#</a> 灰度化处理</h3> <div class="language-html line-numbers-mode" data-v-31e0b8ae><pre class="language-html" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token doctype" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;!</span><span class="token doctype-tag" data-v-31e0b8ae>DOCTYPE</span> <span class="token name" data-v-31e0b8ae>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>head</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>meta</span> <span class="token attr-name" data-v-31e0b8ae>charset</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>UTF-8<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>meta</span> <span class="token attr-name" data-v-31e0b8ae>name</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>viewport<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>content</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>title</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>获取远程图片并灰度化<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>title</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>head</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>body</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>阿宝哥：获取远程图片并灰度化示例<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>h3</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>button</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>grayscalebtn<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>灰度化<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>button</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>display</span><span class="token punctuation" data-v-31e0b8ae>:</span> flex<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
        <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>flex</span><span class="token punctuation" data-v-31e0b8ae>:</span> 50%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
          <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>预览容器<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
          <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>img</span>
            <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>previewContainer<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
            <span class="token attr-name" data-v-31e0b8ae>width</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
            <span class="token attr-name" data-v-31e0b8ae>height</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
            <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>border</span><span class="token punctuation" data-v-31e0b8ae>:</span> 2px dashed blue<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span>
          <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
        <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
        <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>flex</span><span class="token punctuation" data-v-31e0b8ae>:</span> 50%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
          <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>Canvas容器<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
          <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>canvas</span>
            <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>canvas<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
            <span class="token attr-name" data-v-31e0b8ae>width</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
            <span class="token attr-name" data-v-31e0b8ae>height</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
            <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>border</span><span class="token punctuation" data-v-31e0b8ae>:</span> 2px dashed grey<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span>
          <span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>canvas</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
        <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
    <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token script" data-v-31e0b8ae><span class="token language-javascript" data-v-31e0b8ae>
      <span class="token keyword" data-v-31e0b8ae>const</span> image <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#previewContainer&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
      <span class="token keyword" data-v-31e0b8ae>const</span> canvas <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#canvas&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

      <span class="token function" data-v-31e0b8ae>fetch</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;https://avatars3.githubusercontent.com/u/4220799&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span>
        <span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>response</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> response<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span>
        <span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>blob</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
          <span class="token keyword" data-v-31e0b8ae>const</span> objectURL <span class="token operator" data-v-31e0b8ae>=</span> <span class="token constant" data-v-31e0b8ae>URL</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>createObjectURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>blob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
          image<span class="token punctuation" data-v-31e0b8ae>.</span>src <span class="token operator" data-v-31e0b8ae>=</span> objectURL<span class="token punctuation" data-v-31e0b8ae>;</span>
          image<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function-variable function" data-v-31e0b8ae>onload</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
            <span class="token function" data-v-31e0b8ae>draw</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
          <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

      <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>draw</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> ctx <span class="token operator" data-v-31e0b8ae>=</span> canvas<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>getContext</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;2d&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        ctx<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>drawImage</span><span class="token punctuation" data-v-31e0b8ae>(</span>image<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>230</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>230</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> imageData <span class="token operator" data-v-31e0b8ae>=</span> ctx<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>getImageData</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> canvas<span class="token punctuation" data-v-31e0b8ae>.</span>width<span class="token punctuation" data-v-31e0b8ae>,</span> canvas<span class="token punctuation" data-v-31e0b8ae>.</span>height<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> data <span class="token operator" data-v-31e0b8ae>=</span> imageData<span class="token punctuation" data-v-31e0b8ae>.</span>data<span class="token punctuation" data-v-31e0b8ae>;</span>

        <span class="token keyword" data-v-31e0b8ae>const</span> <span class="token function-variable function" data-v-31e0b8ae>grayscale</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
          <span class="token keyword" data-v-31e0b8ae>for</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token keyword" data-v-31e0b8ae>let</span> i <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>;</span> i <span class="token operator" data-v-31e0b8ae>&lt;</span> data<span class="token punctuation" data-v-31e0b8ae>.</span>length<span class="token punctuation" data-v-31e0b8ae>;</span> i <span class="token operator" data-v-31e0b8ae>+=</span> <span class="token number" data-v-31e0b8ae>4</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
            <span class="token keyword" data-v-31e0b8ae>const</span> avg <span class="token operator" data-v-31e0b8ae>=</span> <span class="token punctuation" data-v-31e0b8ae>(</span>data<span class="token punctuation" data-v-31e0b8ae>[</span>i<span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>+</span> data<span class="token punctuation" data-v-31e0b8ae>[</span>i <span class="token operator" data-v-31e0b8ae>+</span> <span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>+</span> data<span class="token punctuation" data-v-31e0b8ae>[</span>i <span class="token operator" data-v-31e0b8ae>+</span> <span class="token number" data-v-31e0b8ae>2</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>/</span> <span class="token number" data-v-31e0b8ae>3</span><span class="token punctuation" data-v-31e0b8ae>;</span>
            data<span class="token punctuation" data-v-31e0b8ae>[</span>i<span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>=</span> avg<span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// red</span>
            data<span class="token punctuation" data-v-31e0b8ae>[</span>i <span class="token operator" data-v-31e0b8ae>+</span> <span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>=</span> avg<span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// green</span>
            data<span class="token punctuation" data-v-31e0b8ae>[</span>i <span class="token operator" data-v-31e0b8ae>+</span> <span class="token number" data-v-31e0b8ae>2</span><span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>=</span> avg<span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// blue</span>
          <span class="token punctuation" data-v-31e0b8ae>}</span>
          ctx<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>putImageData</span><span class="token punctuation" data-v-31e0b8ae>(</span>imageData<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token keyword" data-v-31e0b8ae>const</span> grayscalebtn <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#grayscalebtn&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        grayscalebtn<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>addEventListener</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;click&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> grayscale<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
      <span class="token punctuation" data-v-31e0b8ae>}</span>
    </span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>body</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>html</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>17</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>18</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>19</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>20</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>21</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>22</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>23</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>24</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>25</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>26</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>27</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>28</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>29</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>30</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>31</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>32</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>33</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>34</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>35</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>36</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>37</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>38</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>39</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>40</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>41</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>42</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>43</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>44</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>45</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>46</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>47</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>48</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>49</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>50</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>51</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>52</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>53</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>54</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>55</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>56</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>57</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>58</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>59</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>60</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>61</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>62</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>63</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>64</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>65</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>66</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>67</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>在以上示例中，我们先从 Github 上下载头像，然后先进行本地预览，接着调用 draw() 方法把获取的图像绘制到页面的 Canvas 容器中，同时为灰度化按钮绑定监听事件。</p> <p data-v-31e0b8ae>当用户点击灰度化按钮时，将会触发灰度化处理函数，在该函数内部会对通过 ctx.getImageData() 方法获取的图片像素进行灰度化处理，处理完成后再通过 ctx.putImageData() 方法把处理过的像素数据更新到 Canvas 上。</p> <h2 id="图片压缩" data-v-31e0b8ae><a href="#图片压缩" class="header-anchor" data-v-31e0b8ae>#</a> 图片压缩</h2> <p data-v-31e0b8ae>可以利用 Canvas 对象提供的 toDataURL() 方法，该方法接收 type 和 encoderOptions 两个可选参数。</p> <p data-v-31e0b8ae>其中 type 表示图片格式，默认为 image/png。而 encoderOptions 用于表示图片的质量，在指定图片格式为 image/jpeg 或 image/webp 的情况下，可以从 0 到 1 的区间内选择图片的质量。如果超出取值范围，将会使用默认值 0.92，其他参数会被忽略。</p> <p data-v-31e0b8ae>下面我们来看一下如何对前面已进行灰度化处理的图片进行压缩。</p> <div class="language-html line-numbers-mode" data-v-31e0b8ae><pre class="language-html" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>button</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>compressbtn<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>图片压缩<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>button</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>display</span><span class="token punctuation" data-v-31e0b8ae>:</span> flex<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
   <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>flex</span><span class="token punctuation" data-v-31e0b8ae>:</span> 33.3%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>预览容器<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>img</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>previewContainer<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>width</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>height</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
         <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>border</span><span class="token punctuation" data-v-31e0b8ae>:</span> 2px dashed blue<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
   <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
   <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>flex</span><span class="token punctuation" data-v-31e0b8ae>:</span> 33.3%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>Canvas容器<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>canvas</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>canvas<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>width</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>height</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
         <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>border</span><span class="token punctuation" data-v-31e0b8ae>:</span> 2px dashed grey<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>canvas</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
   <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
   <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span> <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>flex</span><span class="token punctuation" data-v-31e0b8ae>:</span> 33.3%<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>压缩预览容器<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
      <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>img</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>compressPrevContainer<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>width</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>height</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>230<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
         <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>style</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value css language-css" data-v-31e0b8ae><span class="token property" data-v-31e0b8ae>border</span><span class="token punctuation" data-v-31e0b8ae>:</span> 2px dashed green<span class="token punctuation" data-v-31e0b8ae>;</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
   <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>

<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token script" data-v-31e0b8ae><span class="token language-javascript" data-v-31e0b8ae>
   <span class="token keyword" data-v-31e0b8ae>const</span> compressbtn <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#compressbtn&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
   <span class="token keyword" data-v-31e0b8ae>const</span> compressImage <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#compressPrevContainer&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
   compressbtn<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>addEventListener</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;click&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> compress<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  
   <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>compress</span><span class="token punctuation" data-v-31e0b8ae>(</span>quality <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>80</span><span class="token punctuation" data-v-31e0b8ae>,</span> mimeType <span class="token operator" data-v-31e0b8ae>=</span> <span class="token string" data-v-31e0b8ae>&quot;image/webp&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
     <span class="token keyword" data-v-31e0b8ae>const</span> imageDataURL <span class="token operator" data-v-31e0b8ae>=</span> canvas<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>toDataURL</span><span class="token punctuation" data-v-31e0b8ae>(</span>mimeType<span class="token punctuation" data-v-31e0b8ae>,</span> quality <span class="token operator" data-v-31e0b8ae>/</span> <span class="token number" data-v-31e0b8ae>100</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
     compressImage<span class="token punctuation" data-v-31e0b8ae>.</span>src <span class="token operator" data-v-31e0b8ae>=</span> imageDataURL<span class="token punctuation" data-v-31e0b8ae>;</span>
   <span class="token punctuation" data-v-31e0b8ae>}</span>
</span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>script</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>17</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>18</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>19</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>20</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>21</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>22</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>23</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>24</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>25</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>26</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>27</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>28</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>29</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>30</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>在以上代码中，我们设默认的图片质量是 「0.8」，而图片类型是 「image/webp」 类型。当用户点击压缩按钮时，则会调用 Canvas 对象的 toDataURL() 方法实现图片压缩。
其实 Canvas 对象除了提供 toDataURL() 方法之外，它还提供了一个 toBlob() 方法，该方法的语法如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>canvas<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>toBlob</span><span class="token punctuation" data-v-31e0b8ae>(</span>callback<span class="token punctuation" data-v-31e0b8ae>,</span> mimeType<span class="token punctuation" data-v-31e0b8ae>,</span> qualityArgument<span class="token punctuation" data-v-31e0b8ae>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>和 toDataURL() 方法相比，toBlob() 方法是异步的，因此多了个 callback 参数，这个 callback 回调方法默认的第一个参数就是转换好的 blob文件信息。</p> <h2 id="图片上传" data-v-31e0b8ae><a href="#图片上传" class="header-anchor" data-v-31e0b8ae>#</a> 图片上传</h2> <p data-v-31e0b8ae>在获取压缩后图片对应的 Data URL 数据之后，可以把该数据直接提交到服务器。针对这种情形，服务端需要做一些相关处理，才能正常保存上传的图片，这里以 Express 为例，具体处理代码如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> app <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>require</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'express'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

app<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>post</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'/upload'</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token keyword" data-v-31e0b8ae>function</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>req<span class="token punctuation" data-v-31e0b8ae>,</span> res</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>{</span>
    <span class="token keyword" data-v-31e0b8ae>let</span> imgData <span class="token operator" data-v-31e0b8ae>=</span> req<span class="token punctuation" data-v-31e0b8ae>.</span>body<span class="token punctuation" data-v-31e0b8ae>.</span>imgData<span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// 获取POST请求中的base64图片数据</span>
    <span class="token keyword" data-v-31e0b8ae>let</span> base64Data <span class="token operator" data-v-31e0b8ae>=</span> imgData<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>replace</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token regex" data-v-31e0b8ae><span class="token regex-delimiter" data-v-31e0b8ae>/</span><span class="token regex-source language-regex" data-v-31e0b8ae>^data:image\/\w+;base64,</span><span class="token regex-delimiter" data-v-31e0b8ae>/</span></span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token string" data-v-31e0b8ae>&quot;&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    <span class="token keyword" data-v-31e0b8ae>let</span> dataBuffer <span class="token operator" data-v-31e0b8ae>=</span> Buffer<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>from</span><span class="token punctuation" data-v-31e0b8ae>(</span>base64Data<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token string" data-v-31e0b8ae>'base64'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    fs<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>writeFile</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;abao.png&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> dataBuffer<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token keyword" data-v-31e0b8ae>function</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>err</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
        <span class="token keyword" data-v-31e0b8ae>if</span><span class="token punctuation" data-v-31e0b8ae>(</span>err<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>{</span>
          res<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>send</span><span class="token punctuation" data-v-31e0b8ae>(</span>err<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token keyword" data-v-31e0b8ae>else</span><span class="token punctuation" data-v-31e0b8ae>{</span>
          res<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>send</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;图片上传成功！&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
        <span class="token punctuation" data-v-31e0b8ae>}</span>
    <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>然而对于返回的 Data URL 格式的图片数据一般都会比较大，为了进一步减少传输的数据量，我们可以把它转换为 Blob 对象：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>dataUrlToBlob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>base64<span class="token punctuation" data-v-31e0b8ae>,</span> mimeType</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>let</span> bytes <span class="token operator" data-v-31e0b8ae>=</span> window<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>atob</span><span class="token punctuation" data-v-31e0b8ae>(</span>base64<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>split</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;,&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>let</span> ab <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>ArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span>bytes<span class="token punctuation" data-v-31e0b8ae>.</span>length<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>let</span> ia <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>ab<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>for</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token keyword" data-v-31e0b8ae>let</span> i <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>;</span> i <span class="token operator" data-v-31e0b8ae>&lt;</span> bytes<span class="token punctuation" data-v-31e0b8ae>.</span>length<span class="token punctuation" data-v-31e0b8ae>;</span> i<span class="token operator" data-v-31e0b8ae>++</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
    ia<span class="token punctuation" data-v-31e0b8ae>[</span>i<span class="token punctuation" data-v-31e0b8ae>]</span> <span class="token operator" data-v-31e0b8ae>=</span> bytes<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>charCodeAt</span><span class="token punctuation" data-v-31e0b8ae>(</span>i<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token punctuation" data-v-31e0b8ae>}</span>
  <span class="token keyword" data-v-31e0b8ae>return</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Blob</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span>ab<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token punctuation" data-v-31e0b8ae>{</span> type<span class="token operator" data-v-31e0b8ae>:</span> mimeType <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>在转换完成后，我们就可以压缩后的图片对应的 Blob 对象封装在 FormData 对象中，然后再通过 AJAX 提交到服务器上：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>uploadFile</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>url<span class="token punctuation" data-v-31e0b8ae>,</span> blob</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>let</span> formData <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>FormData</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>let</span> request <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>XMLHttpRequest</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  formData<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>append</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;imgData&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> blob<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  request<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>open</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;POST&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> url<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token boolean" data-v-31e0b8ae>true</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  request<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>send</span><span class="token punctuation" data-v-31e0b8ae>(</span>formData<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae></div></div><h2 id="大文件分片上传" data-v-31e0b8ae><a href="#大文件分片上传" class="header-anchor" data-v-31e0b8ae>#</a> 大文件分片上传</h2> <p data-v-31e0b8ae>File 对象是特殊类型的 Blob，且可以用在任意的 Blob 类型的上下文中。所以针对大文件传输的场景，我们可以使用 slice 方法对大文件进行切割，然后分片进行上传，具体示例如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> file <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>File</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token string" data-v-31e0b8ae>&quot;a&quot;</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>repeat</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>1000000</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token string" data-v-31e0b8ae>&quot;test.txt&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token keyword" data-v-31e0b8ae>const</span> chunkSize <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>40000</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>const</span> url <span class="token operator" data-v-31e0b8ae>=</span> <span class="token string" data-v-31e0b8ae>&quot;https://httpbin.org/post&quot;</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token keyword" data-v-31e0b8ae>async</span> <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>chunkedUpload</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>for</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token keyword" data-v-31e0b8ae>let</span> start <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>;</span> start <span class="token operator" data-v-31e0b8ae>&lt;</span> file<span class="token punctuation" data-v-31e0b8ae>.</span>size<span class="token punctuation" data-v-31e0b8ae>;</span> start <span class="token operator" data-v-31e0b8ae>+=</span> chunkSize<span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
      <span class="token keyword" data-v-31e0b8ae>const</span> chunk <span class="token operator" data-v-31e0b8ae>=</span> file<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>slice</span><span class="token punctuation" data-v-31e0b8ae>(</span>start<span class="token punctuation" data-v-31e0b8ae>,</span> start <span class="token operator" data-v-31e0b8ae>+</span> chunkSize <span class="token operator" data-v-31e0b8ae>+</span> <span class="token number" data-v-31e0b8ae>1</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
      <span class="token keyword" data-v-31e0b8ae>const</span> fd <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>FormData</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
      fd<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>append</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;data&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> chunk<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

      <span class="token keyword" data-v-31e0b8ae>await</span> <span class="token function" data-v-31e0b8ae>fetch</span><span class="token punctuation" data-v-31e0b8ae>(</span>url<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token punctuation" data-v-31e0b8ae>{</span> method<span class="token operator" data-v-31e0b8ae>:</span> <span class="token string" data-v-31e0b8ae>&quot;post&quot;</span><span class="token punctuation" data-v-31e0b8ae>,</span> body<span class="token operator" data-v-31e0b8ae>:</span> fd <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>then</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>res</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span>
        res<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>text</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span>
      <span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token punctuation" data-v-31e0b8ae>}</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae></div></div><h2 id="查看二进制数据" data-v-31e0b8ae><a href="#查看二进制数据" class="header-anchor" data-v-31e0b8ae>#</a> 查看二进制数据</h2> <p data-v-31e0b8ae>要查看图片对应的二进制数据，我们就需要借助一些现成的编辑器，比如 Windows 平台下的 「WinHex」 或 macOS 平台下的 「Synalyze It! Pro」 十六进制编辑器。这里我们使用 Synalyze It! Pro 这个编辑器，以十六进制的形式来查看头像图片对应的二进制数据。</p> <h2 id="区分图片类型" data-v-31e0b8ae><a href="#区分图片类型" class="header-anchor" data-v-31e0b8ae>#</a> 区分图片类型</h2> <p data-v-31e0b8ae>计算机并不是通过图片的后缀名来区分不同的图片类型，而是通过 “魔数”（Magic Number）来区分。 对于某一些类型的文件，起始的几个字节内容都是固定的，根据这几个字节的内容就可以判断文件的类型。</p> <p data-v-31e0b8ae>常见图片类型对应的魔数如下表所示：</p> <table data-v-31e0b8ae><thead data-v-31e0b8ae><tr data-v-31e0b8ae><th style="text-align:center;" data-v-31e0b8ae>文件类型</th> <th style="text-align:center;" data-v-31e0b8ae>文件后缀</th> <th style="text-align:center;" data-v-31e0b8ae>魔数</th></tr></thead> <tbody data-v-31e0b8ae><tr data-v-31e0b8ae><td style="text-align:center;" data-v-31e0b8ae>JPEG</td> <td style="text-align:center;" data-v-31e0b8ae>jpg/jpeg</td> <td style="text-align:center;" data-v-31e0b8ae>0xFFD8FF</td></tr> <tr data-v-31e0b8ae><td style="text-align:center;" data-v-31e0b8ae>PNG</td> <td style="text-align:center;" data-v-31e0b8ae>png</td> <td style="text-align:center;" data-v-31e0b8ae>0x89504E47</td></tr> <tr data-v-31e0b8ae><td style="text-align:center;" data-v-31e0b8ae>GIF</td> <td style="text-align:center;" data-v-31e0b8ae>gif</td> <td style="text-align:center;" data-v-31e0b8ae>0x47494638（GIF8）</td></tr> <tr data-v-31e0b8ae><td style="text-align:center;" data-v-31e0b8ae>BMP</td> <td style="text-align:center;" data-v-31e0b8ae>bmp</td> <td style="text-align:center;" data-v-31e0b8ae>0x424D</td></tr></tbody></table> <p data-v-31e0b8ae>PNG 类型的图片前 8 个字节是 0x89 50 4E 47 0D 0A 1A 0A。当你把 abao.png 文件修改为 abao.jpeg 后，再用编辑器打开查看图片的二进制内容，你会发现文件的前 8 个字节还是保持不变。但如果使用 input[type=&quot;file&quot;] 输入框的方式来读取文件信息的话，将会输出以下结果：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/8dfd93c6de354e53b0a796a34d7f4432_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>通过 文件后缀名或文件的 MIME 类型 并不能识别出正确的文件类型。在日常开发过程中，如果遇到检测图片类型的场景，我们可以直接利用一些现成的第三方库。比如，你想要判断一张图片是否为 PNG 类型，这时你可以使用 is-png 这个库，它同时支持浏览器和 Node.js，使用示例如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae>「Node<span class="token punctuation" data-v-31e0b8ae>.</span>js」

<span class="token comment" data-v-31e0b8ae>// npm install read-chunk</span>
<span class="token keyword" data-v-31e0b8ae>const</span> readChunk <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>require</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'read-chunk'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> 
<span class="token keyword" data-v-31e0b8ae>const</span> isPng <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>require</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'is-png'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token keyword" data-v-31e0b8ae>const</span> buffer <span class="token operator" data-v-31e0b8ae>=</span> readChunk<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>sync</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'unicorn.png'</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>8</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token function" data-v-31e0b8ae>isPng</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token comment" data-v-31e0b8ae>//=&gt; true</span>


<span class="token function" data-v-31e0b8ae>「Browser」</span>

<span class="token punctuation" data-v-31e0b8ae>(</span><span class="token keyword" data-v-31e0b8ae>async</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
 <span class="token keyword" data-v-31e0b8ae>const</span> response <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>await</span> <span class="token function" data-v-31e0b8ae>fetch</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'unicorn.png'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
 <span class="token keyword" data-v-31e0b8ae>const</span> buffer <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>await</span> response<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>arrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

 <span class="token function" data-v-31e0b8ae>isPng</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffer<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
 <span class="token comment" data-v-31e0b8ae>//=&gt; true</span>
<span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>12</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>13</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>14</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>15</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>16</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>17</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>18</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>19</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>20</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>下面介绍下如何通过读取图片的二进制信息来确保正确的图片类型：</p> <ol data-v-31e0b8ae><li data-v-31e0b8ae>定义 readBuffer 函数
在获取文件对象后，我们可以通过 FileReader API 来读取文件的内容。因为我们并不需要读取文件的完整信息，所以阿宝哥封装了一个 readBuffer 函数，用于读取文件中指定范围的二进制数据。</li></ol> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>readBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>file<span class="token punctuation" data-v-31e0b8ae>,</span> start <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> end <span class="token operator" data-v-31e0b8ae>=</span> <span class="token number" data-v-31e0b8ae>2</span></span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>return</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Promise</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>resolve<span class="token punctuation" data-v-31e0b8ae>,</span> reject</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
    <span class="token keyword" data-v-31e0b8ae>const</span> reader <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>FileReader</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    reader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function-variable function" data-v-31e0b8ae>onload</span> <span class="token operator" data-v-31e0b8ae>=</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
      <span class="token function" data-v-31e0b8ae>resolve</span><span class="token punctuation" data-v-31e0b8ae>(</span>reader<span class="token punctuation" data-v-31e0b8ae>.</span>result<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>;</span>
    reader<span class="token punctuation" data-v-31e0b8ae>.</span>onerror <span class="token operator" data-v-31e0b8ae>=</span> reject<span class="token punctuation" data-v-31e0b8ae>;</span>
    reader<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>readAsArrayBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span>file<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>slice</span><span class="token punctuation" data-v-31e0b8ae>(</span>start<span class="token punctuation" data-v-31e0b8ae>,</span> end<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>于 PNG 类型的图片来说，该文件的前 8 个字节是 0x89 50 4E 47 0D 0A 1A 0A。因此，我们在检测已选择的文件是否为 PNG 类型的图片时，只需要读取前 8 个字节的数据，并逐一判断每个字节的内容是否一致。</p> <ol start="2" data-v-31e0b8ae><li data-v-31e0b8ae>定义 check 函数</li></ol> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>check</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>headers</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>return</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>buffers<span class="token punctuation" data-v-31e0b8ae>,</span> options <span class="token operator" data-v-31e0b8ae>=</span> <span class="token punctuation" data-v-31e0b8ae>{</span> offset<span class="token operator" data-v-31e0b8ae>:</span> <span class="token number" data-v-31e0b8ae>0</span> <span class="token punctuation" data-v-31e0b8ae>}</span></span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span>
    headers<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>every</span><span class="token punctuation" data-v-31e0b8ae>(</span>
      <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>header<span class="token punctuation" data-v-31e0b8ae>,</span> index</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> header <span class="token operator" data-v-31e0b8ae>===</span> buffers<span class="token punctuation" data-v-31e0b8ae>[</span>options<span class="token punctuation" data-v-31e0b8ae>.</span>offset <span class="token operator" data-v-31e0b8ae>+</span> index<span class="token punctuation" data-v-31e0b8ae>]</span>
    <span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae></div></div><ol start="3" data-v-31e0b8ae><li data-v-31e0b8ae>检测 PNG 图片类型</li></ol> <p data-v-31e0b8ae>html 代码：</p> <div class="language-html line-numbers-mode" data-v-31e0b8ae><pre class="language-html" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
  选择文件：<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>input</span> <span class="token attr-name" data-v-31e0b8ae>type</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>file<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>inputFile<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span> <span class="token attr-name" data-v-31e0b8ae>accept</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>image/*<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span>
             <span class="token special-attr" data-v-31e0b8ae><span class="token attr-name" data-v-31e0b8ae>onchange</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span><span class="token value javascript language-javascript" data-v-31e0b8ae><span class="token function" data-v-31e0b8ae>handleChange</span><span class="token punctuation" data-v-31e0b8ae>(</span>event<span class="token punctuation" data-v-31e0b8ae>)</span></span><span class="token punctuation" data-v-31e0b8ae>&quot;</span></span></span> <span class="token punctuation" data-v-31e0b8ae>/&gt;</span></span>
  <span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;</span>p</span> <span class="token attr-name" data-v-31e0b8ae>id</span><span class="token attr-value" data-v-31e0b8ae><span class="token punctuation attr-equals" data-v-31e0b8ae>=</span><span class="token punctuation" data-v-31e0b8ae>&quot;</span>realFileType<span class="token punctuation" data-v-31e0b8ae>&quot;</span></span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span><span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>p</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
<span class="token tag" data-v-31e0b8ae><span class="token tag" data-v-31e0b8ae><span class="token punctuation" data-v-31e0b8ae>&lt;/</span>div</span><span class="token punctuation" data-v-31e0b8ae>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>JS 代码：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> isPNG <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>check</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0x89</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x50</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x4e</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x47</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x0d</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x0a</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x1a</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0x0a</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span> <span class="token comment" data-v-31e0b8ae>// PNG图片对应的魔数</span>
<span class="token keyword" data-v-31e0b8ae>const</span> realFileElement <span class="token operator" data-v-31e0b8ae>=</span> document<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>querySelector</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;#realFileType&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token keyword" data-v-31e0b8ae>async</span> <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>handleChange</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>event</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> file <span class="token operator" data-v-31e0b8ae>=</span> event<span class="token punctuation" data-v-31e0b8ae>.</span>target<span class="token punctuation" data-v-31e0b8ae>.</span>files<span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> buffers <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>await</span> <span class="token function" data-v-31e0b8ae>readBuffer</span><span class="token punctuation" data-v-31e0b8ae>(</span>file<span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>8</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  <span class="token keyword" data-v-31e0b8ae>const</span> uint8Array <span class="token operator" data-v-31e0b8ae>=</span> <span class="token keyword" data-v-31e0b8ae>new</span> <span class="token class-name" data-v-31e0b8ae>Uint8Array</span><span class="token punctuation" data-v-31e0b8ae>(</span>buffers<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
  realFileElement<span class="token punctuation" data-v-31e0b8ae>.</span>innerText <span class="token operator" data-v-31e0b8ae>=</span> <span class="token template-string" data-v-31e0b8ae><span class="token template-punctuation string" data-v-31e0b8ae>`</span><span class="token interpolation" data-v-31e0b8ae><span class="token interpolation-punctuation punctuation" data-v-31e0b8ae>${</span>file<span class="token punctuation" data-v-31e0b8ae>.</span>name<span class="token interpolation-punctuation punctuation" data-v-31e0b8ae>}</span></span><span class="token string" data-v-31e0b8ae>文件的类型是：</span><span class="token interpolation" data-v-31e0b8ae><span class="token interpolation-punctuation punctuation" data-v-31e0b8ae>${</span>
    <span class="token function" data-v-31e0b8ae>isPNG</span><span class="token punctuation" data-v-31e0b8ae>(</span>uint8Array<span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>?</span> <span class="token string" data-v-31e0b8ae>&quot;image/png&quot;</span> <span class="token operator" data-v-31e0b8ae>:</span> file<span class="token punctuation" data-v-31e0b8ae>.</span>type
  <span class="token interpolation-punctuation punctuation" data-v-31e0b8ae>}</span></span><span class="token template-punctuation string" data-v-31e0b8ae>`</span></span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>对应的检测结果如下图所示：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/ebc0f907780145f1838cb25eef8979db_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>上图可知，我们已经可以成功地检测出正确的图片格式。如果你要检测 JPEG 文件格式的话，你只需要定义一个 isJPEG 函数：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> isJPEG <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>check</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>[</span><span class="token number" data-v-31e0b8ae>0xff</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0xd8</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token number" data-v-31e0b8ae>0xff</span><span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>然而，如果你要检测其他类型的文件，比如 PDF 文件的话，应该如何处理呢？这里我们先使用 Synalyze It! Pro 编辑器来浏览一下 PDF 文件的二进制内容：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/06ba46908a3f4298909ff5e814e4e4e4_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-31e0b8ae></p> <p data-v-31e0b8ae>观察上图可知，PDF 文件的头 4 个字节的是 0x25 50 44 46，对应的字符串是 %PDF。为了让用户能更直观地辨别出检测的类型，  定义了一个 stringToBytes 函数：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>function</span> <span class="token function" data-v-31e0b8ae>stringToBytes</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>string</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  <span class="token keyword" data-v-31e0b8ae>return</span> <span class="token punctuation" data-v-31e0b8ae>[</span><span class="token operator" data-v-31e0b8ae>...</span>string<span class="token punctuation" data-v-31e0b8ae>]</span><span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>map</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>character</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token operator" data-v-31e0b8ae>=&gt;</span> character<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>charCodeAt</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token number" data-v-31e0b8ae>0</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>基于 stringToBytes 函数，我们就可以很容易的定义一个 isPDF 函数，具体如下所示：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token keyword" data-v-31e0b8ae>const</span> isPDF <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>check</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token function" data-v-31e0b8ae>stringToBytes</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>&quot;%PDF&quot;</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>有了 isPDF 函数，你就实现 PDF 文件检测的功能了。但在实际工作中，遇到的文件类型是多种多样的，针对这种情形，你可以使用现成的第三库来实现文件检测的功能，比如 file-type 这个库。
其实基于文件的二进制数据，除了可以检测文件的类型之外，我们还可以读取文件相关的元信息，比如图片的尺寸、位深度、色彩类型和压缩算法等，我们继续以阿宝哥的头像（abao.png）为例，来看一下实际的情况：</p> <p data-v-31e0b8ae><img src="/vuebloger/img/post/4d584b3c2dd64361b7e7d8c5ae7ec9f4_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-31e0b8ae></p> <h2 id="获取图片尺寸" data-v-31e0b8ae><a href="#获取图片尺寸" class="header-anchor" data-v-31e0b8ae>#</a> 获取图片尺寸</h2> <p data-v-31e0b8ae>图片的尺寸、位深度、色彩类型和压缩算法都会存储在文件的二进制数据中
<img src="/vuebloger/img/post/64019.webp" alt="" data-v-31e0b8ae></p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token number" data-v-31e0b8ae>528</span>（十进制） <span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token number" data-v-31e0b8ae>0x0210</span>（十六进制）

<span class="token number" data-v-31e0b8ae>560</span>（十进制）<span class="token operator" data-v-31e0b8ae>=&gt;</span> <span class="token number" data-v-31e0b8ae>0x0230</span>（十六进制）
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>因此如果想要获取图片的尺寸，我们就需要依据不同的图片格式对图片二进制数据进行解析。幸运的是，我们不需要自己实现该功能，image-size 这个 Node.js 库已经帮我们实现了获取主流图片类型文件尺寸的功能，使用示例如下：</p> <div class="language-js line-numbers-mode" data-v-31e0b8ae><pre class="language-js" data-v-31e0b8ae><code data-v-31e0b8ae><span class="token comment" data-v-31e0b8ae>// 同步方式</span>
<span class="token keyword" data-v-31e0b8ae>var</span> sizeOf <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>require</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'image-size'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token keyword" data-v-31e0b8ae>var</span> dimensions <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>sizeOf</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'images/abao.png'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>dimensions<span class="token punctuation" data-v-31e0b8ae>.</span>width<span class="token punctuation" data-v-31e0b8ae>,</span> dimensions<span class="token punctuation" data-v-31e0b8ae>.</span>height<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token comment" data-v-31e0b8ae>// 异步方式</span>
<span class="token keyword" data-v-31e0b8ae>var</span> sizeOf <span class="token operator" data-v-31e0b8ae>=</span> <span class="token function" data-v-31e0b8ae>require</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'image-size'</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>

<span class="token function" data-v-31e0b8ae>sizeOf</span><span class="token punctuation" data-v-31e0b8ae>(</span><span class="token string" data-v-31e0b8ae>'images/abao.png'</span><span class="token punctuation" data-v-31e0b8ae>,</span> <span class="token keyword" data-v-31e0b8ae>function</span> <span class="token punctuation" data-v-31e0b8ae>(</span><span class="token parameter" data-v-31e0b8ae>err<span class="token punctuation" data-v-31e0b8ae>,</span> dimensions</span><span class="token punctuation" data-v-31e0b8ae>)</span> <span class="token punctuation" data-v-31e0b8ae>{</span>
  console<span class="token punctuation" data-v-31e0b8ae>.</span><span class="token function" data-v-31e0b8ae>log</span><span class="token punctuation" data-v-31e0b8ae>(</span>dimensions<span class="token punctuation" data-v-31e0b8ae>.</span>width<span class="token punctuation" data-v-31e0b8ae>,</span> dimensions<span class="token punctuation" data-v-31e0b8ae>.</span>height<span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
<span class="token punctuation" data-v-31e0b8ae>}</span><span class="token punctuation" data-v-31e0b8ae>)</span><span class="token punctuation" data-v-31e0b8ae>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>1</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>2</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>3</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>4</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>5</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>6</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>7</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>8</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>9</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>10</span><br data-v-31e0b8ae><span class="line-number" data-v-31e0b8ae>11</span><br data-v-31e0b8ae></div></div><p data-v-31e0b8ae>image-size 这个库功能还是蛮强大的，除了支持 PNG 格式之外，还支持 BMP、GIF、ICO、JPEG、SVG 和 WebP 等格式。</p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/6/2021, 6:22:03 PM</span></div></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/vuebloger/assets/js/app.5081c8a7.js" defer></script><script src="/vuebloger/assets/js/5.82db9be2.js" defer></script><script src="/vuebloger/assets/js/1.b1b3586e.js" defer></script><script src="/vuebloger/assets/js/61.38e0dcbe.js" defer></script><script src="/vuebloger/assets/js/49.4796a25a.js" defer></script>
  </body>
</html>
