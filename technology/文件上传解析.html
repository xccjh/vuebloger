<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>文件上传解析 | 邹先生博客记录</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/vuebloger/img/logo.jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="">
    <link rel="preload" href="/vuebloger/assets/css/0.styles.3e38fffa.css" as="style"><link rel="preload" href="/vuebloger/assets/js/app.41c87d41.js" as="script"><link rel="preload" href="/vuebloger/assets/js/7.ef3340b4.js" as="script"><link rel="preload" href="/vuebloger/assets/js/1.1d0a3ff5.js" as="script"><link rel="preload" href="/vuebloger/assets/js/65.17cd8c65.js" as="script"><link rel="preload" href="/vuebloger/assets/js/59.68013070.js" as="script"><link rel="prefetch" href="/vuebloger/assets/js/10.2fc7b3fc.js"><link rel="prefetch" href="/vuebloger/assets/js/100.9591fe53.js"><link rel="prefetch" href="/vuebloger/assets/js/101.abcd3329.js"><link rel="prefetch" href="/vuebloger/assets/js/102.4437a51a.js"><link rel="prefetch" href="/vuebloger/assets/js/103.bb31ce8d.js"><link rel="prefetch" href="/vuebloger/assets/js/104.05767ea9.js"><link rel="prefetch" href="/vuebloger/assets/js/105.a408c7ad.js"><link rel="prefetch" href="/vuebloger/assets/js/106.cabac232.js"><link rel="prefetch" href="/vuebloger/assets/js/107.f7c6890e.js"><link rel="prefetch" href="/vuebloger/assets/js/108.be043d61.js"><link rel="prefetch" href="/vuebloger/assets/js/109.0537e101.js"><link rel="prefetch" href="/vuebloger/assets/js/11.e2053577.js"><link rel="prefetch" href="/vuebloger/assets/js/110.7a581bb0.js"><link rel="prefetch" href="/vuebloger/assets/js/111.e1220096.js"><link rel="prefetch" href="/vuebloger/assets/js/112.eb89826a.js"><link rel="prefetch" href="/vuebloger/assets/js/113.93b84429.js"><link rel="prefetch" href="/vuebloger/assets/js/114.7057f6dc.js"><link rel="prefetch" href="/vuebloger/assets/js/115.03568145.js"><link rel="prefetch" href="/vuebloger/assets/js/116.b46cbc01.js"><link rel="prefetch" href="/vuebloger/assets/js/117.c44d8857.js"><link rel="prefetch" href="/vuebloger/assets/js/118.08085c59.js"><link rel="prefetch" href="/vuebloger/assets/js/119.1f28fa74.js"><link rel="prefetch" href="/vuebloger/assets/js/12.831b2cd3.js"><link rel="prefetch" href="/vuebloger/assets/js/120.e403f31c.js"><link rel="prefetch" href="/vuebloger/assets/js/121.fff14a11.js"><link rel="prefetch" href="/vuebloger/assets/js/122.ad80112d.js"><link rel="prefetch" href="/vuebloger/assets/js/123.e4e41b72.js"><link rel="prefetch" href="/vuebloger/assets/js/124.050dbdcc.js"><link rel="prefetch" href="/vuebloger/assets/js/125.db44c9b1.js"><link rel="prefetch" href="/vuebloger/assets/js/126.84a94fa7.js"><link rel="prefetch" href="/vuebloger/assets/js/127.91ac701b.js"><link rel="prefetch" href="/vuebloger/assets/js/128.5161f3be.js"><link rel="prefetch" href="/vuebloger/assets/js/129.b064451e.js"><link rel="prefetch" href="/vuebloger/assets/js/13.930f2726.js"><link rel="prefetch" href="/vuebloger/assets/js/130.2257b748.js"><link rel="prefetch" href="/vuebloger/assets/js/131.bad88f95.js"><link rel="prefetch" href="/vuebloger/assets/js/132.d88db504.js"><link rel="prefetch" href="/vuebloger/assets/js/133.010dd6bb.js"><link rel="prefetch" href="/vuebloger/assets/js/134.40c912b7.js"><link rel="prefetch" href="/vuebloger/assets/js/135.16bc2feb.js"><link rel="prefetch" href="/vuebloger/assets/js/136.0f755c6d.js"><link rel="prefetch" href="/vuebloger/assets/js/137.7b1a13ab.js"><link rel="prefetch" href="/vuebloger/assets/js/138.9b3f64ef.js"><link rel="prefetch" href="/vuebloger/assets/js/139.9e50e7fc.js"><link rel="prefetch" href="/vuebloger/assets/js/14.265d7158.js"><link rel="prefetch" href="/vuebloger/assets/js/140.7702242b.js"><link rel="prefetch" href="/vuebloger/assets/js/141.6b25a5b4.js"><link rel="prefetch" href="/vuebloger/assets/js/142.dc91cc80.js"><link rel="prefetch" href="/vuebloger/assets/js/143.601b3611.js"><link rel="prefetch" href="/vuebloger/assets/js/144.25b3f05c.js"><link rel="prefetch" href="/vuebloger/assets/js/145.bb40c2a2.js"><link rel="prefetch" href="/vuebloger/assets/js/15.3a00eee3.js"><link rel="prefetch" href="/vuebloger/assets/js/16.fbc68a4a.js"><link rel="prefetch" href="/vuebloger/assets/js/17.066ecda6.js"><link rel="prefetch" href="/vuebloger/assets/js/18.23185428.js"><link rel="prefetch" href="/vuebloger/assets/js/19.13c5cf6b.js"><link rel="prefetch" href="/vuebloger/assets/js/20.cba112a0.js"><link rel="prefetch" href="/vuebloger/assets/js/21.6de1dc73.js"><link rel="prefetch" href="/vuebloger/assets/js/22.b661b62a.js"><link rel="prefetch" href="/vuebloger/assets/js/23.1f558b07.js"><link rel="prefetch" href="/vuebloger/assets/js/24.0725b14a.js"><link rel="prefetch" href="/vuebloger/assets/js/25.3125a57a.js"><link rel="prefetch" href="/vuebloger/assets/js/26.878a35e7.js"><link rel="prefetch" href="/vuebloger/assets/js/27.cdeeb233.js"><link rel="prefetch" href="/vuebloger/assets/js/28.ae533ad5.js"><link rel="prefetch" href="/vuebloger/assets/js/29.7cb423b1.js"><link rel="prefetch" href="/vuebloger/assets/js/30.e18f78ed.js"><link rel="prefetch" href="/vuebloger/assets/js/31.da1e0b4a.js"><link rel="prefetch" href="/vuebloger/assets/js/32.a6f9046c.js"><link rel="prefetch" href="/vuebloger/assets/js/33.7fd20ec9.js"><link rel="prefetch" href="/vuebloger/assets/js/34.22a7d700.js"><link rel="prefetch" href="/vuebloger/assets/js/35.6353487f.js"><link rel="prefetch" href="/vuebloger/assets/js/36.e079d8d3.js"><link rel="prefetch" href="/vuebloger/assets/js/37.0871a396.js"><link rel="prefetch" href="/vuebloger/assets/js/38.83ef8afb.js"><link rel="prefetch" href="/vuebloger/assets/js/39.09d5709e.js"><link rel="prefetch" href="/vuebloger/assets/js/4.df7f13e8.js"><link rel="prefetch" href="/vuebloger/assets/js/40.7aee684c.js"><link rel="prefetch" href="/vuebloger/assets/js/41.582f5239.js"><link rel="prefetch" href="/vuebloger/assets/js/42.8addaeab.js"><link rel="prefetch" href="/vuebloger/assets/js/43.aa97f12a.js"><link rel="prefetch" href="/vuebloger/assets/js/44.83556656.js"><link rel="prefetch" href="/vuebloger/assets/js/45.7dd11ea2.js"><link rel="prefetch" href="/vuebloger/assets/js/46.9d6e1702.js"><link rel="prefetch" href="/vuebloger/assets/js/47.ebabbe0f.js"><link rel="prefetch" href="/vuebloger/assets/js/48.d2528669.js"><link rel="prefetch" href="/vuebloger/assets/js/49.1497e9e9.js"><link rel="prefetch" href="/vuebloger/assets/js/5.b7de26b2.js"><link rel="prefetch" href="/vuebloger/assets/js/50.e24589a2.js"><link rel="prefetch" href="/vuebloger/assets/js/51.f2427b31.js"><link rel="prefetch" href="/vuebloger/assets/js/52.f02748f8.js"><link rel="prefetch" href="/vuebloger/assets/js/53.d518b779.js"><link rel="prefetch" href="/vuebloger/assets/js/54.3eb6d8d4.js"><link rel="prefetch" href="/vuebloger/assets/js/55.c8017df1.js"><link rel="prefetch" href="/vuebloger/assets/js/56.6907d886.js"><link rel="prefetch" href="/vuebloger/assets/js/57.c492e8d3.js"><link rel="prefetch" href="/vuebloger/assets/js/58.52a0df92.js"><link rel="prefetch" href="/vuebloger/assets/js/6.62c485d8.js"><link rel="prefetch" href="/vuebloger/assets/js/60.9a11e4ad.js"><link rel="prefetch" href="/vuebloger/assets/js/61.bde81682.js"><link rel="prefetch" href="/vuebloger/assets/js/62.d8df4395.js"><link rel="prefetch" href="/vuebloger/assets/js/63.65869550.js"><link rel="prefetch" href="/vuebloger/assets/js/64.c0ce3bd6.js"><link rel="prefetch" href="/vuebloger/assets/js/66.dd043f12.js"><link rel="prefetch" href="/vuebloger/assets/js/67.41ee38c7.js"><link rel="prefetch" href="/vuebloger/assets/js/68.f6384100.js"><link rel="prefetch" href="/vuebloger/assets/js/69.994f33d9.js"><link rel="prefetch" href="/vuebloger/assets/js/70.8203e57c.js"><link rel="prefetch" href="/vuebloger/assets/js/71.c3c1914f.js"><link rel="prefetch" href="/vuebloger/assets/js/72.595fa471.js"><link rel="prefetch" href="/vuebloger/assets/js/73.b4c7a18b.js"><link rel="prefetch" href="/vuebloger/assets/js/74.bce6760a.js"><link rel="prefetch" href="/vuebloger/assets/js/75.9db52480.js"><link rel="prefetch" href="/vuebloger/assets/js/76.f8b9fc6f.js"><link rel="prefetch" href="/vuebloger/assets/js/77.4c77625f.js"><link rel="prefetch" href="/vuebloger/assets/js/78.90b75853.js"><link rel="prefetch" href="/vuebloger/assets/js/79.a3004e63.js"><link rel="prefetch" href="/vuebloger/assets/js/8.6249e0d4.js"><link rel="prefetch" href="/vuebloger/assets/js/80.09b8a8fa.js"><link rel="prefetch" href="/vuebloger/assets/js/81.3c25523d.js"><link rel="prefetch" href="/vuebloger/assets/js/82.252c24ae.js"><link rel="prefetch" href="/vuebloger/assets/js/83.2ff65b3d.js"><link rel="prefetch" href="/vuebloger/assets/js/84.896cc09c.js"><link rel="prefetch" href="/vuebloger/assets/js/85.9fe483d5.js"><link rel="prefetch" href="/vuebloger/assets/js/86.ceb27c58.js"><link rel="prefetch" href="/vuebloger/assets/js/87.858f6c9c.js"><link rel="prefetch" href="/vuebloger/assets/js/88.45de4f80.js"><link rel="prefetch" href="/vuebloger/assets/js/89.b42b087f.js"><link rel="prefetch" href="/vuebloger/assets/js/9.6529d756.js"><link rel="prefetch" href="/vuebloger/assets/js/90.cfe710ee.js"><link rel="prefetch" href="/vuebloger/assets/js/91.f56d069c.js"><link rel="prefetch" href="/vuebloger/assets/js/92.da5b6ee6.js"><link rel="prefetch" href="/vuebloger/assets/js/93.15d94801.js"><link rel="prefetch" href="/vuebloger/assets/js/94.8eaf80e8.js"><link rel="prefetch" href="/vuebloger/assets/js/95.754ab086.js"><link rel="prefetch" href="/vuebloger/assets/js/96.98b5d478.js"><link rel="prefetch" href="/vuebloger/assets/js/97.eb515ca6.js"><link rel="prefetch" href="/vuebloger/assets/js/98.606e4fd0.js"><link rel="prefetch" href="/vuebloger/assets/js/99.13068f57.js"><link rel="prefetch" href="/vuebloger/assets/js/vendors~docsearch.03b0c597.js">
    <link rel="stylesheet" href="/vuebloger/assets/css/0.styles.3e38fffa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuebloger/" class="home-link router-link-active"><img src="/vuebloger/img/logo.jpeg" alt="邹先生博客记录" class="logo"> <span class="site-name can-hide">邹先生博客记录</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/workplace/" class="nav-link">职场</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <div style="margin-left:20px;margin-right:20px;">
    音乐
    <div role="switch" class="el-switch"><input type="checkbox" name="" true-value="true" class="el-switch__input"><!----><span class="el-switch__core" style="width:40px;"></span><!----></div> <audio><source src="/vuebloger/mp3/065b_520b_0409_111c898908eab454414c3c326fe77c36.mp3" type="audio/mpeg"></audio></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/workplace/" class="nav-link">职场</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>文件上传解析</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#文件上传的8种场景" class="sidebar-link">文件上传的8种场景</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#单文件上传" class="sidebar-link">单文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#服务端代码" class="sidebar-link">服务端代码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#多文件上传" class="sidebar-link">多文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#目录上传" class="sidebar-link">目录上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#压缩目录上传" class="sidebar-link">压缩目录上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#拖拽上传" class="sidebar-link">拖拽上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#剪贴板上传" class="sidebar-link">剪贴板上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#大文件分块上传" class="sidebar-link">大文件分块上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#服务端上传" class="sidebar-link">服务端上传</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#单文件上传-2" class="sidebar-link">单文件上传</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#多文件上传-2" class="sidebar-link">多文件上传</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content__default" data-v-54013ff0 data-v-54013ff0><h2 id="文件上传的8种场景" data-v-54013ff0><a href="#文件上传的8种场景" class="header-anchor" data-v-54013ff0>#</a> 文件上传的8种场景</h2> <ol data-v-54013ff0><li data-v-54013ff0>单文件上传：利用 input 元素的 accept 属性限制上传文件的类型、利用 JS 检测文件的类型及使用 Koa 实现单文件上传的功能；</li> <li data-v-54013ff0>多文件上传：利用 input 元素的 multiple 属性支持选择多文件及使用 Koa 实现多文件上传的功能；</li> <li data-v-54013ff0>目录上传：利用 input 元素上的 webkitdirectory 属性支持目录上传的功能及使用 Koa 实现目录上传并按文件目录结构存放的功能；</li> <li data-v-54013ff0>压缩目录上传：在目录上传的基础上，利用 JSZip 实现压缩目录上传的功能；</li> <li data-v-54013ff0>拖拽上传：利用拖拽事件和 DataTransfer 对象实现拖拽上传的功能；</li> <li data-v-54013ff0>剪贴板上传：利用剪贴板事件和 Clipboard API 实现剪贴板上传的功能；</li> <li data-v-54013ff0>大文件分块上传：利用 Blob.slice、SparkMD5 和第三方库 async-pool 实现大文件并发上传的功能；</li> <li data-v-54013ff0>服务端上传：利用第三方库 form-data 实现服务端文件流式上传的功能。</li></ol> <p data-v-54013ff0><img src="/vuebloger/img/post/d8735a9b5a544fcc8b5cd12a75c33e3d_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <h2 id="单文件上传" data-v-54013ff0><a href="#单文件上传" class="header-anchor" data-v-54013ff0>#</a> 单文件上传</h2> <p data-v-54013ff0>input 元素 accept 属性有存在兼容性问题。比如 IE 9 以下不支持，具体如下图所示：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/776aa11a44884e44a8837c9df6f81302_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> uploadFileEle <span class="token operator" data-v-54013ff0>=</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>querySelector</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;#uploadFile&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>const</span> request <span class="token operator" data-v-54013ff0>=</span> axios<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>create</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
  baseURL<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;http://localhost:3000/upload&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
  timeout<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>60000</span><span class="token punctuation" data-v-54013ff0>,</span> 
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>async</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>uploadFile</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token operator" data-v-54013ff0>!</span>uploadFileEle<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>.</span>length<span class="token punctuation" data-v-54013ff0>)</span> <span class="token keyword" data-v-54013ff0>return</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>const</span> file <span class="token operator" data-v-54013ff0>=</span> uploadFileEle<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>[</span><span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>;</span> <span class="token comment" data-v-54013ff0>// 获取单个文件</span>
  <span class="token comment" data-v-54013ff0>// 省略文件的校验过程，比如文件类型、大小校验</span>
  <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
    url<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;/single&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
    file<span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span> url<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> fieldName <span class="token operator" data-v-54013ff0>=</span> <span class="token string" data-v-54013ff0>&quot;file&quot;</span> <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>let</span> formData <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  formData<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>set</span><span class="token punctuation" data-v-54013ff0>(</span>fieldName<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  request<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>url<span class="token punctuation" data-v-54013ff0>,</span> formData<span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token comment" data-v-54013ff0>// 监听上传进度</span>
    <span class="token function-variable function" data-v-54013ff0>onUploadProgress</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>progressEvent</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>const</span> percentCompleted <span class="token operator" data-v-54013ff0>=</span> Math<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>round</span><span class="token punctuation" data-v-54013ff0>(</span>
        <span class="token punctuation" data-v-54013ff0>(</span>progressEvent<span class="token punctuation" data-v-54013ff0>.</span>loaded <span class="token operator" data-v-54013ff0>*</span> <span class="token number" data-v-54013ff0>100</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>/</span> progressEvent<span class="token punctuation" data-v-54013ff0>.</span>total
      <span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span>percentCompleted<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
     <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>24</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>25</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>26</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>27</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>28</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>29</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>30</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>31</span><br data-v-54013ff0></div></div><p data-v-54013ff0>在以上代码中，我们先把读取的 File 对象封装成 FormData 对象，然后利用 Axios 实例的 post 方法实现文件上传的功能。 在上传前，通过设置请求配置对象的 onUploadProgress 属性，就可以获取文件的上传进度。</p> <h2 id="服务端代码" data-v-54013ff0><a href="#服务端代码" class="header-anchor" data-v-54013ff0>#</a> 服务端代码</h2> <p data-v-54013ff0>Koa 是一个简单易用的 Web 框架，它的特点是优雅、简洁、轻量、自由度高。所以我们选择它来搭建文件服务，并使用以下中间件来实现相应的功能：</p> <ul data-v-54013ff0><li data-v-54013ff0>koa-static：处理静态资源的中间件；</li> <li data-v-54013ff0>@koa/cors：处理跨域请求的中间件；</li> <li data-v-54013ff0>@koa/multer：处理 multipart/form-data 的中间件；</li> <li data-v-54013ff0>@koa/router：处理路由的中间件。</li></ul> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0>
<span class="token keyword" data-v-54013ff0>const</span> path <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;path&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> Koa <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;koa&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> serve <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;koa-static&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> cors <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;@koa/cors&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> multer <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;@koa/multer&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> Router <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;@koa/router&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>const</span> app <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>Koa</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> router <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>Router</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> <span class="token constant" data-v-54013ff0>PORT</span> <span class="token operator" data-v-54013ff0>=</span> <span class="token number" data-v-54013ff0>3000</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token comment" data-v-54013ff0>// 上传后资源的URL地址</span>
<span class="token keyword" data-v-54013ff0>const</span> <span class="token constant" data-v-54013ff0>RESOURCE_URL</span> <span class="token operator" data-v-54013ff0>=</span> <span class="token template-string" data-v-54013ff0><span class="token template-punctuation string" data-v-54013ff0>`</span><span class="token string" data-v-54013ff0>http://localhost:</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span><span class="token constant" data-v-54013ff0>PORT</span><span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token template-punctuation string" data-v-54013ff0>`</span></span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token comment" data-v-54013ff0>// 存储上传文件的目录</span>
<span class="token keyword" data-v-54013ff0>const</span> <span class="token constant" data-v-54013ff0>UPLOAD_DIR</span> <span class="token operator" data-v-54013ff0>=</span> path<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>join</span><span class="token punctuation" data-v-54013ff0>(</span>__dirname<span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;/public/upload&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>const</span> storage <span class="token operator" data-v-54013ff0>=</span> multer<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>diskStorage</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token function-variable function" data-v-54013ff0>destination</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>async</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>req<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> cb</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token comment" data-v-54013ff0>// 设置文件的存储目录</span>
    <span class="token function" data-v-54013ff0>cb</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>null</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token constant" data-v-54013ff0>UPLOAD_DIR</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token function-variable function" data-v-54013ff0>filename</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>req<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> cb</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token comment" data-v-54013ff0>// 设置文件名</span>
    <span class="token function" data-v-54013ff0>cb</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>null</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token template-string" data-v-54013ff0><span class="token template-punctuation string" data-v-54013ff0>`</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span>file<span class="token punctuation" data-v-54013ff0>.</span>originalname<span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token template-punctuation string" data-v-54013ff0>`</span></span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>const</span> multerUpload <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>multer</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span> storage <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

router<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>get</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;/&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token keyword" data-v-54013ff0>async</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>ctx</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
  ctx<span class="token punctuation" data-v-54013ff0>.</span>body <span class="token operator" data-v-54013ff0>=</span> <span class="token string" data-v-54013ff0>&quot;欢迎使用文件服务（by 阿宝哥）&quot;</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

router<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>
  <span class="token string" data-v-54013ff0>&quot;/upload/single&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token keyword" data-v-54013ff0>async</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>ctx<span class="token punctuation" data-v-54013ff0>,</span> next</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>try</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>await</span> <span class="token function" data-v-54013ff0>next</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      ctx<span class="token punctuation" data-v-54013ff0>.</span>body <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>{</span>
        code<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>1</span><span class="token punctuation" data-v-54013ff0>,</span>
        msg<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;文件上传成功&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
        url<span class="token operator" data-v-54013ff0>:</span> <span class="token template-string" data-v-54013ff0><span class="token template-punctuation string" data-v-54013ff0>`</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span><span class="token constant" data-v-54013ff0>RESOURCE_URL</span><span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token string" data-v-54013ff0>/</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span>ctx<span class="token punctuation" data-v-54013ff0>.</span>file<span class="token punctuation" data-v-54013ff0>.</span>originalname<span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token template-punctuation string" data-v-54013ff0>`</span></span><span class="token punctuation" data-v-54013ff0>,</span>
      <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span> <span class="token keyword" data-v-54013ff0>catch</span> <span class="token punctuation" data-v-54013ff0>(</span>error<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      ctx<span class="token punctuation" data-v-54013ff0>.</span>body <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>{</span>
        code<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>,</span>
        msg<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;文件上传失败&quot;</span>
      <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  multerUpload<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>single</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;file&quot;</span><span class="token punctuation" data-v-54013ff0>)</span>
<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token comment" data-v-54013ff0>// 注册中间件</span>
app<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>use</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token function" data-v-54013ff0>cors</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
app<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>use</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token function" data-v-54013ff0>serve</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token constant" data-v-54013ff0>UPLOAD_DIR</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
app<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>use</span><span class="token punctuation" data-v-54013ff0>(</span>router<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>routes</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>use</span><span class="token punctuation" data-v-54013ff0>(</span>router<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>allowedMethods</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

app<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>listen</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token constant" data-v-54013ff0>PORT</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
  console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token template-string" data-v-54013ff0><span class="token template-punctuation string" data-v-54013ff0>`</span><span class="token string" data-v-54013ff0>app starting at port </span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span><span class="token constant" data-v-54013ff0>PORT</span><span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token template-punctuation string" data-v-54013ff0>`</span></span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>24</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>25</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>26</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>27</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>28</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>29</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>30</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>31</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>32</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>33</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>34</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>35</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>36</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>37</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>38</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>39</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>40</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>41</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>42</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>43</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>44</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>45</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>46</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>47</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>48</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>49</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>50</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>51</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>52</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>53</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>54</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>55</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>56</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>57</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>58</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>59</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>60</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>61</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>62</span><br data-v-54013ff0></div></div><p data-v-54013ff0>Koa 内核很简洁，扩展功能都是通过中间件来实现。比如示例中使用到的路由、CORS、静态资源处理等功能都是通过中间件实现。因此要想掌握 Koa 这个框架，核心是掌握它的中间件机制。如果你想深入了解的话，可以阅读 如何更好地理解中间件和洋葱模型 这篇文章。其实除了单文件上传外，在文件上传的场景中，我们也可以同时上传多个文件。</p> <h2 id="多文件上传" data-v-54013ff0><a href="#多文件上传" class="header-anchor" data-v-54013ff0>#</a> 多文件上传</h2> <p data-v-54013ff0>要上传多个文件，首先我们需要允许用户同时选择多个文件。要实现这个功能，我们可以利用 input 元素的 multiple 属性。跟前面介绍的 accept 属性一样，该属性也存在兼容性问题，具体如下图所示：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/734e61304be844e2188dce72522b41fd0_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>相比单文件上传的代码，多文件上传场景下的 input 元素多了一个 multiple 属性</p> <div class="language-html line-numbers-mode" data-v-54013ff0><pre class="language-html" data-v-54013ff0><code data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>input</span> <span class="token attr-name" data-v-54013ff0>id</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>uploadFile<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>type</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>file<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>accept</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>image/*<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>multiple</span> <span class="token punctuation" data-v-54013ff0>/&gt;</span></span>
<span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>button</span> <span class="token attr-name" data-v-54013ff0>id</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>submit<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>onclick</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>uploadFile()<span class="token punctuation" data-v-54013ff0>&quot;</span></span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>上传文件<span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;/</span>button</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0></div></div><p data-v-54013ff0>在单文件上传的代码中，我们通过 uploadFileEle.files[0] 获取单个文件，而对于多文件上传来说，我们需要获取已选择的文件列表，即通过 uploadFileEle.files 来获取，它返回的是一个 FileList 对象。</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>async</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>uploadFile</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token operator" data-v-54013ff0>!</span>uploadFileEle<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>.</span>length<span class="token punctuation" data-v-54013ff0>)</span> <span class="token keyword" data-v-54013ff0>return</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>const</span> files <span class="token operator" data-v-54013ff0>=</span> Array<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>from</span><span class="token punctuation" data-v-54013ff0>(</span>uploadFileEle<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
    url<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;/multiple&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
    files<span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0></div></div><p data-v-54013ff0>因为要支持上传多个文件，所以我们需要同步更新一下 upload 函数。对应的处理逻辑就是遍历文件列表，然后使用 FormData 对象的 append 方法来添加多个文件，具体代码如下所示：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span> url<span class="token punctuation" data-v-54013ff0>,</span> files<span class="token punctuation" data-v-54013ff0>,</span> fieldName <span class="token operator" data-v-54013ff0>=</span> <span class="token string" data-v-54013ff0>&quot;file&quot;</span> <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>let</span> formData <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  files<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    formData<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span>fieldName<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  request<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>url<span class="token punctuation" data-v-54013ff0>,</span> formData<span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token comment" data-v-54013ff0>// 监听上传进度</span>
    <span class="token function-variable function" data-v-54013ff0>onUploadProgress</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>progressEvent</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>const</span> percentCompleted <span class="token operator" data-v-54013ff0>=</span> Math<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>round</span><span class="token punctuation" data-v-54013ff0>(</span>
        <span class="token punctuation" data-v-54013ff0>(</span>progressEvent<span class="token punctuation" data-v-54013ff0>.</span>loaded <span class="token operator" data-v-54013ff0>*</span> <span class="token number" data-v-54013ff0>100</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>/</span> progressEvent<span class="token punctuation" data-v-54013ff0>.</span>total
      <span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span>percentCompleted<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0></div></div><p data-v-54013ff0>服务端代码中，在以下代码中，我们定义了一个新的路由 —— /upload/multiple 来处理多文件上传的功能。当所有文件都成功上传后，就会返回一个已上传文件的 url 地址列表：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0>router<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>
  <span class="token string" data-v-54013ff0>&quot;/upload/multiple&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token keyword" data-v-54013ff0>async</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>ctx<span class="token punctuation" data-v-54013ff0>,</span> next</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>try</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>await</span> <span class="token function" data-v-54013ff0>next</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      urls <span class="token operator" data-v-54013ff0>=</span> ctx<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>.</span>file<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>map</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token template-string" data-v-54013ff0><span class="token template-punctuation string" data-v-54013ff0>`</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span><span class="token constant" data-v-54013ff0>RESOURCE_URL</span><span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token string" data-v-54013ff0>/</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span>file<span class="token punctuation" data-v-54013ff0>.</span>originalname<span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token template-punctuation string" data-v-54013ff0>`</span></span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      ctx<span class="token punctuation" data-v-54013ff0>.</span>body <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>{</span>
        code<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>1</span><span class="token punctuation" data-v-54013ff0>,</span>
        msg<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;文件上传成功&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
        urls
      <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span> <span class="token keyword" data-v-54013ff0>catch</span> <span class="token punctuation" data-v-54013ff0>(</span>error<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      ctx<span class="token punctuation" data-v-54013ff0>.</span>body <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>{</span>
        code<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>,</span>
        msg<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;文件上传失败&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
      <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  multerUpload<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>fields</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>[</span>
    <span class="token punctuation" data-v-54013ff0>{</span>
      name<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;file&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token comment" data-v-54013ff0>// 与FormData表单项的fieldName想对应</span>
    <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>)</span>
<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>24</span><br data-v-54013ff0></div></div><h2 id="目录上传" data-v-54013ff0><a href="#目录上传" class="header-anchor" data-v-54013ff0>#</a> 目录上传</h2> <p data-v-54013ff0>input 元素上还有一个的 webkitdirectory 属性。当设置了 webkitdirectory 属性之后，我们就可以选择目录了。</p> <div class="language-html line-numbers-mode" data-v-54013ff0><pre class="language-html" data-v-54013ff0><code data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>input</span> <span class="token attr-name" data-v-54013ff0>id</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>uploadFile<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>type</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>file<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>accept</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>image/*<span class="token punctuation" data-v-54013ff0>&quot;</span></span> <span class="token attr-name" data-v-54013ff0>webkitdirectory</span> <span class="token punctuation" data-v-54013ff0>/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0></div></div><p data-v-54013ff0>当我们选择了指定目录之后，比如阿宝哥桌面上的 images 目录，就会显示以下确认框：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/b58cd2884cce4a1bb7c6e43f754d4212_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>点击上传按钮之后，我们就可以获取文件列表。列表中的文件对象上含有一个 webkitRelativePath 属性，用于表示当前文件的相对路径。</p> <p data-v-54013ff0><img src="/vuebloger/img/post/7a277378ebd84cdc91c84846c75956fc_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>虽然通过 webkitdirectory 属性可以很容易地实现选择目录的功能，但在实际项目中我们还需要考虑它的兼容性。比如在 IE 11 以下的版本就不支持该属性，其它浏览器的兼容性如下图所示：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/665ae2e087274a479b10855ebd07bc16_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>为了让服务端能按照实际的目录结构来存放对应的文件，在添加表单项时我们需要把当前文件的路径提交到服务端。此外，为了确保@koa/multer 能正确处理文件的路径，我们需要对路径进行特殊处理。即把 / 斜杠替换为 @ 符号。对应的处理方式如下所示：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span> url<span class="token punctuation" data-v-54013ff0>,</span> files<span class="token punctuation" data-v-54013ff0>,</span> fieldName <span class="token operator" data-v-54013ff0>=</span> <span class="token string" data-v-54013ff0>&quot;file&quot;</span> <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>let</span> formData <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  files<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file<span class="token punctuation" data-v-54013ff0>,</span> i</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    formData<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span>
      fieldName<span class="token punctuation" data-v-54013ff0>,</span> 
      files<span class="token punctuation" data-v-54013ff0>[</span>i<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>,</span>
      files<span class="token punctuation" data-v-54013ff0>[</span>i<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span>webkitRelativePath<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>replace</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token regex" data-v-54013ff0>/\//g</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;@&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  request<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>url<span class="token punctuation" data-v-54013ff0>,</span> formData<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span> <span class="token comment" data-v-54013ff0>// 省略上传进度处理</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0></div></div><p data-v-54013ff0>目录上传与多文件上传，服务端代码的主要区别就是 @koa/multer 中间件的配置对象不一样。在 destination 属性对应的函数中，我们需要把文件名中 @ 还原成 /，然后根据文件的实际路径来生成目录</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> fse <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;fs-extra&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> storage <span class="token operator" data-v-54013ff0>=</span> multer<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>diskStorage</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token function-variable function" data-v-54013ff0>destination</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>async</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>req<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> cb</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token comment" data-v-54013ff0>// images@image-1.jpeg =&gt; images/image-1.jpeg</span>
    <span class="token keyword" data-v-54013ff0>let</span> relativePath <span class="token operator" data-v-54013ff0>=</span> file<span class="token punctuation" data-v-54013ff0>.</span>originalname<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>replace</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token regex" data-v-54013ff0>/@/g</span><span class="token punctuation" data-v-54013ff0>,</span> path<span class="token punctuation" data-v-54013ff0>.</span>sep<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token keyword" data-v-54013ff0>let</span> index <span class="token operator" data-v-54013ff0>=</span> relativePath<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>lastIndexOf</span><span class="token punctuation" data-v-54013ff0>(</span>path<span class="token punctuation" data-v-54013ff0>.</span>sep<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token keyword" data-v-54013ff0>let</span> fileDir <span class="token operator" data-v-54013ff0>=</span> path<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>join</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token constant" data-v-54013ff0>UPLOAD_DIR</span><span class="token punctuation" data-v-54013ff0>,</span> relativePath<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>substr</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>,</span> index<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token comment" data-v-54013ff0>// 确保文件目录存在，若不存在的话，会自动创建</span>
    <span class="token keyword" data-v-54013ff0>await</span> fse<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>ensureDir</span><span class="token punctuation" data-v-54013ff0>(</span>fileDir<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span> 
    <span class="token function" data-v-54013ff0>cb</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>null</span><span class="token punctuation" data-v-54013ff0>,</span> fileDir<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token function-variable function" data-v-54013ff0>filename</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>req<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> cb</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>let</span> parts <span class="token operator" data-v-54013ff0>=</span> file<span class="token punctuation" data-v-54013ff0>.</span>originalname<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>split</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;@&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token function" data-v-54013ff0>cb</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>null</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token template-string" data-v-54013ff0><span class="token template-punctuation string" data-v-54013ff0>`</span><span class="token interpolation" data-v-54013ff0><span class="token interpolation-punctuation punctuation" data-v-54013ff0>${</span>parts<span class="token punctuation" data-v-54013ff0>[</span>parts<span class="token punctuation" data-v-54013ff0>.</span>length <span class="token operator" data-v-54013ff0>-</span> <span class="token number" data-v-54013ff0>1</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token interpolation-punctuation punctuation" data-v-54013ff0>}</span></span><span class="token template-punctuation string" data-v-54013ff0>`</span></span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span> 
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0></div></div><p data-v-54013ff0>现在我们已经实现了目录上传的功能，那么能否把目录下的文件压缩成一个压缩包后再上传呢？答案是可以的，接下来我们来介绍如何实现压缩目录上传的功能。</p> <h2 id="压缩目录上传" data-v-54013ff0><a href="#压缩目录上传" class="header-anchor" data-v-54013ff0>#</a> 压缩目录上传</h2> <p data-v-54013ff0>在 JavaScript 如何在线解压 ZIP 文件？ 这篇文章中，介绍了在浏览器端如何使用 JSZip 这个库实现在线解压 ZIP 文件的功能。 JSZip 这个库除了可以解析 ZIP 文件之外，它还可以用来 创建和编辑 ZIP 文件。利用 JSZip 这个库提供的 API，我们就可以把目录下的所有文件压缩成 ZIP 文件，然后再把生成的 ZIP 文件上传到服务器。</p> <p data-v-54013ff0>JSZip 实例上的 file(name, data [,options]) 方法，可以把文件添加到 ZIP 文件中。基于该方法我们可以封装了一个 generateZipFile 函数，用于把目录下的文件列表压缩成一个 ZIP 文件。以下是 generateZipFile 函数的具体实现：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>generateZipFile</span><span class="token punctuation" data-v-54013ff0>(</span>
  zipName<span class="token punctuation" data-v-54013ff0>,</span> files<span class="token punctuation" data-v-54013ff0>,</span>
  options <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>{</span> type<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;blob&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> compression<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;DEFLATE&quot;</span> <span class="token punctuation" data-v-54013ff0>}</span>
<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>return</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>Promise</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>resolve<span class="token punctuation" data-v-54013ff0>,</span> reject</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>const</span> zip <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>JSZip</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token keyword" data-v-54013ff0>for</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>let</span> i <span class="token operator" data-v-54013ff0>=</span> <span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>;</span> i <span class="token operator" data-v-54013ff0>&lt;</span> files<span class="token punctuation" data-v-54013ff0>.</span>length<span class="token punctuation" data-v-54013ff0>;</span> i<span class="token operator" data-v-54013ff0>++</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      zip<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>file</span><span class="token punctuation" data-v-54013ff0>(</span>files<span class="token punctuation" data-v-54013ff0>[</span>i<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span>webkitRelativePath<span class="token punctuation" data-v-54013ff0>,</span> files<span class="token punctuation" data-v-54013ff0>[</span>i<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span>
    zip<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>generateAsync</span><span class="token punctuation" data-v-54013ff0>(</span>options<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>then</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>blob</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      zipName <span class="token operator" data-v-54013ff0>=</span> zipName <span class="token operator" data-v-54013ff0>||</span> Date<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>now</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>+</span> <span class="token string" data-v-54013ff0>&quot;.zip&quot;</span><span class="token punctuation" data-v-54013ff0>;</span>
      <span class="token keyword" data-v-54013ff0>const</span> zipFile <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>File</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>[</span>blob<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>,</span> zipName<span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>{</span>
        type<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;application/zip&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
      <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      <span class="token function" data-v-54013ff0>resolve</span><span class="token punctuation" data-v-54013ff0>(</span>zipFile<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0></div></div><p data-v-54013ff0>在创建完 generateZipFile 函数之后，我们需要更新一下前面已经介绍过的 uploadFile 函数：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>async</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>uploadFile</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>let</span> fileList <span class="token operator" data-v-54013ff0>=</span> uploadFileEle<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token operator" data-v-54013ff0>!</span>fileList<span class="token punctuation" data-v-54013ff0>.</span>length<span class="token punctuation" data-v-54013ff0>)</span> <span class="token keyword" data-v-54013ff0>return</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>let</span> webkitRelativePath <span class="token operator" data-v-54013ff0>=</span> fileList<span class="token punctuation" data-v-54013ff0>[</span><span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span>webkitRelativePath<span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>let</span> zipFileName <span class="token operator" data-v-54013ff0>=</span> webkitRelativePath<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>split</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;/&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>[</span><span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>]</span> <span class="token operator" data-v-54013ff0>+</span> <span class="token string" data-v-54013ff0>&quot;.zip&quot;</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>let</span> zipFile <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>await</span> <span class="token function" data-v-54013ff0>generateZipFile</span><span class="token punctuation" data-v-54013ff0>(</span>zipFileName<span class="token punctuation" data-v-54013ff0>,</span> fileList<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
    url<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;/single&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
    file<span class="token operator" data-v-54013ff0>:</span> zipFile<span class="token punctuation" data-v-54013ff0>,</span>
    fileName<span class="token operator" data-v-54013ff0>:</span> zipFileName
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0></div></div><p data-v-54013ff0>在以上的 uploadFile 函数中，我们会对返回的 FileList 对象进行处理，即调用 generateZipFile 函数来生成 ZIP 文件。此外，为了在服务端接收压缩文件时，能获取到文件名，我们为 upload 函数增加了一个 fileName 参数，该参数用于调用 formData.append 方法时，设置上传文件的文件名：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span> url<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> fileName<span class="token punctuation" data-v-54013ff0>,</span> fieldName <span class="token operator" data-v-54013ff0>=</span> <span class="token string" data-v-54013ff0>&quot;file&quot;</span> <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token operator" data-v-54013ff0>!</span>url <span class="token operator" data-v-54013ff0>||</span> <span class="token operator" data-v-54013ff0>!</span>file<span class="token punctuation" data-v-54013ff0>)</span> <span class="token keyword" data-v-54013ff0>return</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>let</span> formData <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  formData<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span>
    fieldName<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> fileName
  <span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  request<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>url<span class="token punctuation" data-v-54013ff0>,</span> formData<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span> <span class="token comment" data-v-54013ff0>// 省略上传进度跟踪</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0></div></div><p data-v-54013ff0>以上就是压缩目录上传，前端部分的 JS 代码，服务端的代码可以参考前面单文件上传的相关代码。</p> <h2 id="拖拽上传" data-v-54013ff0><a href="#拖拽上传" class="header-anchor" data-v-54013ff0>#</a> 拖拽上传</h2> <p data-v-54013ff0>要实现拖拽上传的功能，我们需要先了解与拖拽相关的事件。比如 drag、dragend、dragenter、dragover 或 drop 事件等。这里我们只介绍接下来要用到的拖拽事件：</p> <ul data-v-54013ff0><li data-v-54013ff0>dragenter：当拖拽元素或选中的文本到一个可释放目标时触发；</li> <li data-v-54013ff0>dragover：当元素或选中的文本被拖到一个可释放目标上时触发（每100毫秒触发一次）；</li> <li data-v-54013ff0>dragleave：当拖拽元素或选中的文本离开一个可释放目标时触发；</li> <li data-v-54013ff0>drop：当元素或选中的文本在可释放目标上被释放时触发。</li></ul> <p data-v-54013ff0>基于上面的这些事件，我们就可以提高用户拖拽的体验。比如当用户拖拽的元素进入目标区域时，对目标区域进行高亮显示。当用户拖拽的元素离开目标区域时，移除高亮显示。很明显当 drop 事件触发后，拖拽的元素已经放入目标区域了，这时我们就需要获取对应的数据。</p> <p data-v-54013ff0>那么如何获取拖拽对应的数据呢？这时我们需要使用 DataTransfer 对象，该对象用于保存拖动并放下过程中的数据。它可以保存一项或多项数据，这些数据项可以是一种或者多种数据类型。若拖动操作涉及拖动文件，则我们可以通过 DataTransfer 对象的 files 属性来获取文件列表。
介绍完拖拽上传相关的知识后，我们来看一下具体如何实现拖拽上传的功能。</p> <p data-v-54013ff0>html代码：</p> <div class="language-html line-numbers-mode" data-v-54013ff0><pre class="language-html" data-v-54013ff0><code data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>div</span> <span class="token attr-name" data-v-54013ff0>id</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>dropArea<span class="token punctuation" data-v-54013ff0>&quot;</span></span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
   <span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>p</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>拖拽上传文件<span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;/</span>p</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
   <span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>div</span> <span class="token attr-name" data-v-54013ff0>id</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>imagePreview<span class="token punctuation" data-v-54013ff0>&quot;</span></span><span class="token punctuation" data-v-54013ff0>&gt;</span></span><span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;/</span>div</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
<span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;/</span>div</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0></div></div><p data-v-54013ff0>css代码：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0>#dropArea <span class="token punctuation" data-v-54013ff0>{</span>
  width<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>300</span>px<span class="token punctuation" data-v-54013ff0>;</span>
  height<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>300</span>px<span class="token punctuation" data-v-54013ff0>;</span>
  border<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>1</span>px dashed gray<span class="token punctuation" data-v-54013ff0>;</span>
  margin<span class="token operator" data-v-54013ff0>-</span>bottom<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>20</span>px<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
#dropArea p <span class="token punctuation" data-v-54013ff0>{</span>
  text<span class="token operator" data-v-54013ff0>-</span>align<span class="token operator" data-v-54013ff0>:</span> center<span class="token punctuation" data-v-54013ff0>;</span>
  color<span class="token operator" data-v-54013ff0>:</span> #<span class="token number" data-v-54013ff0>999</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
#dropArea<span class="token punctuation" data-v-54013ff0>.</span>highlighted <span class="token punctuation" data-v-54013ff0>{</span>
  background<span class="token operator" data-v-54013ff0>-</span>color<span class="token operator" data-v-54013ff0>:</span> #ddd<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
#imagePreview <span class="token punctuation" data-v-54013ff0>{</span>
  max<span class="token operator" data-v-54013ff0>-</span>height<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>250</span>px<span class="token punctuation" data-v-54013ff0>;</span>
  overflow<span class="token operator" data-v-54013ff0>-</span>y<span class="token operator" data-v-54013ff0>:</span> scroll<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
#imagePreview img <span class="token punctuation" data-v-54013ff0>{</span>
  width<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>100</span><span class="token operator" data-v-54013ff0>%</span><span class="token punctuation" data-v-54013ff0>;</span>
  display<span class="token operator" data-v-54013ff0>:</span> block<span class="token punctuation" data-v-54013ff0>;</span>
  margin<span class="token operator" data-v-54013ff0>:</span> auto<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>


</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>24</span><br data-v-54013ff0></div></div><p data-v-54013ff0>js代码：</p> <ol data-v-54013ff0><li data-v-54013ff0>阻止默认拖拽行为</li></ol> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> dropAreaEle <span class="token operator" data-v-54013ff0>=</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>querySelector</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;#dropArea&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> imgPreviewEle <span class="token operator" data-v-54013ff0>=</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>querySelector</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;#imagePreview&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> <span class="token constant" data-v-54013ff0>IMAGE_MIME_REGEX</span> <span class="token operator" data-v-54013ff0>=</span> <span class="token regex" data-v-54013ff0>/^image\/(jpe?g|gif|png)$/i</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token punctuation" data-v-54013ff0>[</span><span class="token string" data-v-54013ff0>&quot;dragenter&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;dragover&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;dragleave&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;drop&quot;</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>eventName</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
   dropAreaEle<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>addEventListener</span><span class="token punctuation" data-v-54013ff0>(</span>eventName<span class="token punctuation" data-v-54013ff0>,</span> preventDefaults<span class="token punctuation" data-v-54013ff0>,</span> <span class="token boolean" data-v-54013ff0>false</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
   document<span class="token punctuation" data-v-54013ff0>.</span>body<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>addEventListener</span><span class="token punctuation" data-v-54013ff0>(</span>eventName<span class="token punctuation" data-v-54013ff0>,</span> preventDefaults<span class="token punctuation" data-v-54013ff0>,</span> <span class="token boolean" data-v-54013ff0>false</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>preventDefaults</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  e<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>preventDefault</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  e<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>stopPropagation</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>


</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0></div></div><ol start="2" data-v-54013ff0><li data-v-54013ff0>切换目标区域的高亮状态</li></ol> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token punctuation" data-v-54013ff0>[</span><span class="token string" data-v-54013ff0>&quot;dragenter&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;dragover&quot;</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>eventName</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    dropAreaEle<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>addEventListener</span><span class="token punctuation" data-v-54013ff0>(</span>eventName<span class="token punctuation" data-v-54013ff0>,</span> highlight<span class="token punctuation" data-v-54013ff0>,</span> <span class="token boolean" data-v-54013ff0>false</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>[</span><span class="token string" data-v-54013ff0>&quot;dragleave&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;drop&quot;</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>eventName</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    dropAreaEle<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>addEventListener</span><span class="token punctuation" data-v-54013ff0>(</span>eventName<span class="token punctuation" data-v-54013ff0>,</span> unhighlight<span class="token punctuation" data-v-54013ff0>,</span> <span class="token boolean" data-v-54013ff0>false</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token comment" data-v-54013ff0>// 添加高亮样式</span>
<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>highlight</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  dropAreaEle<span class="token punctuation" data-v-54013ff0>.</span>classList<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>add</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;highlighted&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

<span class="token comment" data-v-54013ff0>// 移除高亮样式</span>
<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>unhighlight</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  dropAreaEle<span class="token punctuation" data-v-54013ff0>.</span>classList<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>remove</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;highlighted&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0></div></div><ol start="3" data-v-54013ff0><li data-v-54013ff0>处理图片预览</li></ol> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0>dropAreaEle<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>addEventListener</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;drop&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> handleDrop<span class="token punctuation" data-v-54013ff0>,</span> <span class="token boolean" data-v-54013ff0>false</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>handleDrop</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>const</span> dt <span class="token operator" data-v-54013ff0>=</span> e<span class="token punctuation" data-v-54013ff0>.</span>dataTransfer<span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>const</span> files <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>[</span><span class="token operator" data-v-54013ff0>...</span>dt<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>;</span>
  files<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token function" data-v-54013ff0>previewImage</span><span class="token punctuation" data-v-54013ff0>(</span>file<span class="token punctuation" data-v-54013ff0>,</span> imgPreviewEle<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token comment" data-v-54013ff0>// 省略文件上传代码</span>
<span class="token punctuation" data-v-54013ff0>}</span>

<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>previewImage</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file<span class="token punctuation" data-v-54013ff0>,</span> container</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token constant" data-v-54013ff0>IMAGE_MIME_REGEX</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>test</span><span class="token punctuation" data-v-54013ff0>(</span>file<span class="token punctuation" data-v-54013ff0>.</span>type<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>const</span> reader <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FileReader</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    reader<span class="token punctuation" data-v-54013ff0>.</span><span class="token function-variable function" data-v-54013ff0>onload</span> <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>let</span> img <span class="token operator" data-v-54013ff0>=</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>createElement</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;img&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      img<span class="token punctuation" data-v-54013ff0>.</span>src <span class="token operator" data-v-54013ff0>=</span> e<span class="token punctuation" data-v-54013ff0>.</span>target<span class="token punctuation" data-v-54013ff0>.</span>result<span class="token punctuation" data-v-54013ff0>;</span>
      container<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span>img<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>;</span>
    reader<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>readAsDataURL</span><span class="token punctuation" data-v-54013ff0>(</span>file<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0></div></div><ol start="4" data-v-54013ff0><li data-v-54013ff0>文件上传</li></ol> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>handleDrop</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>const</span> dt <span class="token operator" data-v-54013ff0>=</span> e<span class="token punctuation" data-v-54013ff0>.</span>dataTransfer<span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>const</span> files <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>[</span><span class="token operator" data-v-54013ff0>...</span>dt<span class="token punctuation" data-v-54013ff0>.</span>files<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token comment" data-v-54013ff0>// 省略图片预览代码</span>
  files<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>forEach</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
      url<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;/single&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
      file<span class="token punctuation" data-v-54013ff0>,</span>
    <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

<span class="token keyword" data-v-54013ff0>const</span> request <span class="token operator" data-v-54013ff0>=</span> axios<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>create</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
  baseURL<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;http://localhost:3000/upload&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
  timeout<span class="token operator" data-v-54013ff0>:</span> <span class="token number" data-v-54013ff0>60000</span><span class="token punctuation" data-v-54013ff0>,</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span> url<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>,</span> fieldName <span class="token operator" data-v-54013ff0>=</span> <span class="token string" data-v-54013ff0>&quot;file&quot;</span> <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>let</span> formData <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  formData<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>set</span><span class="token punctuation" data-v-54013ff0>(</span>fieldName<span class="token punctuation" data-v-54013ff0>,</span> file<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  request<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>post</span><span class="token punctuation" data-v-54013ff0>(</span>url<span class="token punctuation" data-v-54013ff0>,</span> formData<span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token comment" data-v-54013ff0>// 监听上传进度</span>
    <span class="token function-variable function" data-v-54013ff0>onUploadProgress</span><span class="token operator" data-v-54013ff0>:</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>progressEvent</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>const</span> percentCompleted <span class="token operator" data-v-54013ff0>=</span> Math<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>round</span><span class="token punctuation" data-v-54013ff0>(</span>
        <span class="token punctuation" data-v-54013ff0>(</span>progressEvent<span class="token punctuation" data-v-54013ff0>.</span>loaded <span class="token operator" data-v-54013ff0>*</span> <span class="token number" data-v-54013ff0>100</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>/</span> progressEvent<span class="token punctuation" data-v-54013ff0>.</span>total
      <span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
      console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span>percentCompleted<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>,</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>24</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>25</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>26</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>27</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>28</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>29</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>30</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>31</span><br data-v-54013ff0></div></div><p data-v-54013ff0>拖拽上传算是一个比较常见的场景，很多成熟的上传组件都支持该功能。其实除了拖拽上传外，还可以利用剪贴板实现复制上传的功能。</p> <h2 id="剪贴板上传" data-v-54013ff0><a href="#剪贴板上传" class="header-anchor" data-v-54013ff0>#</a> 剪贴板上传</h2> <p data-v-54013ff0>介绍如何实现剪贴板上传的功能前，我们需要了解一下 Clipboard API。Clipboard 接口实现了 Clipboard API，如果用户授予了相应的权限，就能提供系统剪贴板的读写访问。在 Web 应用程序中，Clipboard  API 可用于实现剪切、复制和粘贴功能。该 API 用于取代通过 document.execCommand API 来实现剪贴板的操作。</p> <p data-v-54013ff0>实际项目中，我们不需要手动创建 Clipboard 对象，而是通过 navigator.clipboard 来获取 Clipboard 对象：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/6eeb440bbb0c429abb0261931bcf6868_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>在获取 Clipboard 对象之后，我们就可以利用该对象提供的 API 来访问剪贴板，比如：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0>navigator<span class="token punctuation" data-v-54013ff0>.</span>clipboard<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>readText</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>then</span><span class="token punctuation" data-v-54013ff0>(</span>
  <span class="token parameter" data-v-54013ff0>clipText</span> <span class="token operator" data-v-54013ff0>=&gt;</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>querySelector</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;.editor&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>.</span>innerText <span class="token operator" data-v-54013ff0>=</span> clipText
<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0></div></div><p data-v-54013ff0>以上代码将 HTML 中含有 .editor 类的第一个元素的内容替换为剪贴板的内容。如果剪贴板为空，或者不包含任何文本，则元素的内容将被清空。这是因为在剪贴板为空或者不包含文本时，readText 方法会返回一个空字符串。</p> <p data-v-54013ff0>利用 Clipboard API 我们可以很方便地操作剪贴板，但实际项目使用过程中也得考虑它的兼容性：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/bf26bbf7156c497486cbe46a186aba2f_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>要实现剪贴板上传的功能，可以分为以下 3 个步骤：</p> <ul data-v-54013ff0><li data-v-54013ff0>监听容器的粘贴事件；</li> <li data-v-54013ff0>读取并解析剪贴板中的内容；</li> <li data-v-54013ff0>动态构建 FormData 对象并上传。</li></ul> <p data-v-54013ff0>了解完上述步骤，接下来我们来分析一下具体实现的代码。</p> <p data-v-54013ff0>html代码：</p> <div class="language-html line-numbers-mode" data-v-54013ff0><pre class="language-html" data-v-54013ff0><code data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>div</span> <span class="token attr-name" data-v-54013ff0>id</span><span class="token attr-value" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>=</span><span class="token punctuation" data-v-54013ff0>&quot;</span>uploadArea<span class="token punctuation" data-v-54013ff0>&quot;</span></span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
   <span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;</span>p</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>请先复制图片后再执行粘贴操作<span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;/</span>p</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
<span class="token tag" data-v-54013ff0><span class="token tag" data-v-54013ff0><span class="token punctuation" data-v-54013ff0>&lt;/</span>div</span><span class="token punctuation" data-v-54013ff0>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0></div></div><p data-v-54013ff0>css代码：</p> <div class="language-css line-numbers-mode" data-v-54013ff0><pre class="language-css" data-v-54013ff0><code data-v-54013ff0><span class="token selector" data-v-54013ff0>#uploadArea</span> <span class="token punctuation" data-v-54013ff0>{</span>
   <span class="token property" data-v-54013ff0>width</span><span class="token punctuation" data-v-54013ff0>:</span> 400px<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>height</span><span class="token punctuation" data-v-54013ff0>:</span> 400px<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>border</span><span class="token punctuation" data-v-54013ff0>:</span> 1px dashed gray<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>display</span><span class="token punctuation" data-v-54013ff0>:</span> table-cell<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>vertical-align</span><span class="token punctuation" data-v-54013ff0>:</span> middle<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
<span class="token selector" data-v-54013ff0>#uploadArea p</span> <span class="token punctuation" data-v-54013ff0>{</span>
   <span class="token property" data-v-54013ff0>text-align</span><span class="token punctuation" data-v-54013ff0>:</span> center<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>color</span><span class="token punctuation" data-v-54013ff0>:</span> #999<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>
<span class="token selector" data-v-54013ff0>#uploadArea img</span> <span class="token punctuation" data-v-54013ff0>{</span>
   <span class="token property" data-v-54013ff0>max-width</span><span class="token punctuation" data-v-54013ff0>:</span> 100%<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>max-height</span><span class="token punctuation" data-v-54013ff0>:</span> 100%<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>display</span><span class="token punctuation" data-v-54013ff0>:</span> block<span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token property" data-v-54013ff0>margin</span><span class="token punctuation" data-v-54013ff0>:</span> auto<span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0></div></div><p data-v-54013ff0>js代码:</p> <p data-v-54013ff0>在以下代码中，我们使用 addEventListener 方法为 uploadArea 容器添加 paste 事件。在对应的事件处理函数中，我们会优先判断当前浏览器是否支持异步 Clipboard API。如果支持的话，就会通过 navigator.clipboard.read 方法来读取剪贴板中的内容。在读取内容之后，我们会通过正则判断剪贴板项中是否包含图片资源，如果有的话会调用 previewImage 方法执行图片预览操作并把返回的 blob 对象保存起来，用于后续的上传操作。</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> <span class="token constant" data-v-54013ff0>IMAGE_MIME_REGEX</span> <span class="token operator" data-v-54013ff0>=</span> <span class="token regex" data-v-54013ff0>/^image\/(jpe?g|gif|png)$/i</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> uploadAreaEle <span class="token operator" data-v-54013ff0>=</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>querySelector</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;#uploadArea&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

uploadAreaEle<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>addEventListener</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;paste&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token keyword" data-v-54013ff0>async</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
  e<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>preventDefault</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>const</span> files <span class="token operator" data-v-54013ff0>=</span> <span class="token punctuation" data-v-54013ff0>[</span><span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span>navigator<span class="token punctuation" data-v-54013ff0>.</span>clipboard<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>let</span> clipboardItems <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>await</span> navigator<span class="token punctuation" data-v-54013ff0>.</span>clipboard<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>read</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token keyword" data-v-54013ff0>for</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>const</span> clipboardItem <span class="token keyword" data-v-54013ff0>of</span> clipboardItems<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>for</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>const</span> type <span class="token keyword" data-v-54013ff0>of</span> clipboardItem<span class="token punctuation" data-v-54013ff0>.</span>types<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
        <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token constant" data-v-54013ff0>IMAGE_MIME_REGEX</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>test</span><span class="token punctuation" data-v-54013ff0>(</span>type<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
           <span class="token keyword" data-v-54013ff0>const</span> blob <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>await</span> clipboardItem<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>getType</span><span class="token punctuation" data-v-54013ff0>(</span>type<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
           <span class="token function" data-v-54013ff0>insertImage</span><span class="token punctuation" data-v-54013ff0>(</span>blob<span class="token punctuation" data-v-54013ff0>,</span> uploadAreaEle<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
           files<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>push</span><span class="token punctuation" data-v-54013ff0>(</span>blob<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
         <span class="token punctuation" data-v-54013ff0>}</span>
       <span class="token punctuation" data-v-54013ff0>}</span>
     <span class="token punctuation" data-v-54013ff0>}</span>
  <span class="token punctuation" data-v-54013ff0>}</span> <span class="token keyword" data-v-54013ff0>else</span> <span class="token punctuation" data-v-54013ff0>{</span>
      <span class="token keyword" data-v-54013ff0>const</span> items <span class="token operator" data-v-54013ff0>=</span> e<span class="token punctuation" data-v-54013ff0>.</span>clipboardData<span class="token punctuation" data-v-54013ff0>.</span>items<span class="token punctuation" data-v-54013ff0>;</span>
      <span class="token keyword" data-v-54013ff0>for</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token keyword" data-v-54013ff0>let</span> i <span class="token operator" data-v-54013ff0>=</span> <span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>;</span> i <span class="token operator" data-v-54013ff0>&lt;</span> items<span class="token punctuation" data-v-54013ff0>.</span>length<span class="token punctuation" data-v-54013ff0>;</span> i<span class="token operator" data-v-54013ff0>++</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
        <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token constant" data-v-54013ff0>IMAGE_MIME_REGEX</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>test</span><span class="token punctuation" data-v-54013ff0>(</span>items<span class="token punctuation" data-v-54013ff0>[</span>i<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span>type<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
          <span class="token keyword" data-v-54013ff0>let</span> file <span class="token operator" data-v-54013ff0>=</span> items<span class="token punctuation" data-v-54013ff0>[</span>i<span class="token punctuation" data-v-54013ff0>]</span><span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>getAsFile</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
          <span class="token function" data-v-54013ff0>insertImage</span><span class="token punctuation" data-v-54013ff0>(</span>file<span class="token punctuation" data-v-54013ff0>,</span> uploadAreaEle<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
          files<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>push</span><span class="token punctuation" data-v-54013ff0>(</span>file<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
        <span class="token punctuation" data-v-54013ff0>}</span>
      <span class="token punctuation" data-v-54013ff0>}</span>
  <span class="token punctuation" data-v-54013ff0>}</span>
  <span class="token keyword" data-v-54013ff0>if</span> <span class="token punctuation" data-v-54013ff0>(</span>files<span class="token punctuation" data-v-54013ff0>.</span>length <span class="token operator" data-v-54013ff0>&gt;</span> <span class="token number" data-v-54013ff0>0</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token function" data-v-54013ff0>confirm</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;剪贴板检测到图片文件，是否执行上传操作？&quot;</span><span class="token punctuation" data-v-54013ff0>)</span> 
      <span class="token operator" data-v-54013ff0>&amp;&amp;</span> <span class="token function" data-v-54013ff0>upload</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>{</span>
           url<span class="token operator" data-v-54013ff0>:</span> <span class="token string" data-v-54013ff0>&quot;/multiple&quot;</span><span class="token punctuation" data-v-54013ff0>,</span>
           files<span class="token punctuation" data-v-54013ff0>,</span>
         <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
   <span class="token punctuation" data-v-54013ff0>}</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>15</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>16</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>17</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>18</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>19</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>20</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>21</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>22</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>23</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>24</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>25</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>26</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>27</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>28</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>29</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>30</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>31</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>32</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>33</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>34</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>35</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>36</span><br data-v-54013ff0></div></div><p data-v-54013ff0>若当前浏览器不支持异步 Clipboard API，则我们会尝试通过 e.clipboardData.items 来访问剪贴板中的内容。需要注意的是，在遍历剪贴板内容项的时候，我们是通过 getAsFile 方法来获取剪贴板的内容。当然该方法也存在兼容性问题，具体如下图所示：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/8fcb697a8e7344e69d06d1dbf8aa8d02_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>前面已经提到，当从剪贴板解析到图片资源时，会让用户进行预览，该功能是基于 FileReader API 来实现的，对应的代码如下所示：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>function</span> <span class="token function" data-v-54013ff0>previewImage</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>file<span class="token punctuation" data-v-54013ff0>,</span> container</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>const</span> reader <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FileReader</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  reader<span class="token punctuation" data-v-54013ff0>.</span><span class="token function-variable function" data-v-54013ff0>onload</span> <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>function</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>e</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    <span class="token keyword" data-v-54013ff0>let</span> img <span class="token operator" data-v-54013ff0>=</span> document<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>createElement</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;img&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    img<span class="token punctuation" data-v-54013ff0>.</span>src <span class="token operator" data-v-54013ff0>=</span> e<span class="token punctuation" data-v-54013ff0>.</span>target<span class="token punctuation" data-v-54013ff0>.</span>result<span class="token punctuation" data-v-54013ff0>;</span>
    container<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span>img<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>;</span>
  reader<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>readAsDataURL</span><span class="token punctuation" data-v-54013ff0>(</span>file<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0></div></div><p data-v-54013ff0>前面我们已经介绍了文件上传的多种不同场景，接下来我们来介绍一个 “特殊” 的场景 —— 大文件上传。</p> <h2 id="大文件分块上传" data-v-54013ff0><a href="#大文件分块上传" class="header-anchor" data-v-54013ff0>#</a> 大文件分块上传</h2> <p data-v-54013ff0>相信你可能已经了解大文件上传的解决方案，在上传大文件时，为了提高上传的效率，我们一般会使用 Blob.slice 方法对大文件按照指定的大小进行切割，然后通过多线程进行分块上传，等所有分块都成功上传后，再通知服务端进行分块合并。具体处理方案如下图所示：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/01334c0fd04d49bfb0c348afc90e5203_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>因为在 <a href="/vuebloger/technology/前端二进制.html" data-v-54013ff0>前端二进制</a> 这篇文章中，已经详细介绍了大文件并发上传的方案，所以这里就不展开介绍了。我们只回顾一下大文件并发上传的完整流程：</p> <p data-v-54013ff0><img src="/vuebloger/img/post/a62a3ec658984065b6994da3a257249d_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-54013ff0></p> <p data-v-54013ff0>前面我们都是介绍客户端文件上传的场景，其实也有服务端文件上传的场景。比如在服务端动态生成海报后，上传到另外一台服务器或云厂商的 OSS（Object Storage Service）。下面我们就以 Node.js 为例来介绍在服务端如何上传文件。</p> <h2 id="服务端上传" data-v-54013ff0><a href="#服务端上传" class="header-anchor" data-v-54013ff0>#</a> 服务端上传</h2> <p data-v-54013ff0>服务器上传就是把文件从一台服务器上传到另外一台服务器。借助 Github 上 form-data 这个库提供的功能，我们可以很容易地实现服务器上传的功能。下面我们来简单介绍一下单文件和多文件上传的功能：</p> <h3 id="单文件上传-2" data-v-54013ff0><a href="#单文件上传-2" class="header-anchor" data-v-54013ff0>#</a> 单文件上传</h3> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> fs <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;fs&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> path <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;path&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> FormData <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;form-data&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>const</span> form1 <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
form1<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;file&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> fs<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>createReadStream</span><span class="token punctuation" data-v-54013ff0>(</span>path<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>join</span><span class="token punctuation" data-v-54013ff0>(</span>__dirname<span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;images/image-1.jpeg&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
form1<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>submit</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;http://localhost:3000/upload/single&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>error<span class="token punctuation" data-v-54013ff0>,</span> response</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>if</span><span class="token punctuation" data-v-54013ff0>(</span>error<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;单图上传失败&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token keyword" data-v-54013ff0>return</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span>
  console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;单图上传成功&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>12</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>13</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>14</span><br data-v-54013ff0></div></div><h3 id="多文件上传-2" data-v-54013ff0><a href="#多文件上传-2" class="header-anchor" data-v-54013ff0>#</a> 多文件上传</h3> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> form2 <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
form2<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;file&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> fs<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>createReadStream</span><span class="token punctuation" data-v-54013ff0>(</span>path<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>join</span><span class="token punctuation" data-v-54013ff0>(</span>__dirname<span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;images/image-2.jpeg&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
form2<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;file&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> fs<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>createReadStream</span><span class="token punctuation" data-v-54013ff0>(</span>path<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>join</span><span class="token punctuation" data-v-54013ff0>(</span>__dirname<span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>&quot;images/image-3.jpeg&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
form2<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>submit</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;http://localhost:3000/upload/multiple&quot;</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>error<span class="token punctuation" data-v-54013ff0>,</span> response</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token operator" data-v-54013ff0>=&gt;</span> <span class="token punctuation" data-v-54013ff0>{</span>
  <span class="token keyword" data-v-54013ff0>if</span><span class="token punctuation" data-v-54013ff0>(</span>error<span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
    console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;多图上传失败&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
    <span class="token keyword" data-v-54013ff0>return</span><span class="token punctuation" data-v-54013ff0>;</span>
  <span class="token punctuation" data-v-54013ff0>}</span>
  console<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>log</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>&quot;多图上传成功&quot;</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>11</span><br data-v-54013ff0></div></div><p data-v-54013ff0>观察以上代码可知，创建完 FormData 对象之后，我们只需要通过 fs.createReadStream API 创建可读流，然后调用 FormData 对象的  append 方法添加表单项，最后再调用 submit 方法执行提交操作即可。
其实除了 ReadableStream 之外，FormData 对象的 append 方法还支持以下类型：</p> <div class="language-js line-numbers-mode" data-v-54013ff0><pre class="language-js" data-v-54013ff0><code data-v-54013ff0><span class="token keyword" data-v-54013ff0>const</span> FormData <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>'form-data'</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token keyword" data-v-54013ff0>const</span> http <span class="token operator" data-v-54013ff0>=</span> <span class="token function" data-v-54013ff0>require</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>'http'</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

<span class="token keyword" data-v-54013ff0>const</span> form <span class="token operator" data-v-54013ff0>=</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>FormData</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
http<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>request</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>'http://nodejs.org/images/logo.png'</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token keyword" data-v-54013ff0>function</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token parameter" data-v-54013ff0>response</span><span class="token punctuation" data-v-54013ff0>)</span> <span class="token punctuation" data-v-54013ff0>{</span>
  form<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>'my_field'</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token string" data-v-54013ff0>'my value'</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  form<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>'my_buffer'</span><span class="token punctuation" data-v-54013ff0>,</span> <span class="token keyword" data-v-54013ff0>new</span> <span class="token class-name" data-v-54013ff0>Buffer</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token number" data-v-54013ff0>10</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
  form<span class="token punctuation" data-v-54013ff0>.</span><span class="token function" data-v-54013ff0>append</span><span class="token punctuation" data-v-54013ff0>(</span><span class="token string" data-v-54013ff0>'my_logo'</span><span class="token punctuation" data-v-54013ff0>,</span> response<span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>
<span class="token punctuation" data-v-54013ff0>}</span><span class="token punctuation" data-v-54013ff0>)</span><span class="token punctuation" data-v-54013ff0>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-54013ff0><span class="line-number" data-v-54013ff0>1</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>2</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>3</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>4</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>5</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>6</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>7</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>8</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>9</span><br data-v-54013ff0><span class="line-number" data-v-54013ff0>10</span><br data-v-54013ff0></div></div><p data-v-54013ff0>服务端文件上传的内容就介绍到这里，关于 form-data 这个库的其他用法，感兴趣的话，可以阅读对应的使用文档。其实除了以上介绍的八种场景外，在日常工作中，你也可能会使用一些同步工具，比如 Syncthing 文件同步工具实现文件传输。在实际项目中，你可以考虑直接使用成熟的第三方组件，比如 Github 上的 Star 数 11K+ 的 filepond。该组件采用插件化的架构，以插件的方式，提供了非常多的功能，比如 File encode、File rename、File poster、Image preview 和 Image crop 等。总之，它是一个很不错的组件</p> <p data-v-54013ff0>本文同步记录于<a href="https://juejin.cn/post/6980142557066067982" target="_blank" rel="noopener noreferrer" data-v-54013ff0>掘金技术社区<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-54013ff0 data-v-54013ff0><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/6/2021, 10:23:05 AM</span></div></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/vuebloger/assets/js/app.41c87d41.js" defer></script><script src="/vuebloger/assets/js/7.ef3340b4.js" defer></script><script src="/vuebloger/assets/js/1.1d0a3ff5.js" defer></script><script src="/vuebloger/assets/js/65.17cd8c65.js" defer></script><script src="/vuebloger/assets/js/59.68013070.js" defer></script>
  </body>
</html>
