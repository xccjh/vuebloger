<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>文件上传解析 | 邹先生博客记录</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/vuebloger/img/logo.jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="">
    
    <link rel="preload" href="/vuebloger/assets/css/0.styles.5257edfd.css" as="style"><link rel="preload" href="/vuebloger/assets/js/app.77a580f6.js" as="script"><link rel="preload" href="/vuebloger/assets/js/5.710548d0.js" as="script"><link rel="preload" href="/vuebloger/assets/js/1.d5aa9ea3.js" as="script"><link rel="preload" href="/vuebloger/assets/js/60.4fb89394.js" as="script"><link rel="preload" href="/vuebloger/assets/js/54.87438b9c.js" as="script"><link rel="prefetch" href="/vuebloger/assets/js/10.9366c20a.js"><link rel="prefetch" href="/vuebloger/assets/js/100.ff058b1d.js"><link rel="prefetch" href="/vuebloger/assets/js/101.679e3b22.js"><link rel="prefetch" href="/vuebloger/assets/js/102.89ae509f.js"><link rel="prefetch" href="/vuebloger/assets/js/103.224ca0fc.js"><link rel="prefetch" href="/vuebloger/assets/js/104.c2c171e2.js"><link rel="prefetch" href="/vuebloger/assets/js/105.7bee1361.js"><link rel="prefetch" href="/vuebloger/assets/js/106.99110d3e.js"><link rel="prefetch" href="/vuebloger/assets/js/107.a6741c41.js"><link rel="prefetch" href="/vuebloger/assets/js/108.b335811a.js"><link rel="prefetch" href="/vuebloger/assets/js/109.e91ba588.js"><link rel="prefetch" href="/vuebloger/assets/js/11.8313deae.js"><link rel="prefetch" href="/vuebloger/assets/js/110.6138bfba.js"><link rel="prefetch" href="/vuebloger/assets/js/111.eead516a.js"><link rel="prefetch" href="/vuebloger/assets/js/112.5e39967f.js"><link rel="prefetch" href="/vuebloger/assets/js/113.3f83a533.js"><link rel="prefetch" href="/vuebloger/assets/js/114.505251e0.js"><link rel="prefetch" href="/vuebloger/assets/js/115.8ba89908.js"><link rel="prefetch" href="/vuebloger/assets/js/116.b396b611.js"><link rel="prefetch" href="/vuebloger/assets/js/117.31a9464c.js"><link rel="prefetch" href="/vuebloger/assets/js/118.64b30008.js"><link rel="prefetch" href="/vuebloger/assets/js/119.ae8fe4c4.js"><link rel="prefetch" href="/vuebloger/assets/js/12.41c23cb1.js"><link rel="prefetch" href="/vuebloger/assets/js/120.6d94d60a.js"><link rel="prefetch" href="/vuebloger/assets/js/121.2e9d76b8.js"><link rel="prefetch" href="/vuebloger/assets/js/122.974f514d.js"><link rel="prefetch" href="/vuebloger/assets/js/123.1a303b9d.js"><link rel="prefetch" href="/vuebloger/assets/js/124.908d357c.js"><link rel="prefetch" href="/vuebloger/assets/js/125.e9c1eea5.js"><link rel="prefetch" href="/vuebloger/assets/js/126.49f4da37.js"><link rel="prefetch" href="/vuebloger/assets/js/127.2c7ca33a.js"><link rel="prefetch" href="/vuebloger/assets/js/128.d4a7deea.js"><link rel="prefetch" href="/vuebloger/assets/js/129.9ab5562c.js"><link rel="prefetch" href="/vuebloger/assets/js/13.9cf5f312.js"><link rel="prefetch" href="/vuebloger/assets/js/130.ee58dc1e.js"><link rel="prefetch" href="/vuebloger/assets/js/131.49c11e8e.js"><link rel="prefetch" href="/vuebloger/assets/js/132.ab08221f.js"><link rel="prefetch" href="/vuebloger/assets/js/133.bd8ceae2.js"><link rel="prefetch" href="/vuebloger/assets/js/134.fb0a9b77.js"><link rel="prefetch" href="/vuebloger/assets/js/135.64246ef5.js"><link rel="prefetch" href="/vuebloger/assets/js/136.60858696.js"><link rel="prefetch" href="/vuebloger/assets/js/137.508abd50.js"><link rel="prefetch" href="/vuebloger/assets/js/138.581662c3.js"><link rel="prefetch" href="/vuebloger/assets/js/14.fd9164ca.js"><link rel="prefetch" href="/vuebloger/assets/js/15.22061b3d.js"><link rel="prefetch" href="/vuebloger/assets/js/16.0a4c588b.js"><link rel="prefetch" href="/vuebloger/assets/js/17.535fde1b.js"><link rel="prefetch" href="/vuebloger/assets/js/18.22d1fe2b.js"><link rel="prefetch" href="/vuebloger/assets/js/19.c0aeef6d.js"><link rel="prefetch" href="/vuebloger/assets/js/20.494bd09c.js"><link rel="prefetch" href="/vuebloger/assets/js/21.6b044372.js"><link rel="prefetch" href="/vuebloger/assets/js/22.78f2b25e.js"><link rel="prefetch" href="/vuebloger/assets/js/23.f0f2711b.js"><link rel="prefetch" href="/vuebloger/assets/js/24.7a1b8992.js"><link rel="prefetch" href="/vuebloger/assets/js/25.a86a748c.js"><link rel="prefetch" href="/vuebloger/assets/js/26.d2bc52ef.js"><link rel="prefetch" href="/vuebloger/assets/js/27.06f66b85.js"><link rel="prefetch" href="/vuebloger/assets/js/28.1c9bc592.js"><link rel="prefetch" href="/vuebloger/assets/js/29.bf267049.js"><link rel="prefetch" href="/vuebloger/assets/js/30.1cc314b9.js"><link rel="prefetch" href="/vuebloger/assets/js/31.029a985e.js"><link rel="prefetch" href="/vuebloger/assets/js/32.3dde4708.js"><link rel="prefetch" href="/vuebloger/assets/js/33.20dbfd62.js"><link rel="prefetch" href="/vuebloger/assets/js/34.bdcf14b0.js"><link rel="prefetch" href="/vuebloger/assets/js/35.f74ed4ad.js"><link rel="prefetch" href="/vuebloger/assets/js/36.14c694ed.js"><link rel="prefetch" href="/vuebloger/assets/js/37.d2e70e13.js"><link rel="prefetch" href="/vuebloger/assets/js/38.a2b16a71.js"><link rel="prefetch" href="/vuebloger/assets/js/39.359d443b.js"><link rel="prefetch" href="/vuebloger/assets/js/4.1eb66aa3.js"><link rel="prefetch" href="/vuebloger/assets/js/40.c4017134.js"><link rel="prefetch" href="/vuebloger/assets/js/41.3bbc028a.js"><link rel="prefetch" href="/vuebloger/assets/js/42.cbbd4b19.js"><link rel="prefetch" href="/vuebloger/assets/js/43.fb0373fa.js"><link rel="prefetch" href="/vuebloger/assets/js/44.9beb1bd3.js"><link rel="prefetch" href="/vuebloger/assets/js/45.56b15eb4.js"><link rel="prefetch" href="/vuebloger/assets/js/46.eaf2c8a0.js"><link rel="prefetch" href="/vuebloger/assets/js/47.39759c16.js"><link rel="prefetch" href="/vuebloger/assets/js/48.dadfb4bb.js"><link rel="prefetch" href="/vuebloger/assets/js/49.0c1eddcd.js"><link rel="prefetch" href="/vuebloger/assets/js/50.eeae5421.js"><link rel="prefetch" href="/vuebloger/assets/js/51.10d7ff33.js"><link rel="prefetch" href="/vuebloger/assets/js/52.288bd80c.js"><link rel="prefetch" href="/vuebloger/assets/js/53.5e1e0669.js"><link rel="prefetch" href="/vuebloger/assets/js/55.ce4ec3f0.js"><link rel="prefetch" href="/vuebloger/assets/js/56.701e6e49.js"><link rel="prefetch" href="/vuebloger/assets/js/57.aa061ef3.js"><link rel="prefetch" href="/vuebloger/assets/js/58.2aac55a3.js"><link rel="prefetch" href="/vuebloger/assets/js/59.8821abbe.js"><link rel="prefetch" href="/vuebloger/assets/js/6.05f243c5.js"><link rel="prefetch" href="/vuebloger/assets/js/61.0d09183a.js"><link rel="prefetch" href="/vuebloger/assets/js/62.2d9c043d.js"><link rel="prefetch" href="/vuebloger/assets/js/63.aba71543.js"><link rel="prefetch" href="/vuebloger/assets/js/64.8c890e69.js"><link rel="prefetch" href="/vuebloger/assets/js/65.7c95b29e.js"><link rel="prefetch" href="/vuebloger/assets/js/66.bd625743.js"><link rel="prefetch" href="/vuebloger/assets/js/67.af7dbd3e.js"><link rel="prefetch" href="/vuebloger/assets/js/68.de9a9373.js"><link rel="prefetch" href="/vuebloger/assets/js/69.29404eeb.js"><link rel="prefetch" href="/vuebloger/assets/js/7.9a07a656.js"><link rel="prefetch" href="/vuebloger/assets/js/70.b447cb3e.js"><link rel="prefetch" href="/vuebloger/assets/js/71.3e5dc57f.js"><link rel="prefetch" href="/vuebloger/assets/js/72.2d9983d4.js"><link rel="prefetch" href="/vuebloger/assets/js/73.a5c2029f.js"><link rel="prefetch" href="/vuebloger/assets/js/74.03e48cbc.js"><link rel="prefetch" href="/vuebloger/assets/js/75.a701c9dc.js"><link rel="prefetch" href="/vuebloger/assets/js/76.e5700959.js"><link rel="prefetch" href="/vuebloger/assets/js/77.62a56c13.js"><link rel="prefetch" href="/vuebloger/assets/js/78.d0ea3d5e.js"><link rel="prefetch" href="/vuebloger/assets/js/79.ce2dfc90.js"><link rel="prefetch" href="/vuebloger/assets/js/8.f3194aa0.js"><link rel="prefetch" href="/vuebloger/assets/js/80.04cc9887.js"><link rel="prefetch" href="/vuebloger/assets/js/81.c1d66453.js"><link rel="prefetch" href="/vuebloger/assets/js/82.d6f839ec.js"><link rel="prefetch" href="/vuebloger/assets/js/83.137a3924.js"><link rel="prefetch" href="/vuebloger/assets/js/84.fd0ea391.js"><link rel="prefetch" href="/vuebloger/assets/js/85.ff0215bb.js"><link rel="prefetch" href="/vuebloger/assets/js/86.d9af8101.js"><link rel="prefetch" href="/vuebloger/assets/js/87.76baee08.js"><link rel="prefetch" href="/vuebloger/assets/js/88.a8796cd6.js"><link rel="prefetch" href="/vuebloger/assets/js/89.6bd87abc.js"><link rel="prefetch" href="/vuebloger/assets/js/9.f25900b9.js"><link rel="prefetch" href="/vuebloger/assets/js/90.26a0e64f.js"><link rel="prefetch" href="/vuebloger/assets/js/91.4e7407a6.js"><link rel="prefetch" href="/vuebloger/assets/js/92.ce8bb5d8.js"><link rel="prefetch" href="/vuebloger/assets/js/93.ad29862e.js"><link rel="prefetch" href="/vuebloger/assets/js/94.90c89118.js"><link rel="prefetch" href="/vuebloger/assets/js/95.ed8154d0.js"><link rel="prefetch" href="/vuebloger/assets/js/96.19578bfe.js"><link rel="prefetch" href="/vuebloger/assets/js/97.84cb5deb.js"><link rel="prefetch" href="/vuebloger/assets/js/98.86311d35.js"><link rel="prefetch" href="/vuebloger/assets/js/99.d65ac5f4.js"><link rel="prefetch" href="/vuebloger/assets/js/vendors~docsearch.86d4a902.js">
    <link rel="stylesheet" href="/vuebloger/assets/css/0.styles.5257edfd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuebloger/" class="home-link router-link-active"><img src="/vuebloger/img/logo.jpeg" alt="邹先生博客记录" class="logo"> <span class="site-name can-hide">邹先生博客记录</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/workplace/" class="nav-link">职场</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <div style="margin-left:20px;margin-right:20px;">
    音乐
    <div role="switch" class="el-switch"><input type="checkbox" name="" true-value="true" class="el-switch__input"><!----><span class="el-switch__core" style="width:40px;"></span><!----></div> <audio><source src="/vuebloger/mp3/065b_520b_0409_111c898908eab454414c3c326fe77c36.mp3" type="audio/mpeg"></audio></div></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuebloger/timeLine/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuebloger/technology/" class="nav-link router-link-active">技术</a></div><div class="nav-item"><a href="/vuebloger/life/" class="nav-link">生活</a></div><div class="nav-item"><a href="/vuebloger/workplace/" class="nav-link">职场</a></div><div class="nav-item"><a href="/vuebloger/bake/" class="nav-link">备忘</a></div><div class="nav-item"><a href="/vuebloger/tags/" class="nav-link">标签库</a></div><div class="nav-item"><a href="/vuebloger/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuebloger/massage/" class="nav-link">留言板</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">链接</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/xccjh/projects" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://nextjs.frontendx.cn/docs/#%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nextjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zh.nuxtjs.org/guide/installation" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Nuxtjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://angularjs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AngularJS
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reactnative.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ReactNative
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://element-cn.eleme.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ElementUI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://youzan.github.io/vant/#/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.fontawesome.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Fontawesome
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://developers.weixin.qq.com/miniprogram/dev/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MiniProgram
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  react-router-dom
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  webpack
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  babel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://eslint.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  eslint
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.swiper.com.cn/api/index.html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  swiper
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  momentjs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/linux/linux-shell.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  shell
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://lodash.com/docs/4.17.15#template" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lodash
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://koa.bootcss.com/#links" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://jestjs.io/docs/en/getting-started" target="_blank" rel="noopener noreferrer" class="nav-link external">
  jest
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://aui.github.io/art-template/zh-cn/docs/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  art-template
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ejs.bootcss.com/#docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ejs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.layui.com/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layui
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://antv-g2.gitee.io/zh/examples/gallery" target="_blank" rel="noopener noreferrer" class="nav-link external">
  G2
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.echartsjs.com/zh/option.html#title" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ECharts
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vagrant
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  docker
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/vuebloger/technology/ https:/www.runoob.com/redis/redis-tutorial.html" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mysql
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://leafletjs.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  leaflet
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.tslang.cn/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  印记中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>文件上传解析</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#文件上传的8种场景" class="sidebar-link">文件上传的8种场景</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#单文件上传" class="sidebar-link">单文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#服务端代码" class="sidebar-link">服务端代码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#多文件上传" class="sidebar-link">多文件上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#目录上传" class="sidebar-link">目录上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#压缩目录上传" class="sidebar-link">压缩目录上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#拖拽上传" class="sidebar-link">拖拽上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#剪贴板上传" class="sidebar-link">剪贴板上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#大文件分块上传" class="sidebar-link">大文件分块上传</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#服务端上传" class="sidebar-link">服务端上传</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#单文件上传-2" class="sidebar-link">单文件上传</a></li><li class="sidebar-sub-header"><a href="/vuebloger/technology/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E8%A7%A3%E6%9E%90.html#多文件上传-2" class="sidebar-link">多文件上传</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content__default" data-v-6567fff5 data-v-6567fff5><h2 id="文件上传的8种场景" data-v-6567fff5><a href="#文件上传的8种场景" class="header-anchor" data-v-6567fff5>#</a> 文件上传的8种场景</h2> <ol data-v-6567fff5><li data-v-6567fff5>单文件上传：利用 input 元素的 accept 属性限制上传文件的类型、利用 JS 检测文件的类型及使用 Koa 实现单文件上传的功能；</li> <li data-v-6567fff5>多文件上传：利用 input 元素的 multiple 属性支持选择多文件及使用 Koa 实现多文件上传的功能；</li> <li data-v-6567fff5>目录上传：利用 input 元素上的 webkitdirectory 属性支持目录上传的功能及使用 Koa 实现目录上传并按文件目录结构存放的功能；</li> <li data-v-6567fff5>压缩目录上传：在目录上传的基础上，利用 JSZip 实现压缩目录上传的功能；</li> <li data-v-6567fff5>拖拽上传：利用拖拽事件和 DataTransfer 对象实现拖拽上传的功能；</li> <li data-v-6567fff5>剪贴板上传：利用剪贴板事件和 Clipboard API 实现剪贴板上传的功能；</li> <li data-v-6567fff5>大文件分块上传：利用 Blob.slice、SparkMD5 和第三方库 async-pool 实现大文件并发上传的功能；</li> <li data-v-6567fff5>服务端上传：利用第三方库 form-data 实现服务端文件流式上传的功能。</li></ol> <p data-v-6567fff5><img src="/vuebloger/img/post/d8735a9b5a544fcc8b5cd12a75c33e3d_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <h2 id="单文件上传" data-v-6567fff5><a href="#单文件上传" class="header-anchor" data-v-6567fff5>#</a> 单文件上传</h2> <p data-v-6567fff5>input 元素 accept 属性有存在兼容性问题。比如 IE 9 以下不支持，具体如下图所示：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/776aa11a44884e44a8837c9df6f81302_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> uploadFileEle <span class="token operator" data-v-6567fff5>=</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>querySelector</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;#uploadFile&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>const</span> request <span class="token operator" data-v-6567fff5>=</span> axios<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>create</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
  baseURL<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;http://localhost:3000/upload&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
  timeout<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>60000</span><span class="token punctuation" data-v-6567fff5>,</span> 
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>async</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>uploadFile</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token operator" data-v-6567fff5>!</span>uploadFileEle<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>.</span>length<span class="token punctuation" data-v-6567fff5>)</span> <span class="token keyword" data-v-6567fff5>return</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>const</span> file <span class="token operator" data-v-6567fff5>=</span> uploadFileEle<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>[</span><span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>;</span> <span class="token comment" data-v-6567fff5>// 获取单个文件</span>
  <span class="token comment" data-v-6567fff5>// 省略文件的校验过程，比如文件类型、大小校验</span>
  <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
    url<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;/single&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
    file<span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span> url<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> fieldName <span class="token operator" data-v-6567fff5>=</span> <span class="token string" data-v-6567fff5>&quot;file&quot;</span> <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>let</span> formData <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  formData<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>set</span><span class="token punctuation" data-v-6567fff5>(</span>fieldName<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  request<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>url<span class="token punctuation" data-v-6567fff5>,</span> formData<span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token comment" data-v-6567fff5>// 监听上传进度</span>
    <span class="token function-variable function" data-v-6567fff5>onUploadProgress</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>progressEvent</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>const</span> percentCompleted <span class="token operator" data-v-6567fff5>=</span> Math<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>round</span><span class="token punctuation" data-v-6567fff5>(</span>
        <span class="token punctuation" data-v-6567fff5>(</span>progressEvent<span class="token punctuation" data-v-6567fff5>.</span>loaded <span class="token operator" data-v-6567fff5>*</span> <span class="token number" data-v-6567fff5>100</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>/</span> progressEvent<span class="token punctuation" data-v-6567fff5>.</span>total
      <span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span>percentCompleted<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
     <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>24</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>25</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>26</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>27</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>28</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>29</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>30</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>31</span><br data-v-6567fff5></div></div><p data-v-6567fff5>在以上代码中，我们先把读取的 File 对象封装成 FormData 对象，然后利用 Axios 实例的 post 方法实现文件上传的功能。 在上传前，通过设置请求配置对象的 onUploadProgress 属性，就可以获取文件的上传进度。</p> <h2 id="服务端代码" data-v-6567fff5><a href="#服务端代码" class="header-anchor" data-v-6567fff5>#</a> 服务端代码</h2> <p data-v-6567fff5>Koa 是一个简单易用的 Web 框架，它的特点是优雅、简洁、轻量、自由度高。所以我们选择它来搭建文件服务，并使用以下中间件来实现相应的功能：</p> <ul data-v-6567fff5><li data-v-6567fff5>koa-static：处理静态资源的中间件；</li> <li data-v-6567fff5>@koa/cors：处理跨域请求的中间件；</li> <li data-v-6567fff5>@koa/multer：处理 multipart/form-data 的中间件；</li> <li data-v-6567fff5>@koa/router：处理路由的中间件。</li></ul> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5>
<span class="token keyword" data-v-6567fff5>const</span> path <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;path&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> Koa <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;koa&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> serve <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;koa-static&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> cors <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;@koa/cors&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> multer <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;@koa/multer&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> Router <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;@koa/router&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>const</span> app <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>Koa</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> router <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>Router</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> <span class="token constant" data-v-6567fff5>PORT</span> <span class="token operator" data-v-6567fff5>=</span> <span class="token number" data-v-6567fff5>3000</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token comment" data-v-6567fff5>// 上传后资源的URL地址</span>
<span class="token keyword" data-v-6567fff5>const</span> <span class="token constant" data-v-6567fff5>RESOURCE_URL</span> <span class="token operator" data-v-6567fff5>=</span> <span class="token template-string" data-v-6567fff5><span class="token template-punctuation string" data-v-6567fff5>`</span><span class="token string" data-v-6567fff5>http://localhost:</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span><span class="token constant" data-v-6567fff5>PORT</span><span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token template-punctuation string" data-v-6567fff5>`</span></span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token comment" data-v-6567fff5>// 存储上传文件的目录</span>
<span class="token keyword" data-v-6567fff5>const</span> <span class="token constant" data-v-6567fff5>UPLOAD_DIR</span> <span class="token operator" data-v-6567fff5>=</span> path<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>join</span><span class="token punctuation" data-v-6567fff5>(</span>__dirname<span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;/public/upload&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>const</span> storage <span class="token operator" data-v-6567fff5>=</span> multer<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>diskStorage</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token function-variable function" data-v-6567fff5>destination</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>async</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>req<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> cb</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token comment" data-v-6567fff5>// 设置文件的存储目录</span>
    <span class="token function" data-v-6567fff5>cb</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>null</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token constant" data-v-6567fff5>UPLOAD_DIR</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token function-variable function" data-v-6567fff5>filename</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>req<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> cb</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token comment" data-v-6567fff5>// 设置文件名</span>
    <span class="token function" data-v-6567fff5>cb</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>null</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token template-string" data-v-6567fff5><span class="token template-punctuation string" data-v-6567fff5>`</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span>file<span class="token punctuation" data-v-6567fff5>.</span>originalname<span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token template-punctuation string" data-v-6567fff5>`</span></span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>const</span> multerUpload <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>multer</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span> storage <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

router<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>get</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;/&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token keyword" data-v-6567fff5>async</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>ctx</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
  ctx<span class="token punctuation" data-v-6567fff5>.</span>body <span class="token operator" data-v-6567fff5>=</span> <span class="token string" data-v-6567fff5>&quot;欢迎使用文件服务（by 阿宝哥）&quot;</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

router<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>
  <span class="token string" data-v-6567fff5>&quot;/upload/single&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token keyword" data-v-6567fff5>async</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>ctx<span class="token punctuation" data-v-6567fff5>,</span> next</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>try</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>await</span> <span class="token function" data-v-6567fff5>next</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      ctx<span class="token punctuation" data-v-6567fff5>.</span>body <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>{</span>
        code<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>1</span><span class="token punctuation" data-v-6567fff5>,</span>
        msg<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;文件上传成功&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
        url<span class="token operator" data-v-6567fff5>:</span> <span class="token template-string" data-v-6567fff5><span class="token template-punctuation string" data-v-6567fff5>`</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span><span class="token constant" data-v-6567fff5>RESOURCE_URL</span><span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token string" data-v-6567fff5>/</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span>ctx<span class="token punctuation" data-v-6567fff5>.</span>file<span class="token punctuation" data-v-6567fff5>.</span>originalname<span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token template-punctuation string" data-v-6567fff5>`</span></span><span class="token punctuation" data-v-6567fff5>,</span>
      <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span> <span class="token keyword" data-v-6567fff5>catch</span> <span class="token punctuation" data-v-6567fff5>(</span>error<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      ctx<span class="token punctuation" data-v-6567fff5>.</span>body <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>{</span>
        code<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>,</span>
        msg<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;文件上传失败&quot;</span>
      <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  multerUpload<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>single</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;file&quot;</span><span class="token punctuation" data-v-6567fff5>)</span>
<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token comment" data-v-6567fff5>// 注册中间件</span>
app<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>use</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token function" data-v-6567fff5>cors</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
app<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>use</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token function" data-v-6567fff5>serve</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token constant" data-v-6567fff5>UPLOAD_DIR</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
app<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>use</span><span class="token punctuation" data-v-6567fff5>(</span>router<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>routes</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>use</span><span class="token punctuation" data-v-6567fff5>(</span>router<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>allowedMethods</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

app<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>listen</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token constant" data-v-6567fff5>PORT</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
  console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token template-string" data-v-6567fff5><span class="token template-punctuation string" data-v-6567fff5>`</span><span class="token string" data-v-6567fff5>app starting at port </span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span><span class="token constant" data-v-6567fff5>PORT</span><span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token template-punctuation string" data-v-6567fff5>`</span></span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>24</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>25</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>26</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>27</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>28</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>29</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>30</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>31</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>32</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>33</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>34</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>35</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>36</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>37</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>38</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>39</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>40</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>41</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>42</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>43</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>44</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>45</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>46</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>47</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>48</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>49</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>50</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>51</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>52</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>53</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>54</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>55</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>56</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>57</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>58</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>59</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>60</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>61</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>62</span><br data-v-6567fff5></div></div><p data-v-6567fff5>Koa 内核很简洁，扩展功能都是通过中间件来实现。比如示例中使用到的路由、CORS、静态资源处理等功能都是通过中间件实现。因此要想掌握 Koa 这个框架，核心是掌握它的中间件机制。如果你想深入了解的话，可以阅读 如何更好地理解中间件和洋葱模型 这篇文章。其实除了单文件上传外，在文件上传的场景中，我们也可以同时上传多个文件。</p> <h2 id="多文件上传" data-v-6567fff5><a href="#多文件上传" class="header-anchor" data-v-6567fff5>#</a> 多文件上传</h2> <p data-v-6567fff5>要上传多个文件，首先我们需要允许用户同时选择多个文件。要实现这个功能，我们可以利用 input 元素的 multiple 属性。跟前面介绍的 accept 属性一样，该属性也存在兼容性问题，具体如下图所示：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/734e61304be844e2188dce72522b41fd0_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>相比单文件上传的代码，多文件上传场景下的 input 元素多了一个 multiple 属性</p> <div class="language-html line-numbers-mode" data-v-6567fff5><pre class="language-html" data-v-6567fff5><code data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>input</span> <span class="token attr-name" data-v-6567fff5>id</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>uploadFile<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token attr-name" data-v-6567fff5>type</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>file<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token attr-name" data-v-6567fff5>accept</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>image/*<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token attr-name" data-v-6567fff5>multiple</span> <span class="token punctuation" data-v-6567fff5>/&gt;</span></span>
<span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>button</span> <span class="token attr-name" data-v-6567fff5>id</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>submit<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token special-attr" data-v-6567fff5><span class="token attr-name" data-v-6567fff5>onclick</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span><span class="token value javascript language-javascript" data-v-6567fff5><span class="token function" data-v-6567fff5>uploadFile</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span></span><span class="token punctuation" data-v-6567fff5>&quot;</span></span></span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>上传文件<span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;/</span>button</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5></div></div><p data-v-6567fff5>在单文件上传的代码中，我们通过 uploadFileEle.files[0] 获取单个文件，而对于多文件上传来说，我们需要获取已选择的文件列表，即通过 uploadFileEle.files 来获取，它返回的是一个 FileList 对象。</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>async</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>uploadFile</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token operator" data-v-6567fff5>!</span>uploadFileEle<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>.</span>length<span class="token punctuation" data-v-6567fff5>)</span> <span class="token keyword" data-v-6567fff5>return</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>const</span> files <span class="token operator" data-v-6567fff5>=</span> Array<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>from</span><span class="token punctuation" data-v-6567fff5>(</span>uploadFileEle<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
    url<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;/multiple&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
    files<span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5></div></div><p data-v-6567fff5>因为要支持上传多个文件，所以我们需要同步更新一下 upload 函数。对应的处理逻辑就是遍历文件列表，然后使用 FormData 对象的 append 方法来添加多个文件，具体代码如下所示：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span> url<span class="token punctuation" data-v-6567fff5>,</span> files<span class="token punctuation" data-v-6567fff5>,</span> fieldName <span class="token operator" data-v-6567fff5>=</span> <span class="token string" data-v-6567fff5>&quot;file&quot;</span> <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>let</span> formData <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  files<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    formData<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span>fieldName<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  request<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>url<span class="token punctuation" data-v-6567fff5>,</span> formData<span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token comment" data-v-6567fff5>// 监听上传进度</span>
    <span class="token function-variable function" data-v-6567fff5>onUploadProgress</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>progressEvent</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>const</span> percentCompleted <span class="token operator" data-v-6567fff5>=</span> Math<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>round</span><span class="token punctuation" data-v-6567fff5>(</span>
        <span class="token punctuation" data-v-6567fff5>(</span>progressEvent<span class="token punctuation" data-v-6567fff5>.</span>loaded <span class="token operator" data-v-6567fff5>*</span> <span class="token number" data-v-6567fff5>100</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>/</span> progressEvent<span class="token punctuation" data-v-6567fff5>.</span>total
      <span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span>percentCompleted<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5></div></div><p data-v-6567fff5>服务端代码中，在以下代码中，我们定义了一个新的路由 —— /upload/multiple 来处理多文件上传的功能。当所有文件都成功上传后，就会返回一个已上传文件的 url 地址列表：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5>router<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>
  <span class="token string" data-v-6567fff5>&quot;/upload/multiple&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token keyword" data-v-6567fff5>async</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>ctx<span class="token punctuation" data-v-6567fff5>,</span> next</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>try</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>await</span> <span class="token function" data-v-6567fff5>next</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      urls <span class="token operator" data-v-6567fff5>=</span> ctx<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>.</span>file<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>map</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token template-string" data-v-6567fff5><span class="token template-punctuation string" data-v-6567fff5>`</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span><span class="token constant" data-v-6567fff5>RESOURCE_URL</span><span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token string" data-v-6567fff5>/</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span>file<span class="token punctuation" data-v-6567fff5>.</span>originalname<span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token template-punctuation string" data-v-6567fff5>`</span></span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      ctx<span class="token punctuation" data-v-6567fff5>.</span>body <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>{</span>
        code<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>1</span><span class="token punctuation" data-v-6567fff5>,</span>
        msg<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;文件上传成功&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
        urls
      <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span> <span class="token keyword" data-v-6567fff5>catch</span> <span class="token punctuation" data-v-6567fff5>(</span>error<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      ctx<span class="token punctuation" data-v-6567fff5>.</span>body <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>{</span>
        code<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>,</span>
        msg<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;文件上传失败&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
      <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  multerUpload<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>fields</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>[</span>
    <span class="token punctuation" data-v-6567fff5>{</span>
      name<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;file&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token comment" data-v-6567fff5>// 与FormData表单项的fieldName想对应</span>
    <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>)</span>
<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>24</span><br data-v-6567fff5></div></div><h2 id="目录上传" data-v-6567fff5><a href="#目录上传" class="header-anchor" data-v-6567fff5>#</a> 目录上传</h2> <p data-v-6567fff5>input 元素上还有一个的 webkitdirectory 属性。当设置了 webkitdirectory 属性之后，我们就可以选择目录了。</p> <div class="language-html line-numbers-mode" data-v-6567fff5><pre class="language-html" data-v-6567fff5><code data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>input</span> <span class="token attr-name" data-v-6567fff5>id</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>uploadFile<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token attr-name" data-v-6567fff5>type</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>file<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token attr-name" data-v-6567fff5>accept</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>image/*<span class="token punctuation" data-v-6567fff5>&quot;</span></span> <span class="token attr-name" data-v-6567fff5>webkitdirectory</span> <span class="token punctuation" data-v-6567fff5>/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5></div></div><p data-v-6567fff5>当我们选择了指定目录之后，比如阿宝哥桌面上的 images 目录，就会显示以下确认框：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/b58cd2884cce4a1bb7c6e43f754d4212_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>点击上传按钮之后，我们就可以获取文件列表。列表中的文件对象上含有一个 webkitRelativePath 属性，用于表示当前文件的相对路径。</p> <p data-v-6567fff5><img src="/vuebloger/img/post/7a277378ebd84cdc91c84846c75956fc_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>虽然通过 webkitdirectory 属性可以很容易地实现选择目录的功能，但在实际项目中我们还需要考虑它的兼容性。比如在 IE 11 以下的版本就不支持该属性，其它浏览器的兼容性如下图所示：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/665ae2e087274a479b10855ebd07bc16_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>为了让服务端能按照实际的目录结构来存放对应的文件，在添加表单项时我们需要把当前文件的路径提交到服务端。此外，为了确保@koa/multer 能正确处理文件的路径，我们需要对路径进行特殊处理。即把 / 斜杠替换为 @ 符号。对应的处理方式如下所示：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span> url<span class="token punctuation" data-v-6567fff5>,</span> files<span class="token punctuation" data-v-6567fff5>,</span> fieldName <span class="token operator" data-v-6567fff5>=</span> <span class="token string" data-v-6567fff5>&quot;file&quot;</span> <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>let</span> formData <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  files<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file<span class="token punctuation" data-v-6567fff5>,</span> i</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    formData<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span>
      fieldName<span class="token punctuation" data-v-6567fff5>,</span> 
      files<span class="token punctuation" data-v-6567fff5>[</span>i<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>,</span>
      files<span class="token punctuation" data-v-6567fff5>[</span>i<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span>webkitRelativePath<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>replace</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token regex" data-v-6567fff5><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-source language-regex" data-v-6567fff5>\/</span><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-flags" data-v-6567fff5>g</span></span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;@&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  request<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>url<span class="token punctuation" data-v-6567fff5>,</span> formData<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span> <span class="token comment" data-v-6567fff5>// 省略上传进度处理</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5></div></div><p data-v-6567fff5>目录上传与多文件上传，服务端代码的主要区别就是 @koa/multer 中间件的配置对象不一样。在 destination 属性对应的函数中，我们需要把文件名中 @ 还原成 /，然后根据文件的实际路径来生成目录</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> fse <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;fs-extra&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> storage <span class="token operator" data-v-6567fff5>=</span> multer<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>diskStorage</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token function-variable function" data-v-6567fff5>destination</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>async</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>req<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> cb</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token comment" data-v-6567fff5>// images@image-1.jpeg =&gt; images/image-1.jpeg</span>
    <span class="token keyword" data-v-6567fff5>let</span> relativePath <span class="token operator" data-v-6567fff5>=</span> file<span class="token punctuation" data-v-6567fff5>.</span>originalname<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>replace</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token regex" data-v-6567fff5><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-source language-regex" data-v-6567fff5>@</span><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-flags" data-v-6567fff5>g</span></span><span class="token punctuation" data-v-6567fff5>,</span> path<span class="token punctuation" data-v-6567fff5>.</span>sep<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token keyword" data-v-6567fff5>let</span> index <span class="token operator" data-v-6567fff5>=</span> relativePath<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>lastIndexOf</span><span class="token punctuation" data-v-6567fff5>(</span>path<span class="token punctuation" data-v-6567fff5>.</span>sep<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token keyword" data-v-6567fff5>let</span> fileDir <span class="token operator" data-v-6567fff5>=</span> path<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>join</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token constant" data-v-6567fff5>UPLOAD_DIR</span><span class="token punctuation" data-v-6567fff5>,</span> relativePath<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>substr</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>,</span> index<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token comment" data-v-6567fff5>// 确保文件目录存在，若不存在的话，会自动创建</span>
    <span class="token keyword" data-v-6567fff5>await</span> fse<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>ensureDir</span><span class="token punctuation" data-v-6567fff5>(</span>fileDir<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span> 
    <span class="token function" data-v-6567fff5>cb</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>null</span><span class="token punctuation" data-v-6567fff5>,</span> fileDir<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token function-variable function" data-v-6567fff5>filename</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>req<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> cb</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>let</span> parts <span class="token operator" data-v-6567fff5>=</span> file<span class="token punctuation" data-v-6567fff5>.</span>originalname<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>split</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;@&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token function" data-v-6567fff5>cb</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>null</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token template-string" data-v-6567fff5><span class="token template-punctuation string" data-v-6567fff5>`</span><span class="token interpolation" data-v-6567fff5><span class="token interpolation-punctuation punctuation" data-v-6567fff5>${</span>parts<span class="token punctuation" data-v-6567fff5>[</span>parts<span class="token punctuation" data-v-6567fff5>.</span>length <span class="token operator" data-v-6567fff5>-</span> <span class="token number" data-v-6567fff5>1</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token interpolation-punctuation punctuation" data-v-6567fff5>}</span></span><span class="token template-punctuation string" data-v-6567fff5>`</span></span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span> 
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5></div></div><p data-v-6567fff5>现在我们已经实现了目录上传的功能，那么能否把目录下的文件压缩成一个压缩包后再上传呢？答案是可以的，接下来我们来介绍如何实现压缩目录上传的功能。</p> <h2 id="压缩目录上传" data-v-6567fff5><a href="#压缩目录上传" class="header-anchor" data-v-6567fff5>#</a> 压缩目录上传</h2> <p data-v-6567fff5>在 JavaScript 如何在线解压 ZIP 文件？ 这篇文章中，介绍了在浏览器端如何使用 JSZip 这个库实现在线解压 ZIP 文件的功能。 JSZip 这个库除了可以解析 ZIP 文件之外，它还可以用来 创建和编辑 ZIP 文件。利用 JSZip 这个库提供的 API，我们就可以把目录下的所有文件压缩成 ZIP 文件，然后再把生成的 ZIP 文件上传到服务器。</p> <p data-v-6567fff5>JSZip 实例上的 file(name, data [,options]) 方法，可以把文件添加到 ZIP 文件中。基于该方法我们可以封装了一个 generateZipFile 函数，用于把目录下的文件列表压缩成一个 ZIP 文件。以下是 generateZipFile 函数的具体实现：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>generateZipFile</span><span class="token punctuation" data-v-6567fff5>(</span>
  zipName<span class="token punctuation" data-v-6567fff5>,</span> files<span class="token punctuation" data-v-6567fff5>,</span>
  options <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>{</span> type<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;blob&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> compression<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;DEFLATE&quot;</span> <span class="token punctuation" data-v-6567fff5>}</span>
<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>return</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>Promise</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>resolve<span class="token punctuation" data-v-6567fff5>,</span> reject</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>const</span> zip <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>JSZip</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token keyword" data-v-6567fff5>for</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>let</span> i <span class="token operator" data-v-6567fff5>=</span> <span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>;</span> i <span class="token operator" data-v-6567fff5>&lt;</span> files<span class="token punctuation" data-v-6567fff5>.</span>length<span class="token punctuation" data-v-6567fff5>;</span> i<span class="token operator" data-v-6567fff5>++</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      zip<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>file</span><span class="token punctuation" data-v-6567fff5>(</span>files<span class="token punctuation" data-v-6567fff5>[</span>i<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span>webkitRelativePath<span class="token punctuation" data-v-6567fff5>,</span> files<span class="token punctuation" data-v-6567fff5>[</span>i<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span>
    zip<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>generateAsync</span><span class="token punctuation" data-v-6567fff5>(</span>options<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>then</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>blob</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      zipName <span class="token operator" data-v-6567fff5>=</span> zipName <span class="token operator" data-v-6567fff5>||</span> Date<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>now</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>+</span> <span class="token string" data-v-6567fff5>&quot;.zip&quot;</span><span class="token punctuation" data-v-6567fff5>;</span>
      <span class="token keyword" data-v-6567fff5>const</span> zipFile <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>File</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>[</span>blob<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>,</span> zipName<span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>{</span>
        type<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;application/zip&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
      <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      <span class="token function" data-v-6567fff5>resolve</span><span class="token punctuation" data-v-6567fff5>(</span>zipFile<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5></div></div><p data-v-6567fff5>在创建完 generateZipFile 函数之后，我们需要更新一下前面已经介绍过的 uploadFile 函数：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>async</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>uploadFile</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>let</span> fileList <span class="token operator" data-v-6567fff5>=</span> uploadFileEle<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token operator" data-v-6567fff5>!</span>fileList<span class="token punctuation" data-v-6567fff5>.</span>length<span class="token punctuation" data-v-6567fff5>)</span> <span class="token keyword" data-v-6567fff5>return</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>let</span> webkitRelativePath <span class="token operator" data-v-6567fff5>=</span> fileList<span class="token punctuation" data-v-6567fff5>[</span><span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span>webkitRelativePath<span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>let</span> zipFileName <span class="token operator" data-v-6567fff5>=</span> webkitRelativePath<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>split</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;/&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>[</span><span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>]</span> <span class="token operator" data-v-6567fff5>+</span> <span class="token string" data-v-6567fff5>&quot;.zip&quot;</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>let</span> zipFile <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>await</span> <span class="token function" data-v-6567fff5>generateZipFile</span><span class="token punctuation" data-v-6567fff5>(</span>zipFileName<span class="token punctuation" data-v-6567fff5>,</span> fileList<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
    url<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;/single&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
    file<span class="token operator" data-v-6567fff5>:</span> zipFile<span class="token punctuation" data-v-6567fff5>,</span>
    fileName<span class="token operator" data-v-6567fff5>:</span> zipFileName
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5></div></div><p data-v-6567fff5>在以上的 uploadFile 函数中，我们会对返回的 FileList 对象进行处理，即调用 generateZipFile 函数来生成 ZIP 文件。此外，为了在服务端接收压缩文件时，能获取到文件名，我们为 upload 函数增加了一个 fileName 参数，该参数用于调用 formData.append 方法时，设置上传文件的文件名：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span> url<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> fileName<span class="token punctuation" data-v-6567fff5>,</span> fieldName <span class="token operator" data-v-6567fff5>=</span> <span class="token string" data-v-6567fff5>&quot;file&quot;</span> <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token operator" data-v-6567fff5>!</span>url <span class="token operator" data-v-6567fff5>||</span> <span class="token operator" data-v-6567fff5>!</span>file<span class="token punctuation" data-v-6567fff5>)</span> <span class="token keyword" data-v-6567fff5>return</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>let</span> formData <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  formData<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span>
    fieldName<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> fileName
  <span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  request<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>url<span class="token punctuation" data-v-6567fff5>,</span> formData<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span> <span class="token comment" data-v-6567fff5>// 省略上传进度跟踪</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5></div></div><p data-v-6567fff5>以上就是压缩目录上传，前端部分的 JS 代码，服务端的代码可以参考前面单文件上传的相关代码。</p> <h2 id="拖拽上传" data-v-6567fff5><a href="#拖拽上传" class="header-anchor" data-v-6567fff5>#</a> 拖拽上传</h2> <p data-v-6567fff5>要实现拖拽上传的功能，我们需要先了解与拖拽相关的事件。比如 drag、dragend、dragenter、dragover 或 drop 事件等。这里我们只介绍接下来要用到的拖拽事件：</p> <ul data-v-6567fff5><li data-v-6567fff5>dragenter：当拖拽元素或选中的文本到一个可释放目标时触发；</li> <li data-v-6567fff5>dragover：当元素或选中的文本被拖到一个可释放目标上时触发（每100毫秒触发一次）；</li> <li data-v-6567fff5>dragleave：当拖拽元素或选中的文本离开一个可释放目标时触发；</li> <li data-v-6567fff5>drop：当元素或选中的文本在可释放目标上被释放时触发。</li></ul> <p data-v-6567fff5>基于上面的这些事件，我们就可以提高用户拖拽的体验。比如当用户拖拽的元素进入目标区域时，对目标区域进行高亮显示。当用户拖拽的元素离开目标区域时，移除高亮显示。很明显当 drop 事件触发后，拖拽的元素已经放入目标区域了，这时我们就需要获取对应的数据。</p> <p data-v-6567fff5>那么如何获取拖拽对应的数据呢？这时我们需要使用 DataTransfer 对象，该对象用于保存拖动并放下过程中的数据。它可以保存一项或多项数据，这些数据项可以是一种或者多种数据类型。若拖动操作涉及拖动文件，则我们可以通过 DataTransfer 对象的 files 属性来获取文件列表。
介绍完拖拽上传相关的知识后，我们来看一下具体如何实现拖拽上传的功能。</p> <p data-v-6567fff5>html代码：</p> <div class="language-html line-numbers-mode" data-v-6567fff5><pre class="language-html" data-v-6567fff5><code data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>div</span> <span class="token attr-name" data-v-6567fff5>id</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>dropArea<span class="token punctuation" data-v-6567fff5>&quot;</span></span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
   <span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>p</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>拖拽上传文件<span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;/</span>p</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
   <span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>div</span> <span class="token attr-name" data-v-6567fff5>id</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>imagePreview<span class="token punctuation" data-v-6567fff5>&quot;</span></span><span class="token punctuation" data-v-6567fff5>&gt;</span></span><span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;/</span>div</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
<span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;/</span>div</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5></div></div><p data-v-6567fff5>css代码：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5>#dropArea <span class="token punctuation" data-v-6567fff5>{</span>
  width<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>300</span>px<span class="token punctuation" data-v-6567fff5>;</span>
  height<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>300</span>px<span class="token punctuation" data-v-6567fff5>;</span>
  border<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>1</span>px dashed gray<span class="token punctuation" data-v-6567fff5>;</span>
  margin<span class="token operator" data-v-6567fff5>-</span>bottom<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>20</span>px<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
#dropArea p <span class="token punctuation" data-v-6567fff5>{</span>
  text<span class="token operator" data-v-6567fff5>-</span>align<span class="token operator" data-v-6567fff5>:</span> center<span class="token punctuation" data-v-6567fff5>;</span>
  color<span class="token operator" data-v-6567fff5>:</span> #<span class="token number" data-v-6567fff5>999</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
#dropArea<span class="token punctuation" data-v-6567fff5>.</span>highlighted <span class="token punctuation" data-v-6567fff5>{</span>
  background<span class="token operator" data-v-6567fff5>-</span>color<span class="token operator" data-v-6567fff5>:</span> #ddd<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
#imagePreview <span class="token punctuation" data-v-6567fff5>{</span>
  max<span class="token operator" data-v-6567fff5>-</span>height<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>250</span>px<span class="token punctuation" data-v-6567fff5>;</span>
  overflow<span class="token operator" data-v-6567fff5>-</span>y<span class="token operator" data-v-6567fff5>:</span> scroll<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
#imagePreview img <span class="token punctuation" data-v-6567fff5>{</span>
  width<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>100</span><span class="token operator" data-v-6567fff5>%</span><span class="token punctuation" data-v-6567fff5>;</span>
  display<span class="token operator" data-v-6567fff5>:</span> block<span class="token punctuation" data-v-6567fff5>;</span>
  margin<span class="token operator" data-v-6567fff5>:</span> auto<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>


</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>24</span><br data-v-6567fff5></div></div><p data-v-6567fff5>js代码：</p> <ol data-v-6567fff5><li data-v-6567fff5>阻止默认拖拽行为</li></ol> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> dropAreaEle <span class="token operator" data-v-6567fff5>=</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>querySelector</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;#dropArea&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> imgPreviewEle <span class="token operator" data-v-6567fff5>=</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>querySelector</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;#imagePreview&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> <span class="token constant" data-v-6567fff5>IMAGE_MIME_REGEX</span> <span class="token operator" data-v-6567fff5>=</span> <span class="token regex" data-v-6567fff5><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-source language-regex" data-v-6567fff5>^image\/(jpe?g|gif|png)$</span><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-flags" data-v-6567fff5>i</span></span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token punctuation" data-v-6567fff5>[</span><span class="token string" data-v-6567fff5>&quot;dragenter&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;dragover&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;dragleave&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;drop&quot;</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>eventName</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
   dropAreaEle<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>addEventListener</span><span class="token punctuation" data-v-6567fff5>(</span>eventName<span class="token punctuation" data-v-6567fff5>,</span> preventDefaults<span class="token punctuation" data-v-6567fff5>,</span> <span class="token boolean" data-v-6567fff5>false</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
   document<span class="token punctuation" data-v-6567fff5>.</span>body<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>addEventListener</span><span class="token punctuation" data-v-6567fff5>(</span>eventName<span class="token punctuation" data-v-6567fff5>,</span> preventDefaults<span class="token punctuation" data-v-6567fff5>,</span> <span class="token boolean" data-v-6567fff5>false</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>preventDefaults</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  e<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>preventDefault</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  e<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>stopPropagation</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>


</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5></div></div><ol start="2" data-v-6567fff5><li data-v-6567fff5>切换目标区域的高亮状态</li></ol> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token punctuation" data-v-6567fff5>[</span><span class="token string" data-v-6567fff5>&quot;dragenter&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;dragover&quot;</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>eventName</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    dropAreaEle<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>addEventListener</span><span class="token punctuation" data-v-6567fff5>(</span>eventName<span class="token punctuation" data-v-6567fff5>,</span> highlight<span class="token punctuation" data-v-6567fff5>,</span> <span class="token boolean" data-v-6567fff5>false</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>[</span><span class="token string" data-v-6567fff5>&quot;dragleave&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;drop&quot;</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>eventName</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    dropAreaEle<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>addEventListener</span><span class="token punctuation" data-v-6567fff5>(</span>eventName<span class="token punctuation" data-v-6567fff5>,</span> unhighlight<span class="token punctuation" data-v-6567fff5>,</span> <span class="token boolean" data-v-6567fff5>false</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token comment" data-v-6567fff5>// 添加高亮样式</span>
<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>highlight</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  dropAreaEle<span class="token punctuation" data-v-6567fff5>.</span>classList<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>add</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;highlighted&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

<span class="token comment" data-v-6567fff5>// 移除高亮样式</span>
<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>unhighlight</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  dropAreaEle<span class="token punctuation" data-v-6567fff5>.</span>classList<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>remove</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;highlighted&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5></div></div><ol start="3" data-v-6567fff5><li data-v-6567fff5>处理图片预览</li></ol> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5>dropAreaEle<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>addEventListener</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;drop&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> handleDrop<span class="token punctuation" data-v-6567fff5>,</span> <span class="token boolean" data-v-6567fff5>false</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>handleDrop</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>const</span> dt <span class="token operator" data-v-6567fff5>=</span> e<span class="token punctuation" data-v-6567fff5>.</span>dataTransfer<span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>const</span> files <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>[</span><span class="token operator" data-v-6567fff5>...</span>dt<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>;</span>
  files<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token function" data-v-6567fff5>previewImage</span><span class="token punctuation" data-v-6567fff5>(</span>file<span class="token punctuation" data-v-6567fff5>,</span> imgPreviewEle<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token comment" data-v-6567fff5>// 省略文件上传代码</span>
<span class="token punctuation" data-v-6567fff5>}</span>

<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>previewImage</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file<span class="token punctuation" data-v-6567fff5>,</span> container</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token constant" data-v-6567fff5>IMAGE_MIME_REGEX</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>test</span><span class="token punctuation" data-v-6567fff5>(</span>file<span class="token punctuation" data-v-6567fff5>.</span>type<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>const</span> reader <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FileReader</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    reader<span class="token punctuation" data-v-6567fff5>.</span><span class="token function-variable function" data-v-6567fff5>onload</span> <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>let</span> img <span class="token operator" data-v-6567fff5>=</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>createElement</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;img&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      img<span class="token punctuation" data-v-6567fff5>.</span>src <span class="token operator" data-v-6567fff5>=</span> e<span class="token punctuation" data-v-6567fff5>.</span>target<span class="token punctuation" data-v-6567fff5>.</span>result<span class="token punctuation" data-v-6567fff5>;</span>
      container<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span>img<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>;</span>
    reader<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>readAsDataURL</span><span class="token punctuation" data-v-6567fff5>(</span>file<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5></div></div><ol start="4" data-v-6567fff5><li data-v-6567fff5>文件上传</li></ol> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>handleDrop</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>const</span> dt <span class="token operator" data-v-6567fff5>=</span> e<span class="token punctuation" data-v-6567fff5>.</span>dataTransfer<span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>const</span> files <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>[</span><span class="token operator" data-v-6567fff5>...</span>dt<span class="token punctuation" data-v-6567fff5>.</span>files<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token comment" data-v-6567fff5>// 省略图片预览代码</span>
  files<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>forEach</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
      url<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;/single&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
      file<span class="token punctuation" data-v-6567fff5>,</span>
    <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

<span class="token keyword" data-v-6567fff5>const</span> request <span class="token operator" data-v-6567fff5>=</span> axios<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>create</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
  baseURL<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;http://localhost:3000/upload&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
  timeout<span class="token operator" data-v-6567fff5>:</span> <span class="token number" data-v-6567fff5>60000</span><span class="token punctuation" data-v-6567fff5>,</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span> url<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>,</span> fieldName <span class="token operator" data-v-6567fff5>=</span> <span class="token string" data-v-6567fff5>&quot;file&quot;</span> <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>let</span> formData <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  formData<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>set</span><span class="token punctuation" data-v-6567fff5>(</span>fieldName<span class="token punctuation" data-v-6567fff5>,</span> file<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  request<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>post</span><span class="token punctuation" data-v-6567fff5>(</span>url<span class="token punctuation" data-v-6567fff5>,</span> formData<span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token comment" data-v-6567fff5>// 监听上传进度</span>
    <span class="token function-variable function" data-v-6567fff5>onUploadProgress</span><span class="token operator" data-v-6567fff5>:</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>progressEvent</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>const</span> percentCompleted <span class="token operator" data-v-6567fff5>=</span> Math<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>round</span><span class="token punctuation" data-v-6567fff5>(</span>
        <span class="token punctuation" data-v-6567fff5>(</span>progressEvent<span class="token punctuation" data-v-6567fff5>.</span>loaded <span class="token operator" data-v-6567fff5>*</span> <span class="token number" data-v-6567fff5>100</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>/</span> progressEvent<span class="token punctuation" data-v-6567fff5>.</span>total
      <span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
      console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span>percentCompleted<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>,</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>24</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>25</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>26</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>27</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>28</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>29</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>30</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>31</span><br data-v-6567fff5></div></div><p data-v-6567fff5>拖拽上传算是一个比较常见的场景，很多成熟的上传组件都支持该功能。其实除了拖拽上传外，还可以利用剪贴板实现复制上传的功能。</p> <h2 id="剪贴板上传" data-v-6567fff5><a href="#剪贴板上传" class="header-anchor" data-v-6567fff5>#</a> 剪贴板上传</h2> <p data-v-6567fff5>介绍如何实现剪贴板上传的功能前，我们需要了解一下 Clipboard API。Clipboard 接口实现了 Clipboard API，如果用户授予了相应的权限，就能提供系统剪贴板的读写访问。在 Web 应用程序中，Clipboard  API 可用于实现剪切、复制和粘贴功能。该 API 用于取代通过 document.execCommand API 来实现剪贴板的操作。</p> <p data-v-6567fff5>实际项目中，我们不需要手动创建 Clipboard 对象，而是通过 navigator.clipboard 来获取 Clipboard 对象：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/6eeb440bbb0c429abb0261931bcf6868_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>在获取 Clipboard 对象之后，我们就可以利用该对象提供的 API 来访问剪贴板，比如：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5>navigator<span class="token punctuation" data-v-6567fff5>.</span>clipboard<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>readText</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>then</span><span class="token punctuation" data-v-6567fff5>(</span>
  <span class="token parameter" data-v-6567fff5>clipText</span> <span class="token operator" data-v-6567fff5>=&gt;</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>querySelector</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;.editor&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>.</span>innerText <span class="token operator" data-v-6567fff5>=</span> clipText
<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5></div></div><p data-v-6567fff5>以上代码将 HTML 中含有 .editor 类的第一个元素的内容替换为剪贴板的内容。如果剪贴板为空，或者不包含任何文本，则元素的内容将被清空。这是因为在剪贴板为空或者不包含文本时，readText 方法会返回一个空字符串。</p> <p data-v-6567fff5>利用 Clipboard API 我们可以很方便地操作剪贴板，但实际项目使用过程中也得考虑它的兼容性：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/bf26bbf7156c497486cbe46a186aba2f_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>要实现剪贴板上传的功能，可以分为以下 3 个步骤：</p> <ul data-v-6567fff5><li data-v-6567fff5>监听容器的粘贴事件；</li> <li data-v-6567fff5>读取并解析剪贴板中的内容；</li> <li data-v-6567fff5>动态构建 FormData 对象并上传。</li></ul> <p data-v-6567fff5>了解完上述步骤，接下来我们来分析一下具体实现的代码。</p> <p data-v-6567fff5>html代码：</p> <div class="language-html line-numbers-mode" data-v-6567fff5><pre class="language-html" data-v-6567fff5><code data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>div</span> <span class="token attr-name" data-v-6567fff5>id</span><span class="token attr-value" data-v-6567fff5><span class="token punctuation attr-equals" data-v-6567fff5>=</span><span class="token punctuation" data-v-6567fff5>&quot;</span>uploadArea<span class="token punctuation" data-v-6567fff5>&quot;</span></span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
   <span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;</span>p</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>请先复制图片后再执行粘贴操作<span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;/</span>p</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
<span class="token tag" data-v-6567fff5><span class="token tag" data-v-6567fff5><span class="token punctuation" data-v-6567fff5>&lt;/</span>div</span><span class="token punctuation" data-v-6567fff5>&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5></div></div><p data-v-6567fff5>css代码：</p> <div class="language-css line-numbers-mode" data-v-6567fff5><pre class="language-css" data-v-6567fff5><code data-v-6567fff5><span class="token selector" data-v-6567fff5>#uploadArea</span> <span class="token punctuation" data-v-6567fff5>{</span>
   <span class="token property" data-v-6567fff5>width</span><span class="token punctuation" data-v-6567fff5>:</span> 400px<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>height</span><span class="token punctuation" data-v-6567fff5>:</span> 400px<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>border</span><span class="token punctuation" data-v-6567fff5>:</span> 1px dashed gray<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>display</span><span class="token punctuation" data-v-6567fff5>:</span> table-cell<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>vertical-align</span><span class="token punctuation" data-v-6567fff5>:</span> middle<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
<span class="token selector" data-v-6567fff5>#uploadArea p</span> <span class="token punctuation" data-v-6567fff5>{</span>
   <span class="token property" data-v-6567fff5>text-align</span><span class="token punctuation" data-v-6567fff5>:</span> center<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>color</span><span class="token punctuation" data-v-6567fff5>:</span> #999<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>
<span class="token selector" data-v-6567fff5>#uploadArea img</span> <span class="token punctuation" data-v-6567fff5>{</span>
   <span class="token property" data-v-6567fff5>max-width</span><span class="token punctuation" data-v-6567fff5>:</span> 100%<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>max-height</span><span class="token punctuation" data-v-6567fff5>:</span> 100%<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>display</span><span class="token punctuation" data-v-6567fff5>:</span> block<span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token property" data-v-6567fff5>margin</span><span class="token punctuation" data-v-6567fff5>:</span> auto<span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5></div></div><p data-v-6567fff5>js代码:</p> <p data-v-6567fff5>在以下代码中，我们使用 addEventListener 方法为 uploadArea 容器添加 paste 事件。在对应的事件处理函数中，我们会优先判断当前浏览器是否支持异步 Clipboard API。如果支持的话，就会通过 navigator.clipboard.read 方法来读取剪贴板中的内容。在读取内容之后，我们会通过正则判断剪贴板项中是否包含图片资源，如果有的话会调用 previewImage 方法执行图片预览操作并把返回的 blob 对象保存起来，用于后续的上传操作。</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> <span class="token constant" data-v-6567fff5>IMAGE_MIME_REGEX</span> <span class="token operator" data-v-6567fff5>=</span> <span class="token regex" data-v-6567fff5><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-source language-regex" data-v-6567fff5>^image\/(jpe?g|gif|png)$</span><span class="token regex-delimiter" data-v-6567fff5>/</span><span class="token regex-flags" data-v-6567fff5>i</span></span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> uploadAreaEle <span class="token operator" data-v-6567fff5>=</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>querySelector</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;#uploadArea&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

uploadAreaEle<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>addEventListener</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;paste&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token keyword" data-v-6567fff5>async</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
  e<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>preventDefault</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>const</span> files <span class="token operator" data-v-6567fff5>=</span> <span class="token punctuation" data-v-6567fff5>[</span><span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span>navigator<span class="token punctuation" data-v-6567fff5>.</span>clipboard<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>let</span> clipboardItems <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>await</span> navigator<span class="token punctuation" data-v-6567fff5>.</span>clipboard<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>read</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token keyword" data-v-6567fff5>for</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>const</span> clipboardItem <span class="token keyword" data-v-6567fff5>of</span> clipboardItems<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>for</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>const</span> type <span class="token keyword" data-v-6567fff5>of</span> clipboardItem<span class="token punctuation" data-v-6567fff5>.</span>types<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
        <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token constant" data-v-6567fff5>IMAGE_MIME_REGEX</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>test</span><span class="token punctuation" data-v-6567fff5>(</span>type<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
           <span class="token keyword" data-v-6567fff5>const</span> blob <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>await</span> clipboardItem<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>getType</span><span class="token punctuation" data-v-6567fff5>(</span>type<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
           <span class="token function" data-v-6567fff5>insertImage</span><span class="token punctuation" data-v-6567fff5>(</span>blob<span class="token punctuation" data-v-6567fff5>,</span> uploadAreaEle<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
           files<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>push</span><span class="token punctuation" data-v-6567fff5>(</span>blob<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
         <span class="token punctuation" data-v-6567fff5>}</span>
       <span class="token punctuation" data-v-6567fff5>}</span>
     <span class="token punctuation" data-v-6567fff5>}</span>
  <span class="token punctuation" data-v-6567fff5>}</span> <span class="token keyword" data-v-6567fff5>else</span> <span class="token punctuation" data-v-6567fff5>{</span>
      <span class="token keyword" data-v-6567fff5>const</span> items <span class="token operator" data-v-6567fff5>=</span> e<span class="token punctuation" data-v-6567fff5>.</span>clipboardData<span class="token punctuation" data-v-6567fff5>.</span>items<span class="token punctuation" data-v-6567fff5>;</span>
      <span class="token keyword" data-v-6567fff5>for</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token keyword" data-v-6567fff5>let</span> i <span class="token operator" data-v-6567fff5>=</span> <span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>;</span> i <span class="token operator" data-v-6567fff5>&lt;</span> items<span class="token punctuation" data-v-6567fff5>.</span>length<span class="token punctuation" data-v-6567fff5>;</span> i<span class="token operator" data-v-6567fff5>++</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
        <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token constant" data-v-6567fff5>IMAGE_MIME_REGEX</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>test</span><span class="token punctuation" data-v-6567fff5>(</span>items<span class="token punctuation" data-v-6567fff5>[</span>i<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span>type<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
          <span class="token keyword" data-v-6567fff5>let</span> file <span class="token operator" data-v-6567fff5>=</span> items<span class="token punctuation" data-v-6567fff5>[</span>i<span class="token punctuation" data-v-6567fff5>]</span><span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>getAsFile</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
          <span class="token function" data-v-6567fff5>insertImage</span><span class="token punctuation" data-v-6567fff5>(</span>file<span class="token punctuation" data-v-6567fff5>,</span> uploadAreaEle<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
          files<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>push</span><span class="token punctuation" data-v-6567fff5>(</span>file<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
        <span class="token punctuation" data-v-6567fff5>}</span>
      <span class="token punctuation" data-v-6567fff5>}</span>
  <span class="token punctuation" data-v-6567fff5>}</span>
  <span class="token keyword" data-v-6567fff5>if</span> <span class="token punctuation" data-v-6567fff5>(</span>files<span class="token punctuation" data-v-6567fff5>.</span>length <span class="token operator" data-v-6567fff5>&gt;</span> <span class="token number" data-v-6567fff5>0</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token function" data-v-6567fff5>confirm</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;剪贴板检测到图片文件，是否执行上传操作？&quot;</span><span class="token punctuation" data-v-6567fff5>)</span> 
      <span class="token operator" data-v-6567fff5>&amp;&amp;</span> <span class="token function" data-v-6567fff5>upload</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>{</span>
           url<span class="token operator" data-v-6567fff5>:</span> <span class="token string" data-v-6567fff5>&quot;/multiple&quot;</span><span class="token punctuation" data-v-6567fff5>,</span>
           files<span class="token punctuation" data-v-6567fff5>,</span>
         <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
   <span class="token punctuation" data-v-6567fff5>}</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>15</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>16</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>17</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>18</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>19</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>20</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>21</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>22</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>23</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>24</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>25</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>26</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>27</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>28</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>29</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>30</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>31</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>32</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>33</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>34</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>35</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>36</span><br data-v-6567fff5></div></div><p data-v-6567fff5>若当前浏览器不支持异步 Clipboard API，则我们会尝试通过 e.clipboardData.items 来访问剪贴板中的内容。需要注意的是，在遍历剪贴板内容项的时候，我们是通过 getAsFile 方法来获取剪贴板的内容。当然该方法也存在兼容性问题，具体如下图所示：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/8fcb697a8e7344e69d06d1dbf8aa8d02_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>前面已经提到，当从剪贴板解析到图片资源时，会让用户进行预览，该功能是基于 FileReader API 来实现的，对应的代码如下所示：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>function</span> <span class="token function" data-v-6567fff5>previewImage</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>file<span class="token punctuation" data-v-6567fff5>,</span> container</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>const</span> reader <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FileReader</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  reader<span class="token punctuation" data-v-6567fff5>.</span><span class="token function-variable function" data-v-6567fff5>onload</span> <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>function</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>e</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    <span class="token keyword" data-v-6567fff5>let</span> img <span class="token operator" data-v-6567fff5>=</span> document<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>createElement</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;img&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    img<span class="token punctuation" data-v-6567fff5>.</span>src <span class="token operator" data-v-6567fff5>=</span> e<span class="token punctuation" data-v-6567fff5>.</span>target<span class="token punctuation" data-v-6567fff5>.</span>result<span class="token punctuation" data-v-6567fff5>;</span>
    container<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span>img<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>;</span>
  reader<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>readAsDataURL</span><span class="token punctuation" data-v-6567fff5>(</span>file<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5></div></div><p data-v-6567fff5>前面我们已经介绍了文件上传的多种不同场景，接下来我们来介绍一个 “特殊” 的场景 —— 大文件上传。</p> <h2 id="大文件分块上传" data-v-6567fff5><a href="#大文件分块上传" class="header-anchor" data-v-6567fff5>#</a> 大文件分块上传</h2> <p data-v-6567fff5>相信你可能已经了解大文件上传的解决方案，在上传大文件时，为了提高上传的效率，我们一般会使用 Blob.slice 方法对大文件按照指定的大小进行切割，然后通过多线程进行分块上传，等所有分块都成功上传后，再通知服务端进行分块合并。具体处理方案如下图所示：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/01334c0fd04d49bfb0c348afc90e5203_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>因为在 <a href="/vuebloger/technology/前端二进制.html" data-v-6567fff5>前端二进制</a> 这篇文章中，已经详细介绍了大文件并发上传的方案，所以这里就不展开介绍了。我们只回顾一下大文件并发上传的完整流程：</p> <p data-v-6567fff5><img src="/vuebloger/img/post/a62a3ec658984065b6994da3a257249d_tplv-k3u1fbpfcp-watermark.awebp" alt="" data-v-6567fff5></p> <p data-v-6567fff5>前面我们都是介绍客户端文件上传的场景，其实也有服务端文件上传的场景。比如在服务端动态生成海报后，上传到另外一台服务器或云厂商的 OSS（Object Storage Service）。下面我们就以 Node.js 为例来介绍在服务端如何上传文件。</p> <h2 id="服务端上传" data-v-6567fff5><a href="#服务端上传" class="header-anchor" data-v-6567fff5>#</a> 服务端上传</h2> <p data-v-6567fff5>服务器上传就是把文件从一台服务器上传到另外一台服务器。借助 Github 上 form-data 这个库提供的功能，我们可以很容易地实现服务器上传的功能。下面我们来简单介绍一下单文件和多文件上传的功能：</p> <h3 id="单文件上传-2" data-v-6567fff5><a href="#单文件上传-2" class="header-anchor" data-v-6567fff5>#</a> 单文件上传</h3> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> fs <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;fs&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> path <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;path&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> FormData <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;form-data&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>const</span> form1 <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
form1<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;file&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> fs<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>createReadStream</span><span class="token punctuation" data-v-6567fff5>(</span>path<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>join</span><span class="token punctuation" data-v-6567fff5>(</span>__dirname<span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;images/image-1.jpeg&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
form1<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>submit</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;http://localhost:3000/upload/single&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>error<span class="token punctuation" data-v-6567fff5>,</span> response</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>if</span><span class="token punctuation" data-v-6567fff5>(</span>error<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;单图上传失败&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token keyword" data-v-6567fff5>return</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span>
  console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;单图上传成功&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>12</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>13</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>14</span><br data-v-6567fff5></div></div><h3 id="多文件上传-2" data-v-6567fff5><a href="#多文件上传-2" class="header-anchor" data-v-6567fff5>#</a> 多文件上传</h3> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> form2 <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
form2<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;file&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> fs<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>createReadStream</span><span class="token punctuation" data-v-6567fff5>(</span>path<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>join</span><span class="token punctuation" data-v-6567fff5>(</span>__dirname<span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;images/image-2.jpeg&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
form2<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;file&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> fs<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>createReadStream</span><span class="token punctuation" data-v-6567fff5>(</span>path<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>join</span><span class="token punctuation" data-v-6567fff5>(</span>__dirname<span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>&quot;images/image-3.jpeg&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
form2<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>submit</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;http://localhost:3000/upload/multiple&quot;</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>error<span class="token punctuation" data-v-6567fff5>,</span> response</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token operator" data-v-6567fff5>=&gt;</span> <span class="token punctuation" data-v-6567fff5>{</span>
  <span class="token keyword" data-v-6567fff5>if</span><span class="token punctuation" data-v-6567fff5>(</span>error<span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
    console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;多图上传失败&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
    <span class="token keyword" data-v-6567fff5>return</span><span class="token punctuation" data-v-6567fff5>;</span>
  <span class="token punctuation" data-v-6567fff5>}</span>
  console<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>log</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>&quot;多图上传成功&quot;</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>11</span><br data-v-6567fff5></div></div><p data-v-6567fff5>观察以上代码可知，创建完 FormData 对象之后，我们只需要通过 fs.createReadStream API 创建可读流，然后调用 FormData 对象的  append 方法添加表单项，最后再调用 submit 方法执行提交操作即可。
其实除了 ReadableStream 之外，FormData 对象的 append 方法还支持以下类型：</p> <div class="language-js line-numbers-mode" data-v-6567fff5><pre class="language-js" data-v-6567fff5><code data-v-6567fff5><span class="token keyword" data-v-6567fff5>const</span> FormData <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>'form-data'</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token keyword" data-v-6567fff5>const</span> http <span class="token operator" data-v-6567fff5>=</span> <span class="token function" data-v-6567fff5>require</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>'http'</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

<span class="token keyword" data-v-6567fff5>const</span> form <span class="token operator" data-v-6567fff5>=</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>FormData</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
http<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>request</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>'http://nodejs.org/images/logo.png'</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token keyword" data-v-6567fff5>function</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token parameter" data-v-6567fff5>response</span><span class="token punctuation" data-v-6567fff5>)</span> <span class="token punctuation" data-v-6567fff5>{</span>
  form<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>'my_field'</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token string" data-v-6567fff5>'my value'</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  form<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>'my_buffer'</span><span class="token punctuation" data-v-6567fff5>,</span> <span class="token keyword" data-v-6567fff5>new</span> <span class="token class-name" data-v-6567fff5>Buffer</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token number" data-v-6567fff5>10</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
  form<span class="token punctuation" data-v-6567fff5>.</span><span class="token function" data-v-6567fff5>append</span><span class="token punctuation" data-v-6567fff5>(</span><span class="token string" data-v-6567fff5>'my_logo'</span><span class="token punctuation" data-v-6567fff5>,</span> response<span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>
<span class="token punctuation" data-v-6567fff5>}</span><span class="token punctuation" data-v-6567fff5>)</span><span class="token punctuation" data-v-6567fff5>;</span>

</code></pre> <div class="line-numbers-wrapper" data-v-6567fff5><span class="line-number" data-v-6567fff5>1</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>2</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>3</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>4</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>5</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>6</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>7</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>8</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>9</span><br data-v-6567fff5><span class="line-number" data-v-6567fff5>10</span><br data-v-6567fff5></div></div><p data-v-6567fff5>服务端文件上传的内容就介绍到这里，关于 form-data 这个库的其他用法，感兴趣的话，可以阅读对应的使用文档。其实除了以上介绍的八种场景外，在日常工作中，你也可能会使用一些同步工具，比如 Syncthing 文件同步工具实现文件传输。在实际项目中，你可以考虑直接使用成熟的第三方组件，比如 Github 上的 Star 数 11K+ 的 filepond。该组件采用插件化的架构，以插件的方式，提供了非常多的功能，比如 File encode、File rename、File poster、Image preview 和 Image crop 等。总之，它是一个很不错的组件</p> <p data-v-6567fff5>本文同步记录于<a href="https://juejin.cn/post/6980142557066067982" target="_blank" rel="noopener noreferrer" data-v-6567fff5>掘金技术社区<span data-v-6567fff5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/6/2021, 10:23:05 AM</span></div></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/vuebloger/assets/js/app.77a580f6.js" defer></script><script src="/vuebloger/assets/js/5.710548d0.js" defer></script><script src="/vuebloger/assets/js/1.d5aa9ea3.js" defer></script><script src="/vuebloger/assets/js/60.4fb89394.js" defer></script><script src="/vuebloger/assets/js/54.87438b9c.js" defer></script>
  </body>
</html>
